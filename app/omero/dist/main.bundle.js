webpackJsonp(["main"],{

/***/ "./node_modules/moment/locale recursive ^\\.\\/.*$":
/***/ (function(module, exports, __webpack_require__) {

var map = {
	"./af": "./node_modules/moment/locale/af.js",
	"./af.js": "./node_modules/moment/locale/af.js",
	"./ar": "./node_modules/moment/locale/ar.js",
	"./ar-dz": "./node_modules/moment/locale/ar-dz.js",
	"./ar-dz.js": "./node_modules/moment/locale/ar-dz.js",
	"./ar-kw": "./node_modules/moment/locale/ar-kw.js",
	"./ar-kw.js": "./node_modules/moment/locale/ar-kw.js",
	"./ar-ly": "./node_modules/moment/locale/ar-ly.js",
	"./ar-ly.js": "./node_modules/moment/locale/ar-ly.js",
	"./ar-ma": "./node_modules/moment/locale/ar-ma.js",
	"./ar-ma.js": "./node_modules/moment/locale/ar-ma.js",
	"./ar-sa": "./node_modules/moment/locale/ar-sa.js",
	"./ar-sa.js": "./node_modules/moment/locale/ar-sa.js",
	"./ar-tn": "./node_modules/moment/locale/ar-tn.js",
	"./ar-tn.js": "./node_modules/moment/locale/ar-tn.js",
	"./ar.js": "./node_modules/moment/locale/ar.js",
	"./az": "./node_modules/moment/locale/az.js",
	"./az.js": "./node_modules/moment/locale/az.js",
	"./be": "./node_modules/moment/locale/be.js",
	"./be.js": "./node_modules/moment/locale/be.js",
	"./bg": "./node_modules/moment/locale/bg.js",
	"./bg.js": "./node_modules/moment/locale/bg.js",
	"./bm": "./node_modules/moment/locale/bm.js",
	"./bm.js": "./node_modules/moment/locale/bm.js",
	"./bn": "./node_modules/moment/locale/bn.js",
	"./bn.js": "./node_modules/moment/locale/bn.js",
	"./bo": "./node_modules/moment/locale/bo.js",
	"./bo.js": "./node_modules/moment/locale/bo.js",
	"./br": "./node_modules/moment/locale/br.js",
	"./br.js": "./node_modules/moment/locale/br.js",
	"./bs": "./node_modules/moment/locale/bs.js",
	"./bs.js": "./node_modules/moment/locale/bs.js",
	"./ca": "./node_modules/moment/locale/ca.js",
	"./ca.js": "./node_modules/moment/locale/ca.js",
	"./cs": "./node_modules/moment/locale/cs.js",
	"./cs.js": "./node_modules/moment/locale/cs.js",
	"./cv": "./node_modules/moment/locale/cv.js",
	"./cv.js": "./node_modules/moment/locale/cv.js",
	"./cy": "./node_modules/moment/locale/cy.js",
	"./cy.js": "./node_modules/moment/locale/cy.js",
	"./da": "./node_modules/moment/locale/da.js",
	"./da.js": "./node_modules/moment/locale/da.js",
	"./de": "./node_modules/moment/locale/de.js",
	"./de-at": "./node_modules/moment/locale/de-at.js",
	"./de-at.js": "./node_modules/moment/locale/de-at.js",
	"./de-ch": "./node_modules/moment/locale/de-ch.js",
	"./de-ch.js": "./node_modules/moment/locale/de-ch.js",
	"./de.js": "./node_modules/moment/locale/de.js",
	"./dv": "./node_modules/moment/locale/dv.js",
	"./dv.js": "./node_modules/moment/locale/dv.js",
	"./el": "./node_modules/moment/locale/el.js",
	"./el.js": "./node_modules/moment/locale/el.js",
	"./en-au": "./node_modules/moment/locale/en-au.js",
	"./en-au.js": "./node_modules/moment/locale/en-au.js",
	"./en-ca": "./node_modules/moment/locale/en-ca.js",
	"./en-ca.js": "./node_modules/moment/locale/en-ca.js",
	"./en-gb": "./node_modules/moment/locale/en-gb.js",
	"./en-gb.js": "./node_modules/moment/locale/en-gb.js",
	"./en-ie": "./node_modules/moment/locale/en-ie.js",
	"./en-ie.js": "./node_modules/moment/locale/en-ie.js",
	"./en-il": "./node_modules/moment/locale/en-il.js",
	"./en-il.js": "./node_modules/moment/locale/en-il.js",
	"./en-nz": "./node_modules/moment/locale/en-nz.js",
	"./en-nz.js": "./node_modules/moment/locale/en-nz.js",
	"./eo": "./node_modules/moment/locale/eo.js",
	"./eo.js": "./node_modules/moment/locale/eo.js",
	"./es": "./node_modules/moment/locale/es.js",
	"./es-do": "./node_modules/moment/locale/es-do.js",
	"./es-do.js": "./node_modules/moment/locale/es-do.js",
	"./es-us": "./node_modules/moment/locale/es-us.js",
	"./es-us.js": "./node_modules/moment/locale/es-us.js",
	"./es.js": "./node_modules/moment/locale/es.js",
	"./et": "./node_modules/moment/locale/et.js",
	"./et.js": "./node_modules/moment/locale/et.js",
	"./eu": "./node_modules/moment/locale/eu.js",
	"./eu.js": "./node_modules/moment/locale/eu.js",
	"./fa": "./node_modules/moment/locale/fa.js",
	"./fa.js": "./node_modules/moment/locale/fa.js",
	"./fi": "./node_modules/moment/locale/fi.js",
	"./fi.js": "./node_modules/moment/locale/fi.js",
	"./fo": "./node_modules/moment/locale/fo.js",
	"./fo.js": "./node_modules/moment/locale/fo.js",
	"./fr": "./node_modules/moment/locale/fr.js",
	"./fr-ca": "./node_modules/moment/locale/fr-ca.js",
	"./fr-ca.js": "./node_modules/moment/locale/fr-ca.js",
	"./fr-ch": "./node_modules/moment/locale/fr-ch.js",
	"./fr-ch.js": "./node_modules/moment/locale/fr-ch.js",
	"./fr.js": "./node_modules/moment/locale/fr.js",
	"./fy": "./node_modules/moment/locale/fy.js",
	"./fy.js": "./node_modules/moment/locale/fy.js",
	"./gd": "./node_modules/moment/locale/gd.js",
	"./gd.js": "./node_modules/moment/locale/gd.js",
	"./gl": "./node_modules/moment/locale/gl.js",
	"./gl.js": "./node_modules/moment/locale/gl.js",
	"./gom-latn": "./node_modules/moment/locale/gom-latn.js",
	"./gom-latn.js": "./node_modules/moment/locale/gom-latn.js",
	"./gu": "./node_modules/moment/locale/gu.js",
	"./gu.js": "./node_modules/moment/locale/gu.js",
	"./he": "./node_modules/moment/locale/he.js",
	"./he.js": "./node_modules/moment/locale/he.js",
	"./hi": "./node_modules/moment/locale/hi.js",
	"./hi.js": "./node_modules/moment/locale/hi.js",
	"./hr": "./node_modules/moment/locale/hr.js",
	"./hr.js": "./node_modules/moment/locale/hr.js",
	"./hu": "./node_modules/moment/locale/hu.js",
	"./hu.js": "./node_modules/moment/locale/hu.js",
	"./hy-am": "./node_modules/moment/locale/hy-am.js",
	"./hy-am.js": "./node_modules/moment/locale/hy-am.js",
	"./id": "./node_modules/moment/locale/id.js",
	"./id.js": "./node_modules/moment/locale/id.js",
	"./is": "./node_modules/moment/locale/is.js",
	"./is.js": "./node_modules/moment/locale/is.js",
	"./it": "./node_modules/moment/locale/it.js",
	"./it.js": "./node_modules/moment/locale/it.js",
	"./ja": "./node_modules/moment/locale/ja.js",
	"./ja.js": "./node_modules/moment/locale/ja.js",
	"./jv": "./node_modules/moment/locale/jv.js",
	"./jv.js": "./node_modules/moment/locale/jv.js",
	"./ka": "./node_modules/moment/locale/ka.js",
	"./ka.js": "./node_modules/moment/locale/ka.js",
	"./kk": "./node_modules/moment/locale/kk.js",
	"./kk.js": "./node_modules/moment/locale/kk.js",
	"./km": "./node_modules/moment/locale/km.js",
	"./km.js": "./node_modules/moment/locale/km.js",
	"./kn": "./node_modules/moment/locale/kn.js",
	"./kn.js": "./node_modules/moment/locale/kn.js",
	"./ko": "./node_modules/moment/locale/ko.js",
	"./ko.js": "./node_modules/moment/locale/ko.js",
	"./ky": "./node_modules/moment/locale/ky.js",
	"./ky.js": "./node_modules/moment/locale/ky.js",
	"./lb": "./node_modules/moment/locale/lb.js",
	"./lb.js": "./node_modules/moment/locale/lb.js",
	"./lo": "./node_modules/moment/locale/lo.js",
	"./lo.js": "./node_modules/moment/locale/lo.js",
	"./lt": "./node_modules/moment/locale/lt.js",
	"./lt.js": "./node_modules/moment/locale/lt.js",
	"./lv": "./node_modules/moment/locale/lv.js",
	"./lv.js": "./node_modules/moment/locale/lv.js",
	"./me": "./node_modules/moment/locale/me.js",
	"./me.js": "./node_modules/moment/locale/me.js",
	"./mi": "./node_modules/moment/locale/mi.js",
	"./mi.js": "./node_modules/moment/locale/mi.js",
	"./mk": "./node_modules/moment/locale/mk.js",
	"./mk.js": "./node_modules/moment/locale/mk.js",
	"./ml": "./node_modules/moment/locale/ml.js",
	"./ml.js": "./node_modules/moment/locale/ml.js",
	"./mn": "./node_modules/moment/locale/mn.js",
	"./mn.js": "./node_modules/moment/locale/mn.js",
	"./mr": "./node_modules/moment/locale/mr.js",
	"./mr.js": "./node_modules/moment/locale/mr.js",
	"./ms": "./node_modules/moment/locale/ms.js",
	"./ms-my": "./node_modules/moment/locale/ms-my.js",
	"./ms-my.js": "./node_modules/moment/locale/ms-my.js",
	"./ms.js": "./node_modules/moment/locale/ms.js",
	"./mt": "./node_modules/moment/locale/mt.js",
	"./mt.js": "./node_modules/moment/locale/mt.js",
	"./my": "./node_modules/moment/locale/my.js",
	"./my.js": "./node_modules/moment/locale/my.js",
	"./nb": "./node_modules/moment/locale/nb.js",
	"./nb.js": "./node_modules/moment/locale/nb.js",
	"./ne": "./node_modules/moment/locale/ne.js",
	"./ne.js": "./node_modules/moment/locale/ne.js",
	"./nl": "./node_modules/moment/locale/nl.js",
	"./nl-be": "./node_modules/moment/locale/nl-be.js",
	"./nl-be.js": "./node_modules/moment/locale/nl-be.js",
	"./nl.js": "./node_modules/moment/locale/nl.js",
	"./nn": "./node_modules/moment/locale/nn.js",
	"./nn.js": "./node_modules/moment/locale/nn.js",
	"./pa-in": "./node_modules/moment/locale/pa-in.js",
	"./pa-in.js": "./node_modules/moment/locale/pa-in.js",
	"./pl": "./node_modules/moment/locale/pl.js",
	"./pl.js": "./node_modules/moment/locale/pl.js",
	"./pt": "./node_modules/moment/locale/pt.js",
	"./pt-br": "./node_modules/moment/locale/pt-br.js",
	"./pt-br.js": "./node_modules/moment/locale/pt-br.js",
	"./pt.js": "./node_modules/moment/locale/pt.js",
	"./ro": "./node_modules/moment/locale/ro.js",
	"./ro.js": "./node_modules/moment/locale/ro.js",
	"./ru": "./node_modules/moment/locale/ru.js",
	"./ru.js": "./node_modules/moment/locale/ru.js",
	"./sd": "./node_modules/moment/locale/sd.js",
	"./sd.js": "./node_modules/moment/locale/sd.js",
	"./se": "./node_modules/moment/locale/se.js",
	"./se.js": "./node_modules/moment/locale/se.js",
	"./si": "./node_modules/moment/locale/si.js",
	"./si.js": "./node_modules/moment/locale/si.js",
	"./sk": "./node_modules/moment/locale/sk.js",
	"./sk.js": "./node_modules/moment/locale/sk.js",
	"./sl": "./node_modules/moment/locale/sl.js",
	"./sl.js": "./node_modules/moment/locale/sl.js",
	"./sq": "./node_modules/moment/locale/sq.js",
	"./sq.js": "./node_modules/moment/locale/sq.js",
	"./sr": "./node_modules/moment/locale/sr.js",
	"./sr-cyrl": "./node_modules/moment/locale/sr-cyrl.js",
	"./sr-cyrl.js": "./node_modules/moment/locale/sr-cyrl.js",
	"./sr.js": "./node_modules/moment/locale/sr.js",
	"./ss": "./node_modules/moment/locale/ss.js",
	"./ss.js": "./node_modules/moment/locale/ss.js",
	"./sv": "./node_modules/moment/locale/sv.js",
	"./sv.js": "./node_modules/moment/locale/sv.js",
	"./sw": "./node_modules/moment/locale/sw.js",
	"./sw.js": "./node_modules/moment/locale/sw.js",
	"./ta": "./node_modules/moment/locale/ta.js",
	"./ta.js": "./node_modules/moment/locale/ta.js",
	"./te": "./node_modules/moment/locale/te.js",
	"./te.js": "./node_modules/moment/locale/te.js",
	"./tet": "./node_modules/moment/locale/tet.js",
	"./tet.js": "./node_modules/moment/locale/tet.js",
	"./tg": "./node_modules/moment/locale/tg.js",
	"./tg.js": "./node_modules/moment/locale/tg.js",
	"./th": "./node_modules/moment/locale/th.js",
	"./th.js": "./node_modules/moment/locale/th.js",
	"./tl-ph": "./node_modules/moment/locale/tl-ph.js",
	"./tl-ph.js": "./node_modules/moment/locale/tl-ph.js",
	"./tlh": "./node_modules/moment/locale/tlh.js",
	"./tlh.js": "./node_modules/moment/locale/tlh.js",
	"./tr": "./node_modules/moment/locale/tr.js",
	"./tr.js": "./node_modules/moment/locale/tr.js",
	"./tzl": "./node_modules/moment/locale/tzl.js",
	"./tzl.js": "./node_modules/moment/locale/tzl.js",
	"./tzm": "./node_modules/moment/locale/tzm.js",
	"./tzm-latn": "./node_modules/moment/locale/tzm-latn.js",
	"./tzm-latn.js": "./node_modules/moment/locale/tzm-latn.js",
	"./tzm.js": "./node_modules/moment/locale/tzm.js",
	"./ug-cn": "./node_modules/moment/locale/ug-cn.js",
	"./ug-cn.js": "./node_modules/moment/locale/ug-cn.js",
	"./uk": "./node_modules/moment/locale/uk.js",
	"./uk.js": "./node_modules/moment/locale/uk.js",
	"./ur": "./node_modules/moment/locale/ur.js",
	"./ur.js": "./node_modules/moment/locale/ur.js",
	"./uz": "./node_modules/moment/locale/uz.js",
	"./uz-latn": "./node_modules/moment/locale/uz-latn.js",
	"./uz-latn.js": "./node_modules/moment/locale/uz-latn.js",
	"./uz.js": "./node_modules/moment/locale/uz.js",
	"./vi": "./node_modules/moment/locale/vi.js",
	"./vi.js": "./node_modules/moment/locale/vi.js",
	"./x-pseudo": "./node_modules/moment/locale/x-pseudo.js",
	"./x-pseudo.js": "./node_modules/moment/locale/x-pseudo.js",
	"./yo": "./node_modules/moment/locale/yo.js",
	"./yo.js": "./node_modules/moment/locale/yo.js",
	"./zh-cn": "./node_modules/moment/locale/zh-cn.js",
	"./zh-cn.js": "./node_modules/moment/locale/zh-cn.js",
	"./zh-hk": "./node_modules/moment/locale/zh-hk.js",
	"./zh-hk.js": "./node_modules/moment/locale/zh-hk.js",
	"./zh-tw": "./node_modules/moment/locale/zh-tw.js",
	"./zh-tw.js": "./node_modules/moment/locale/zh-tw.js"
};
function webpackContext(req) {
	return __webpack_require__(webpackContextResolve(req));
};
function webpackContextResolve(req) {
	var id = map[req];
	if(!(id + 1)) // check for number or string
		throw new Error("Cannot find module '" + req + "'.");
	return id;
};
webpackContext.keys = function webpackContextKeys() {
	return Object.keys(map);
};
webpackContext.resolve = webpackContextResolve;
module.exports = webpackContext;
webpackContext.id = "./node_modules/moment/locale recursive ^\\.\\/.*$";

/***/ }),

/***/ "./redbox-portal/angular/shared/StringTemplatePipe.ts":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
Object.defineProperty(exports, "__esModule", { value: true });
var core_1 = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
var StringTemplatePipe = /** @class */ (function () {
    function StringTemplatePipe() {
        this.generateTemplateString = (function () {
            var cache = {};
            function generateTemplate(template) {
                var fn = cache[template];
                if (!fn) {
                    // Replace ${expressions} (etc) with ${map.expressions}.
                    var sanitized = template
                        .replace(/\$\{([\s]*[^;\s\{]+[\s]*)\}/g, function (_, match) {
                        return "${map." + match.trim() + "}";
                    })
                        .replace(/(\$\{(?!map\.)[^}]+\})/g, '');
                    fn = Function('map', "return `" + sanitized + "`");
                }
                return fn;
            }
            ;
            return generateTemplate;
        })();
    }
    StringTemplatePipe.prototype.transform = function (templateString, args) {
        if (args != null) {
            var template = this.generateTemplateString(templateString);
            return template(args);
        }
        return templateString;
    };
    StringTemplatePipe = __decorate([
        core_1.Pipe({
            name: 'stringTemplate'
        })
    ], StringTemplatePipe);
    return StringTemplatePipe;
}());
exports.StringTemplatePipe = StringTemplatePipe;


/***/ }),

/***/ "./redbox-portal/angular/shared/ands-service.ts":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};
Object.defineProperty(exports, "__esModule", { value: true });
var core_1 = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
var http_1 = __webpack_require__("./node_modules/@angular/http/esm5/http.js");
__webpack_require__("./node_modules/rxjs/_esm5/add/operator/map.js");
__webpack_require__("./node_modules/rxjs/_esm5/add/operator/toPromise.js");
var base_service_1 = __webpack_require__("./redbox-portal/angular/shared/base-service.ts");
var config_service_1 = __webpack_require__("./redbox-portal/angular/shared/config-service.ts");
var translation_service_1 = __webpack_require__("./redbox-portal/angular/shared/translation-service.ts");
var ANDSService = /** @class */ (function (_super) {
    __extends(ANDSService, _super);
    function ANDSService(http, configService, translator) {
        var _this = _super.call(this, http, configService) || this;
        _this.configService = configService;
        _this.translator = translator;
        return _this;
    }
    ANDSService.prototype.getResourceDetails = function (uri, vocab) {
        var _this = this;
        return this.http.get(this.brandingAndPortalUrl + "/ands/vocab/resourceDetails?uri=" + uri + "&vocab=" + vocab, this.options)
            .toPromise()
            .then(function (res) { return _this.extractData(res); });
    };
    ANDSService = __decorate([
        core_1.Injectable(),
        __param(0, core_1.Inject(http_1.Http)),
        __param(1, core_1.Inject(config_service_1.ConfigService)),
        __param(2, core_1.Inject(translation_service_1.TranslationService)),
        __metadata("design:paramtypes", [http_1.Http,
            config_service_1.ConfigService,
            translation_service_1.TranslationService])
    ], ANDSService);
    return ANDSService;
}(base_service_1.BaseService));
exports.ANDSService = ANDSService;


/***/ }),

/***/ "./redbox-portal/angular/shared/base-service.ts":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

// Copyright (c) 2017 Queensland Cyber Infrastructure Foundation (http://www.qcif.edu.au/)
//
// GNU GENERAL PUBLIC LICENSE
//    Version 2, June 1991
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation; either version 2 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this program; if not, write to the Free Software Foundation, Inc.,
// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
Object.defineProperty(exports, "__esModule", { value: true });
var http_1 = __webpack_require__("./node_modules/@angular/http/esm5/http.js");
__webpack_require__("./node_modules/rxjs/_esm5/add/observable/interval.js");
__webpack_require__("./node_modules/rxjs/_esm5/add/observable/of.js");
__webpack_require__("./node_modules/rxjs/_esm5/add/operator/mergeMap.js");
var Subject_1 = __webpack_require__("./node_modules/rxjs/_esm5/Subject.js");
/**
 * Base class for all client-side services...
 *
 * Author: <a href='https://github.com/shilob' target='_blank'>Shilo Banihit</a>
 *
 */
var BaseService = /** @class */ (function () {
    function BaseService(http, configService) {
        var _this = this;
        this.http = http;
        this.configService = configService;
        this.initSubject = new Subject_1.Subject();
        this.configService.getConfig(function (config) {
            _this.config = config;
            _this.baseUrl = _this.config.baseUrl;
            _this.brandingAndPortalUrl = _this.baseUrl + "/" + _this.config.branding + "/" + _this.config.portal;
            _this.options = _this.getOptionsClient();
            _this.emitInit();
        });
    }
    Object.defineProperty(BaseService.prototype, "getBrandingAndPortalUrl", {
        get: function () {
            return this.brandingAndPortalUrl;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(BaseService.prototype, "getBaseUrl", {
        get: function () {
            return this.baseUrl;
        },
        enumerable: true,
        configurable: true
    });
    BaseService.prototype.waitForInit = function (handler) {
        var subs = this.initSubject.subscribe(handler);
        this.emitInit();
        return subs;
    };
    BaseService.prototype.emitInit = function () {
        if (this.config) {
            this.initSubject.next('');
        }
    };
    BaseService.prototype.getConfig = function () {
        return this.config;
    };
    BaseService.prototype.extractData = function (res, parentField) {
        if (parentField === void 0) { parentField = null; }
        var body = res.json();
        if (parentField) {
            return body[parentField] || {};
        }
        else {
            return body || {};
        }
    };
    BaseService.prototype.getOptions = function (headersObj) {
        var headers = new http_1.Headers(headersObj);
        return new http_1.RequestOptions({ headers: headers });
    };
    BaseService.prototype.getOptionsClient = function (headersObj) {
        if (headersObj === void 0) { headersObj = {}; }
        headersObj['X-Source'] = 'jsclient';
        headersObj['Content-Type'] = 'application/json;charset=utf-8';
        return this.getOptions(headersObj);
    };
    return BaseService;
}());
exports.BaseService = BaseService;


/***/ }),

/***/ "./redbox-portal/angular/shared/config-service.ts":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

// Copyright (c) 2017 Queensland Cyber Infrastructure Foundation (http://www.qcif.edu.au/)
//
// GNU GENERAL PUBLIC LICENSE
//    Version 2, June 1991
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation; either version 2 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this program; if not, write to the Free Software Foundation, Inc.,
// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};
Object.defineProperty(exports, "__esModule", { value: true });
var core_1 = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
var http_1 = __webpack_require__("./node_modules/@angular/http/esm5/http.js");
var Subject_1 = __webpack_require__("./node_modules/rxjs/_esm5/Subject.js");
__webpack_require__("./node_modules/rxjs/_esm5/add/observable/interval.js");
__webpack_require__("./node_modules/rxjs/_esm5/add/observable/of.js");
__webpack_require__("./node_modules/rxjs/_esm5/add/operator/mergeMap.js");
/**
 * Handles client-side global configuration
 *
 * Author: <a href='https://github.com/shilob' target='_blank'>Shilo Banihit</a>
 *
 */
var ConfigService = /** @class */ (function () {
    function ConfigService(http) {
        this.http = http;
        this.subjects = {};
        this.subjects['get'] = new Subject_1.Subject();
        this.initConfig();
    }
    ConfigService.prototype.getConfig = function (handler) {
        var subs = this.subjects['get'].subscribe(handler);
        this.emitConfig();
        return subs;
    };
    ConfigService.prototype.emitConfig = function () {
        if (this.config) {
            this.subjects['get'].next(this.config);
        }
    };
    ConfigService.prototype.initConfig = function () {
        var _this = this;
        this.http.get("/dynamic/apiClientConfig?v=" + new Date().getTime()).subscribe(function (res) {
            _this.config = _this.extractData(res);
            console.log("ConfigService, initialized. ");
            _this.emitConfig();
        });
    };
    ConfigService.prototype.extractData = function (res, parentField) {
        if (parentField === void 0) { parentField = null; }
        var body = res.json();
        if (parentField) {
            return body[parentField] || {};
        }
        else {
            return body || {};
        }
    };
    ConfigService = __decorate([
        core_1.Injectable(),
        __param(0, core_1.Inject(http_1.Http)),
        __metadata("design:paramtypes", [Object])
    ], ConfigService);
    return ConfigService;
}());
exports.ConfigService = ConfigService;


/***/ }),

/***/ "./redbox-portal/angular/shared/dashboard-service.ts":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};
Object.defineProperty(exports, "__esModule", { value: true });
var core_1 = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
var http_1 = __webpack_require__("./node_modules/@angular/http/esm5/http.js");
__webpack_require__("./node_modules/rxjs/_esm5/add/operator/map.js");
__webpack_require__("./node_modules/rxjs/_esm5/add/operator/toPromise.js");
var moment_es6_1 = __webpack_require__("./node_modules/moment-es6/index.js");
var base_service_1 = __webpack_require__("./redbox-portal/angular/shared/base-service.ts");
var config_service_1 = __webpack_require__("./redbox-portal/angular/shared/config-service.ts");
var translation_service_1 = __webpack_require__("./redbox-portal/angular/shared/translation-service.ts");
var _ = __webpack_require__("./node_modules/lodash-es/lodash.js");
var DashboardService = /** @class */ (function (_super) {
    __extends(DashboardService, _super);
    function DashboardService(http, configService, translator) {
        var _this = _super.call(this, http, configService) || this;
        _this.configService = configService;
        _this.translator = translator;
        return _this;
    }
    DashboardService.prototype.getAlllDraftPlansCanEdit = function () {
        var _this = this;
        var rows = this.config.maxTransferRowsPerPage;
        var start = 0;
        return this.http.get(this.brandingAndPortalUrl + "/listRecords?recordType=rdmp&state=draft&editOnly=true&start=" + start + "&rows=" + rows, this.options)
            .toPromise()
            .then(function (res) { return _this.formatDates(_this.extractData(res)); });
    };
    DashboardService.prototype.getAllRecordsCanEdit = function (recordType, state) {
        var _this = this;
        var rows = this.config.maxTransferRowsPerPage;
        var start = 0;
        var url = this.brandingAndPortalUrl + "/listRecords?recordType=" + recordType + "&editOnly=true&start=" + start + "&rows=" + rows;
        if (state != '') {
            url += "&state=" + start;
        }
        return this.http.get(url, this.options)
            .toPromise()
            .then(function (res) { return _this.formatDates(_this.extractData(res)); });
    };
    DashboardService.prototype.getActivePlans = function (pageNumber) {
        var _this = this;
        var rows = 10;
        var start = (pageNumber - 1) * rows;
        return this.http.get(this.brandingAndPortalUrl + "/listRecords?state=active&start=" + start + "&rows=" + rows, this.options)
            .toPromise()
            .then(function (res) { return _this.formatDates(_this.extractData(res)); });
    };
    DashboardService.prototype.getDraftPlans = function (pageNumber) {
        var _this = this;
        var rows = 10;
        var start = (pageNumber - 1) * rows;
        return this.http.get(this.brandingAndPortalUrl + "/listRecords?recordType=rdmp&state=draft&start=" + start + "&rows=" + rows, this.options)
            .toPromise()
            .then(function (res) { return _this.formatDates(_this.extractData(res)); });
    };
    DashboardService.prototype.getRecords = function (recordType, state, pageNumber) {
        var _this = this;
        var rows = 10;
        var start = (pageNumber - 1) * rows;
        return this.http.get(this.brandingAndPortalUrl + "/listRecords?recordType=" + recordType + "&state=" + state + "&start=" + start + "&rows=" + rows, this.options)
            .toPromise()
            .then(function (res) { return _this.formatDates(_this.extractData(res)); });
    };
    DashboardService.prototype.formatDates = function (response) {
        var items = response["items"];
        for (var i = 0; i < items.length; i++) {
            items[i]["dateCreated"] = moment_es6_1.default(items[i]["dateCreated"]).local().format('LLL');
            items[i]["dateModified"] = moment_es6_1.default(items[i]["dateModified"]).local().format('LLL');
        }
        return response;
    };
    DashboardService.prototype.setDashboardTitle = function (planTable, plans) {
        var _this = this;
        if (plans === void 0) { plans = null; }
        _.forEach(planTable ? planTable.items : plans, function (plan) {
            plan.dashboardTitle = (_.isUndefined(plan.title) || _.isEmpty(plan.title) || _.isEmpty(plan.title[0])) ? _this.translator.t('plan-with-no-title') : plan.title;
        });
    };
    DashboardService.prototype.searchRecords = function (pageNumber, basicSearch, facets) {
        var _this = this;
        if (facets === void 0) { facets = null; }
        var rows = this.config.maxSearchRowsPerPage;
        var start = (pageNumber - 1) * rows;
        return this.http.get(this.brandingAndPortalUrl + "/searchPlans?start=" + start + "&rows=" + rows + "&query=" + basicSearch + "&facets=" + facets, this.options)
            .toPromise()
            .then(function (res) { return _this.formatDates(_this.extractData(res)); });
    };
    DashboardService = __decorate([
        core_1.Injectable(),
        __param(0, core_1.Inject(http_1.Http)),
        __param(1, core_1.Inject(config_service_1.ConfigService)),
        __param(2, core_1.Inject(translation_service_1.TranslationService)),
        __metadata("design:paramtypes", [http_1.Http,
            config_service_1.ConfigService,
            translation_service_1.TranslationService])
    ], DashboardService);
    return DashboardService;
}(base_service_1.BaseService));
exports.DashboardService = DashboardService;


/***/ }),

/***/ "./redbox-portal/angular/shared/email-service.ts":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

// Copyright (c) 2017 Queensland Cyber Infrastructure Foundation (http://www.qcif.edu.au/)
//
// GNU GENERAL PUBLIC LICENSE
//    Version 2, June 1991
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation; either version 2 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this program; if not, write to the Free Software Foundation, Inc.,
// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};
Object.defineProperty(exports, "__esModule", { value: true });
var core_1 = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
var http_1 = __webpack_require__("./node_modules/@angular/http/esm5/http.js");
__webpack_require__("./node_modules/rxjs/_esm5/add/operator/map.js");
__webpack_require__("./node_modules/rxjs/_esm5/add/operator/toPromise.js");
var base_service_1 = __webpack_require__("./redbox-portal/angular/shared/base-service.ts");
var config_service_1 = __webpack_require__("./redbox-portal/angular/shared/config-service.ts");
/**
 * User related service...
 *
 * @author <a target='_' href='https://github.com/thomcuddihy'>Thom Cuddihy</a>
 *
 */
var EmailNotificationService = /** @class */ (function (_super) {
    __extends(EmailNotificationService, _super);
    function EmailNotificationService(http, configService) {
        var _this = _super.call(this, http, configService) || this;
        _this.configService = configService;
        return _this;
    }
    EmailNotificationService.prototype.sendNotification = function (to, template, data, subject, from) {
        if (data === void 0) { data = {}; }
        if (subject === void 0) { subject = null; }
        if (from === void 0) { from = null; }
        var payload = { to: to, template: template, data: data };
        if (subject) {
            payload['subject'] = subject;
        }
        if (from) {
            payload['from'] = from;
        }
        return this.http.post(this.brandingAndPortalUrl + "/api/sendNotification", payload, this.getOptionsClient())
            .toPromise()
            .then(this.extractData);
    };
    EmailNotificationService = __decorate([
        core_1.Injectable(),
        __param(0, core_1.Inject(http_1.Http)), __param(1, core_1.Inject(config_service_1.ConfigService)),
        __metadata("design:paramtypes", [http_1.Http, config_service_1.ConfigService])
    ], EmailNotificationService);
    return EmailNotificationService;
}(base_service_1.BaseService));
exports.EmailNotificationService = EmailNotificationService;


/***/ }),

/***/ "./redbox-portal/angular/shared/fieldClasses.ts":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var field_simple_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-simple.ts");
var field_textfield_component_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-textfield.component.ts");
var field_simple_component_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-simple.component.ts");
var record_meta_component_1 = __webpack_require__("./redbox-portal/angular/shared/form/record-meta.component.ts");
var field_vocab_component_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-vocab.component.ts");
var field_repeatable_component_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-repeatable.component.ts");
var field_contributor_component_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-contributor.component.ts");
var workflow_button_component_1 = __webpack_require__("./redbox-portal/angular/shared/form/workflow-button.component.ts");
var action_button_component_1 = __webpack_require__("./redbox-portal/angular/shared/form/action-button.component.ts");
var field_relatedobjectdata_component_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-relatedobjectdata.component.ts");
var field_relatedobjectselector_component_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-relatedobjectselector.component.ts");
var field_datalocation_component_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-datalocation.component.ts");
var field_publishdatalocationselector_component_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-publishdatalocationselector.component.ts");
var field_map_component_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-map.component.ts");
var field_group_component_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-group.component.ts");
var workspace_field_component_1 = __webpack_require__("./redbox-portal/angular/shared/form/workspace-field.component.ts");
var workspace_selector_component_1 = __webpack_require__("./redbox-portal/angular/shared/form/workspace-selector.component.ts");
var field_andsvocab_component_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-andsvocab.component.ts");
exports.fieldClasses = {
    'TextField': { 'meta': field_textfield_component_1.TextField, 'comp': field_textfield_component_1.TextFieldComponent },
    'TextArea': { 'meta': field_textfield_component_1.TextArea, 'comp': field_textfield_component_1.TextAreaComponent },
    'MarkdownTextArea': { 'meta': field_textfield_component_1.MarkdownTextArea, 'comp': field_textfield_component_1.MarkdownTextAreaComponent },
    'DateTime': { 'meta': field_simple_1.DateTime, 'comp': field_simple_component_1.DateTimeComponent },
    'Container': { 'meta': field_simple_1.Container, 'comp': [field_simple_component_1.TextBlockComponent, field_group_component_1.GenericGroupComponent] },
    'TabOrAccordionContainer': { 'meta': field_simple_1.TabOrAccordionContainer, 'comp': field_simple_component_1.TabOrAccordionContainerComponent },
    'ButtonBarContainer': { 'meta': field_simple_1.ButtonBarContainer, 'comp': field_simple_component_1.ButtonBarContainerComponent },
    'AnchorOrButton': { 'meta': field_simple_1.AnchorOrButton, 'comp': field_simple_component_1.AnchorOrButtonComponent },
    'SaveButton': { 'meta': field_simple_1.SaveButton, 'comp': field_simple_component_1.SaveButtonComponent },
    'CancelButton': { 'meta': field_simple_1.CancelButton, 'comp': field_simple_component_1.CancelButtonComponent },
    'VocabField': { 'meta': field_vocab_component_1.VocabField, 'comp': field_vocab_component_1.VocabFieldComponent, 'lookupService': 'vocabFieldLookupService' },
    'RepeatableContainer': { 'meta': field_repeatable_component_1.RepeatableContainer, 'comp': [field_repeatable_component_1.RepeatableVocabComponent, field_textfield_component_1.RepeatableTextfieldComponent, field_group_component_1.RepeatableGroupComponent] },
    'RepeatableContributor': { 'meta': field_repeatable_component_1.RepeatableContributor, 'comp': field_repeatable_component_1.RepeatableContributorComponent },
    'RepeatableVocab': { 'meta': field_repeatable_component_1.RepeatableVocab, 'comp': field_repeatable_component_1.RepeatableVocabComponent },
    'ContributorField': { 'meta': field_contributor_component_1.ContributorField, 'comp': field_contributor_component_1.ContributorComponent, 'lookupService': 'vocabFieldLookupService' },
    'HiddenValue': { 'meta': field_simple_1.HiddenValue, 'comp': field_simple_component_1.HiddenValueComponent },
    'WorkflowStepButton': { 'meta': workflow_button_component_1.WorkflowStepButton, 'comp': workflow_button_component_1.WorkflowStepButtonComponent },
    'ActionButton': { 'meta': action_button_component_1.ActionButton, 'comp': action_button_component_1.ActionButtonComponent },
    'LinkValueComponent': { 'meta': field_simple_1.LinkValue, 'comp': field_simple_component_1.LinkValueComponent },
    'SelectionField': { 'meta': field_simple_1.SelectionField, 'comp': [field_simple_component_1.SelectionFieldComponent, field_simple_component_1.DropdownFieldComponent] },
    'RelatedObjectDataField': { 'meta': field_relatedobjectdata_component_1.RelatedObjectDataField, 'comp': field_relatedobjectdata_component_1.RelatedObjectDataComponent, 'lookupService': 'vocabFieldLookupService' },
    'MapField': { 'meta': field_map_component_1.MapField, 'comp': field_map_component_1.MapComponent, 'lookupService': 'vocabFieldLookupService' },
    'ParameterRetriever': { 'meta': field_simple_1.ParameterRetrieverField, 'comp': field_simple_component_1.ParameterRetrieverComponent },
    'RecordMetadataRetriever': { 'meta': record_meta_component_1.RecordMetadataRetrieverField, 'comp': record_meta_component_1.RecordMetadataRetrieverComponent },
    'RelatedObjectSelector': { 'meta': field_relatedobjectselector_component_1.RelatedObjectSelectorField, 'comp': field_relatedobjectselector_component_1.RelatedObjectSelectorComponent },
    'DataLocation': { 'meta': field_datalocation_component_1.DataLocationField, 'comp': field_datalocation_component_1.DataLocationComponent },
    'WorkspaceSelectorField': { 'meta': workspace_field_component_1.WorkspaceSelectorField, 'comp': [workspace_selector_component_1.WorkspaceSelectorComponent, workspace_selector_component_1.WorkspaceSelectorFieldComponent] },
    'PublishDataLocationSelector': { 'meta': field_publishdatalocationselector_component_1.PublishDataLocationSelectorField, 'comp': field_publishdatalocationselector_component_1.PublishDataLocationSelectorComponent },
    'TabNavButton': { 'meta': field_simple_1.TabNavButton, 'comp': field_simple_component_1.TabNavButtonComponent },
    'Spacer': { 'meta': field_simple_1.Spacer, 'comp': field_simple_component_1.SpacerComponent },
    'ANDSVocab': { 'meta': field_andsvocab_component_1.ANDSVocabField, 'comp': field_andsvocab_component_1.ANDSVocabComponent }
};


/***/ }),

/***/ "./redbox-portal/angular/shared/form/action-button.component.ts":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
Object.defineProperty(exports, "__esModule", { value: true });
var core_1 = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
var field_simple_component_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-simple.component.ts");
var field_base_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-base.ts");
var records_service_1 = __webpack_require__("./redbox-portal/angular/shared/form/records.service.ts");
var ActionButton = /** @class */ (function (_super) {
    __extends(ActionButton, _super);
    function ActionButton(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.submitting = false;
        _this.targetAction = options['targetAction'] || null;
        _this.recordService = _this.getFromInjector(records_service_1.RecordsService);
        _this.value = options['value'] || null;
        return _this;
    }
    ActionButton.prototype.setValue = function (value) {
        this.value = value;
        this.formModel.patchValue(value, { emitEvent: true, emitModelToViewChange: true });
        this.formModel.markAsTouched();
    };
    return ActionButton;
}(field_base_1.FieldBase));
exports.ActionButton = ActionButton;
// For action buttons
var ActionButtonComponent = /** @class */ (function (_super) {
    __extends(ActionButtonComponent, _super);
    function ActionButtonComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    ActionButtonComponent.prototype.executeAction = function (event) {
        this.field.submitting = true;
        var that = this;
        this.field.recordService.executeAction(this.field.targetAction, { oid: this.field.fieldMap._rootComp.oid })
            .then(function (response) {
            that.field.submitting = false;
            that.field.setValue("http://203.101.227.135:5000/dataset/" + that.field.fieldMap._rootComp.oid);
            that.fieldMap._rootComp.onSubmit().subscribe();
        });
    };
    ActionButtonComponent.prototype.isDisabled = function () {
        return false;
    };
    ActionButtonComponent = __decorate([
        core_1.Component({
            selector: 'action-button',
            template: "\n  <div *ngIf=\"field.editMode\">\n    <div *ngIf=\"field.value\">Record published to CKAN at <a target=\"_blank\" [attr.href]=\"field.value\">{{ field.value }}</a></div>\n    <div *ngIf=\"!field.value\"><button *ngIf=\"!field.submitting\" type=\"{{field.type}}\" [ngClass]=\"field.cssClasses\" (click)=\"executeAction($event)\" [disabled]=\"isDisabled()\">{{field.label}}</button><span *ngIf=\"field.submitting\">Submitting to CKAN</span>\n    </div>\n    <div [formGroup]='form'>\n    <input [formControl]=\"getFormControl()\"  [id]=\"field.name\" name=\"{{field.name}}\" type=\"hidden\" />\n    </div>\n  </div>\n  <div *ngIf=\"!field.editMode\">\n    <div *ngIf=\"field.value\">Record published to CKAN at <a target=\"_blank\" [attr.href]=\"field.value\">{{ field.value }}</a></div>\n    <div *ngIf=\"!field.value\">Record not yet published</div>\n  </div>\n  ",
        })
    ], ActionButtonComponent);
    return ActionButtonComponent;
}(field_simple_component_1.SimpleComponent));
exports.ActionButtonComponent = ActionButtonComponent;


/***/ }),

/***/ "./redbox-portal/angular/shared/form/dmp-field.component.ts":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

// Copyright (c) 2017 Queensland Cyber Infrastructure Foundation (http://www.qcif.edu.au/)
//
// GNU GENERAL PUBLIC LICENSE
//    Version 2, June 1991
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation; either version 2 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this program; if not, write to the Free Software Foundation, Inc.,
// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};
Object.defineProperty(exports, "__esModule", { value: true });
var core_1 = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
var forms_1 = __webpack_require__("./node_modules/@angular/forms/esm5/forms.js");
var field_base_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-base.ts");
var _ = __webpack_require__("./node_modules/lodash-es/lodash.js");
/**
 * Base component for a DMP field.
 *
 * Author: <a href='https://github.com/shilob' target='_blank'>Shilo Banihit</a>
 *
 */
var DmpFieldComponent = /** @class */ (function () {
    /**
     * For DI'ing...
     */
    function DmpFieldComponent(componentFactoryResolver, app) {
        this.componentFactoryResolver = componentFactoryResolver;
        this.app = app;
        this.isEmbedded = false;
        this.disabledElements = [];
    }
    Object.defineProperty(DmpFieldComponent.prototype, "isValid", {
        /**
         * If the form is valid.
         */
        get: function () {
            if (this.form && this.form.controls) {
                return this.form.controls[this.field.name].valid;
            }
            return false;
        },
        enumerable: true,
        configurable: true
    });
    /**
     *
     */
    DmpFieldComponent.prototype.isDisabled = function () {
        var disabledExpression = this.field.options['disabledExpression'];
        if (disabledExpression != null) {
            var imports = this.fieldAnchor;
            var variables = {};
            variables['imports'] = this.fieldMap._rootComp;
            var compiled = _.template(disabledExpression, variables);
            var parentElement = jQuery(this.fieldElement.nativeElement.parentElement);
            if (compiled() == "true") {
                //take note of which elements where already disabled as we dont want to enable them if whole component becomes enabled again
                this.disabledElements = parentElement.find('*:disabled');
                parentElement.find('input').prop("disabled", true);
                return 'disabled';
            }
            else {
                if (jQuery(this.fieldElement.nativeElement).prop('disabled') == 'disabled') {
                    //previously disabled so lets re-enable
                    parentElement.find('input').prop("disabled", false);
                    _.each(this.disabledElements, function (disabledElement) { return disabledElement.prop("disabled", true); });
                }
                return null;
            }
        }
        return null;
    };
    /**
     * Change handler, instantiates the field component.
     */
    DmpFieldComponent.prototype.ngOnChanges = function () {
        if (!this.field || !this.componentFactoryResolver) {
            return;
        }
        this.fieldAnchor.clear();
        var compFactory = this.componentFactoryResolver.resolveComponentFactory(this.field.compClass);
        var fieldCompRef = this.fieldAnchor.createComponent(compFactory, undefined, this.app['_injector']);
        fieldCompRef.instance.injector = this.app['_injector'];
        fieldCompRef.instance.field = this.field;
        fieldCompRef.instance.form = this.form;
        fieldCompRef.instance.fieldMap = this.fieldMap;
        fieldCompRef.instance.parentId = this.parentId;
        fieldCompRef.instance.isEmbedded = this.isEmbedded;
        fieldCompRef.instance.name = this.name;
        fieldCompRef.instance.index = this.index;
        // flip thi: make the fields responsible for setting the right fieldMap member
        this.field.setFieldMapEntry(this.fieldMap, fieldCompRef);
        //this.fieldMap[this.field.name].instance = fieldCompRef.instance;
    };
    __decorate([
        core_1.Input(),
        __metadata("design:type", field_base_1.FieldBase)
    ], DmpFieldComponent.prototype, "field", void 0);
    __decorate([
        core_1.Input(),
        __metadata("design:type", forms_1.FormGroup)
    ], DmpFieldComponent.prototype, "form", void 0);
    __decorate([
        core_1.Input(),
        __metadata("design:type", Object)
    ], DmpFieldComponent.prototype, "value", void 0);
    __decorate([
        core_1.Input(),
        __metadata("design:type", Object)
    ], DmpFieldComponent.prototype, "fieldMap", void 0);
    __decorate([
        core_1.ViewChild('field', { read: core_1.ViewContainerRef }),
        __metadata("design:type", core_1.ViewContainerRef)
    ], DmpFieldComponent.prototype, "fieldAnchor", void 0);
    __decorate([
        core_1.Input(),
        __metadata("design:type", String)
    ], DmpFieldComponent.prototype, "parentId", void 0);
    __decorate([
        core_1.Input(),
        __metadata("design:type", Boolean)
    ], DmpFieldComponent.prototype, "isEmbedded", void 0);
    __decorate([
        core_1.Input(),
        __metadata("design:type", Object)
    ], DmpFieldComponent.prototype, "name", void 0);
    __decorate([
        core_1.Input(),
        __metadata("design:type", Number)
    ], DmpFieldComponent.prototype, "index", void 0);
    __decorate([
        core_1.ViewChild('field'),
        __metadata("design:type", Object)
    ], DmpFieldComponent.prototype, "fieldElement", void 0);
    DmpFieldComponent = __decorate([
        core_1.Component({
            selector: 'dmp-field',
            template: '<span [attr.disabled]="isDisabled()" #field></span>'
        }),
        __param(0, core_1.Inject(core_1.ComponentFactoryResolver)),
        __metadata("design:paramtypes", [core_1.ComponentFactoryResolver, core_1.ApplicationRef])
    ], DmpFieldComponent);
    return DmpFieldComponent;
}());
exports.DmpFieldComponent = DmpFieldComponent;


/***/ }),

/***/ "./redbox-portal/angular/shared/form/field-andsvocab.component.ts":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};
Object.defineProperty(exports, "__esModule", { value: true });
// Copyright (c) 2017 Queensland Cyber Infrastructure Foundation (http://www.qcif.edu.au/)
//
// GNU GENERAL PUBLIC LICENSE
//    Version 2, June 1991
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation; either version 2 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this program; if not, write to the Free Software Foundation, Inc.,
// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
var core_1 = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
var field_simple_component_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-simple.component.ts");
var field_base_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-base.ts");
var ands_service_1 = __webpack_require__("./redbox-portal/angular/shared/ands-service.ts");
var _ = __webpack_require__("./node_modules/lodash-es/lodash.js");
/**
 *  Vocab Model
 *
 *
 * @author <a target='_' href='https://github.com/shilob'>Shilo Banihit</a>
 *
 */
var ANDSVocabField = /** @class */ (function (_super) {
    __extends(ANDSVocabField, _super);
    function ANDSVocabField(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.settings = {
            rootIsVisible: false,
            showCheckboxes: true,
            cascadeCheckboxSelectToChildren: false
        };
        _this.tree = {
            value: 'Icons',
            children: []
        };
        _this.value = options['value'] || _this.setEmptyValue();
        _this.vocabId = options['vocabId'] || 'anzsrc-for';
        _this.andsService = _this.getFromInjector(ands_service_1.ANDSService);
        return _this;
    }
    ANDSVocabField.prototype.setValue = function (value, emitEvent) {
        if (emitEvent === void 0) { emitEvent = true; }
        _.remove(value, function (item) {
            if (item['about'] == "") {
                return true;
            }
        });
        this.formModel.setValue(value, { emitEvent: emitEvent, emitModelToViewChange: true });
        this.formModel.markAsTouched();
        this.formModel.markAsDirty();
    };
    ANDSVocabField.prototype.setEmptyValue = function () {
        this.value = [];
        return this.value;
    };
    return ANDSVocabField;
}(field_base_1.FieldBase));
exports.ANDSVocabField = ANDSVocabField;
/**
* Component utilising the ANDS Vocabb selector widget
*
*
*
*
*/
var ANDSVocabComponent = /** @class */ (function (_super) {
    __extends(ANDSVocabComponent, _super);
    function ANDSVocabComponent(elementRef) {
        var _this = _super.call(this) || this;
        _this.callbackMap = {};
        _this.topElements = [];
        _this.treeData = [];
        _this.narrowingArray = [];
        _this.initialisingTree = true;
        _this.childNodeMap = {};
        _this.elementRef = elementRef;
        return _this;
    }
    ANDSVocabComponent.prototype.ngOnInit = function () {
        if (this.field.editMode) {
            var that_1 = this;
            jQuery(this.elementRef.nativeElement)['vocab_widget']({
                repository: this.field.vocabId,
                endpoint: 'https://vocabs.ands.org.au/apps/vocab_widget/proxy/',
                fields: ["label", "notation", "about"],
                cache: false
            });
            jQuery(this.elementRef.nativeElement).on('narrow.vocab.ands', function (event, data) {
                if (that_1.initialisingTree) {
                    if (data.items.length > 0) {
                        var broader_1 = data['items'][0]['broader'];
                        var items_1 = [];
                        _.each(data.items, function (item) {
                            var child = {};
                            if (item.narrower && item.narrower.length > 0) {
                                child['children'] = [{ value: "won't be displayed" }];
                                child['loadChildren'] = function (callback) {
                                    that_1.callbackMap[item.about] = callback;
                                    jQuery(that_1.elementRef.nativeElement)['vocab_widget']('narrow', item.about);
                                };
                            }
                            child['value'] = item.notation + " - " + item.label;
                            child['id'] = item.about;
                            child['item'] = item;
                            if (that_1.childNodeMap[item.about]) {
                                child['children'] = that_1.childNodeMap[item.about];
                                that_1.childNodeMap = _.omit(that_1.childNodeMap, item.about);
                            }
                            items_1.push(child);
                        });
                        that_1.childNodeMap[broader_1] = items_1;
                        that_1.field.andsService.getResourceDetails(broader_1, that_1.field.vocabId).then(function (data) {
                            if (data["result"]["primaryTopic"]["broader"]) {
                                jQuery(that_1.elementRef.nativeElement)['vocab_widget']('narrow', data["result"]["primaryTopic"]["broader"]);
                                that_1.narrowingArray.push(data["result"]["primaryTopic"]["broader"]);
                            }
                            that_1.narrowingArray = _.pull(that_1.narrowingArray, broader_1);
                            if (that_1.narrowingArray.length == 0) {
                                that_1.initialisingTree = false;
                                that_1.buildTree();
                            }
                        });
                    }
                }
                else {
                    var items_2 = [];
                    if (data.items.length > 0) {
                        var callback = that_1.callbackMap[data.items[0]['broader']];
                        _.each(data.items, function (item) {
                            var child = {};
                            if (item.narrower && item.narrower.length > 0) {
                                child['children'] = [{ value: "won't be displayed" }];
                                child['loadChildren'] = function (callback) {
                                    that_1.callbackMap[item.about] = callback;
                                    jQuery(that_1.elementRef.nativeElement)['vocab_widget']('narrow', item.about);
                                };
                            }
                            child['value'] = item.notation + " - " + item.label;
                            child['id'] = item.about;
                            child['item'] = item;
                            items_2.push(child);
                        });
                        callback(items_2);
                    }
                }
            });
            jQuery(this.elementRef.nativeElement).on('top.vocab.ands', function (event, data) {
                if (that_1.field.value.length > 0) {
                    that_1.treeData = data;
                    var foundBroader_1 = false;
                    _.each(that_1.field.value, function (item) {
                        if (item['broader']) {
                            foundBroader_1 = true;
                            jQuery(that_1.elementRef.nativeElement)['vocab_widget']('narrow', item.broader);
                            that_1.narrowingArray.push(item.broader);
                        }
                    });
                    if (!foundBroader_1) {
                        that_1.buildTree();
                    }
                }
                else {
                    that_1.treeData = data;
                    that_1.buildTree();
                }
            });
            jQuery(this.elementRef.nativeElement)['vocab_widget']('top');
        }
    };
    ANDSVocabComponent.prototype.buildTree = function () {
        var items = [];
        var that = this;
        _.each(this.treeData.items, function (item) {
            var child = {
                children: [{ value: "won't be displayed" }],
            };
            if (that.childNodeMap[item.about]) {
                child['children'] = that.childNodeMap[item.about];
                that.childNodeMap = _.omit(that.childNodeMap, item.about);
            }
            else {
                child['loadChildren'] = function (callback) {
                    that.callbackMap[item.about] = callback;
                    jQuery(that.elementRef.nativeElement)['vocab_widget']('narrow', item.about);
                };
            }
            child['value'] = item.notation + " - " + item.label;
            child['id'] = item.about;
            child['item'] = item;
            items.push(child);
        });
        this.initialisingTree = false;
        this.field.tree = {
            value: '',
            children: items,
            settings: {
                cssClasses: {
                    expanded: 'fa fa-caret-down',
                    collapsed: 'fa fa-caret-right',
                    empty: 'fa fa-caret-right disabled',
                    leaf: 'fa'
                }
            }
        };
    };
    ANDSVocabComponent.prototype.ngAfterViewInit = function () {
        var _this = this;
        if (this.field.editMode) {
            _.each(this.field.value, function (item) {
                _this.checkNode(item.about);
            });
        }
    };
    ANDSVocabComponent.prototype.checkNode = function (id) {
        var treeController = this.andsTree.getControllerByNodeId(id);
        if (treeController) {
            treeController.check();
        }
        else {
            console.log("Controller is absent for a node with id: " + id);
        }
    };
    ANDSVocabComponent.prototype.handleSelected = function (event) {
        var node = event.node.node;
        if (_.findIndex(this.field.value, function (item) { return item['about'] == node.about; }) != -1) {
            this.field.value.push(node.item);
            this.field.setValue(this.field.value);
        }
        return false;
    };
    ANDSVocabComponent.prototype.handleUnSelected = function (event) {
        var node = event.node.node;
        _.remove(this.field.value, function (element) {
            return element['about'] == node.item.about;
        });
        this.field.setValue(this.field.value);
    };
    ANDSVocabComponent.prototype.controllerCreated = function (event) {
        var id = event.id;
        var controller = event.controller;
        if (_.findIndex(this.field.value, function (item) { return item['about'] == id; }) != -1) {
            window.setTimeout(function () { controller.check(); }, 500);
        }
    };
    __decorate([
        core_1.ViewChild('andsTree'),
        __metadata("design:type", Object)
    ], ANDSVocabComponent.prototype, "andsTree", void 0);
    ANDSVocabComponent = __decorate([
        core_1.Component({
            selector: 'ands-vocab-selector',
            template: __webpack_require__("./redbox-portal/angular/shared/form/field-andsvocab.html"),
            styles: ['span.node-name { font-size: 300%; }']
        }),
        __param(0, core_1.Inject(core_1.ElementRef)),
        __metadata("design:paramtypes", [core_1.ElementRef])
    ], ANDSVocabComponent);
    return ANDSVocabComponent;
}(field_simple_component_1.SimpleComponent));
exports.ANDSVocabComponent = ANDSVocabComponent;


/***/ }),

/***/ "./redbox-portal/angular/shared/form/field-andsvocab.html":
/***/ (function(module, exports) {

module.exports = "<div *ngIf=\"!field.editMode\" class=\"key-value-pair\">\n  <span *ngIf=\"field.label\" class=\"key\">{{field.label}}</span>\n  <ul>\n    <li *ngFor=\"let value of field.value\">{{ value.notation }} - {{ value.label }}</li>\n  </ul>\n</div>\n<div *ngIf=\"field.editMode\" [formGroup]='form' [ngClass]=\"getGroupClass()\">\n  <label>\n    {{field.label}} {{getRequiredLabelStr()}}\n    <button type=\"button\" class=\"btn btn-default\" *ngIf=\"field.help\" (click)=\"toggleHelp()\"><span class=\"glyphicon glyphicon-question-sign\" aria-hidden=\"true\"></span></button>\n  </label>\n  <span id=\"{{ 'helpBlock_' + field.name }}\" class=\"help-block\" *ngIf=\"this.helpShow\" >{{field.help}}</span>\n  <tree #andsTree [tree]=\"field.tree\" [settings]=\"field.settings\" (nodeCreated)=\"handleCreated($event)\" (nodeChecked)=\"handleSelected($event)\" (nodeUnchecked)=\"handleUnSelected($event)\" (treeControllerCreated)=\"controllerCreated($event)\"> </tree>\n  <div class=\"text-danger\" *ngIf=\"hasRequiredError()\">{{field.validationMessages.required}}</div>\n</div>\n"

/***/ }),

/***/ "./redbox-portal/angular/shared/form/field-base.ts":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

// Copyright (c) 2017 Queensland Cyber Infrastructure Foundation (http://www.qcif.edu.au/)
//
// GNU GENERAL PUBLIC LICENSE
//    Version 2, June 1991
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation; either version 2 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this program; if not, write to the Free Software Foundation, Inc.,
// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
Object.defineProperty(exports, "__esModule", { value: true });
var core_1 = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
var forms_1 = __webpack_require__("./node_modules/@angular/forms/esm5/forms.js");
var translation_service_1 = __webpack_require__("./redbox-portal/angular/shared/translation-service.ts");
var _ = __webpack_require__("./node_modules/lodash-es/lodash.js");
/**
 * Base class for dynamic form models...
 *
 * Author: <a href='https://github.com/shilob' target='_blank'>Shilo Banihit</a>
 *
 */
var FieldBase = /** @class */ (function () {
    function FieldBase(options, injector) {
        if (options === void 0) { options = {}; }
        this.componentReactors = [];
        this.onValueUpdate = new core_1.EventEmitter();
        this.injector = injector;
        this.translationService = this.getFromInjector(translation_service_1.TranslationService);
        this.setOptions(options);
    }
    FieldBase.prototype.getFromInjector = function (token) {
        return this.injector.get(token);
    };
    FieldBase.prototype.setOptions = function (options) {
        var _this = this;
        if (options === void 0) { options = {}; }
        this.value = this.getTranslated(options.value, undefined);
        this.name = options.name || '';
        this.id = options.id || '';
        this.label = this.getTranslated(options.label, '');
        this.help = this.getTranslated(options.help, undefined);
        this.required = !!options.required;
        this.controlType = options.controlType || '';
        this.cssClasses = options.cssClasses || {}; // array of
        this.groupClasses = options['groupClasses'] || '';
        this.groupName = options.groupName || null;
        this.editMode = options.editMode || false;
        this.readOnly = options.readOnly || false;
        this.onChange = options['onChange'] || null;
        this.publish = options['publish'] || null;
        this.subscribe = options['subscribe'] || null;
        if (this.groupName) {
            this.hasGroup = true;
        }
        this.options = options;
        this.hasControl = true;
        this.validationMessages = {};
        _.forOwn(options['validationMessages'] || {}, function (messageKey, messageName) {
            _this.validationMessages[messageName] = _this.getTranslated(messageKey, messageKey);
        });
        this.defaultValue = this.getTranslated(options.defaultValue, undefined);
        if ((_.isUndefined(this.value) || _.isEmpty(this.value)) && !_.isUndefined(this.defaultValue)) {
            this.value = this.defaultValue;
        }
    };
    FieldBase.prototype.getTranslated = function (key, defValue) {
        if (!_.isEmpty(key) && !_.isUndefined(key)) {
            if (_.isFunction(key.startsWith) && key.startsWith('@') && this.translationService) {
                return this.translationService.t(key);
            }
            else {
                return key;
            }
        }
        else {
            return defValue;
        }
    };
    Object.defineProperty(FieldBase.prototype, "isValid", {
        get: function () {
            if (this.form && this.form.controls) {
                return this.form.controls[this.name].valid;
            }
            return false;
        },
        enumerable: true,
        configurable: true
    });
    FieldBase.prototype.createFormModel = function (valueElem) {
        if (valueElem === void 0) { valueElem = null; }
        if (valueElem) {
            this.value = valueElem;
        }
        this.formModel = this.required ? new forms_1.FormControl(this.value || '', forms_1.Validators.required)
            : new forms_1.FormControl(this.value || '');
        return this.formModel;
    };
    /**
     * Creates a control group and populates field map with:
     *
     * fieldMap[name].control = the NG2 FormControl
     * fieldMap[name].field = the Field model (this)
     *
     * Author: <a href='https://github.com/shilob' target='_blank'>Shilo Banihit</a>
     * @param  {any} group
     * @param  {any} fieldMap
     * @return {any}
     */
    FieldBase.prototype.getGroup = function (group, fieldMap) {
        this.fieldMap = fieldMap;
        var retval = null;
        _.set(fieldMap, this.getFullFieldName() + ".field", this);
        var control = this.createFormModel();
        _.set(fieldMap, this.getFullFieldName() + ".control", control);
        if (this.hasGroup && this.groupName) {
            if (group[this.groupName]) {
                group[this.groupName].addControl(this.name, control);
            }
            else {
                var fg = {};
                fg[this.name] = control;
                group[this.groupName] = new forms_1.FormGroup(fg);
            }
            retval = group[this.groupName];
        }
        else {
            if (this.hasControl) {
                group[this.name] = control;
                retval = group[this.name];
            }
        }
        return retval;
    };
    FieldBase.prototype.triggerValidation = function () {
        if (this.formModel) {
            this.formModel.markAsTouched();
            this.formModel.updateValueAndValidity({ onlySelf: false, emitEvent: false });
        }
    };
    FieldBase.prototype.valueNotNull = function (data) {
        return !_.isNull(data) && (_.isArray(data) ? (!_.isNull(data[0])) : true);
    };
    FieldBase.prototype.setupEventHandlers = function () {
        var _this = this;
        if (!_.isEmpty(this.formModel)) {
            var publishConfig = this.publish;
            var subscribeConfig = this.subscribe;
            if (!_.isEmpty(publishConfig)) {
                _.forOwn(publishConfig, function (eventConfig, eventName) {
                    console.log("Setting up " + eventName + " handlers for field: " + _this.name);
                    var eventSource = eventConfig.modelEventSource;
                    _this.formModel[eventSource].subscribe(function (value) {
                        if (_this.valueNotNull(value)) {
                            var emitData_1 = value;
                            if (!_.isEmpty(eventConfig.fields)) {
                                if (_.isArray(value)) {
                                    emitData_1 = [];
                                    _.each(value, function (v) {
                                        if (!_.isEmpty(v)) {
                                            var item_1 = {};
                                            _.each(eventConfig.fields, function (f) {
                                                _.forOwn(f, function (src, tgt) {
                                                    item_1[tgt] = _.get(v, src);
                                                });
                                            });
                                            emitData_1.push(item_1);
                                        }
                                    });
                                }
                                else {
                                    emitData_1 = {};
                                    if (!_.isEmpty(value)) {
                                        _.each(eventConfig.fields, function (f) {
                                            _.forOwn(f, function (src, tgt) {
                                                emitData_1[tgt] = _.get(value, src);
                                            });
                                        });
                                    }
                                }
                            }
                            console.log("Emitting data:");
                            console.log(emitData_1);
                            _this.emitEvent(eventName, emitData_1, value);
                        }
                    });
                });
            }
            if (!_.isEmpty(subscribeConfig)) {
                _.forOwn(subscribeConfig, function (subConfig, srcName) {
                    _.forOwn(subConfig, function (eventConfArr, eventName) {
                        var eventEmitter = srcName == "this" ? _this[eventName] : _this.fieldMap[srcName].field[eventName];
                        eventEmitter.subscribe(function (value) {
                            var curValue = value;
                            if (_.isArray(value)) {
                                curValue = [];
                                _.each(value, function (v) {
                                    var entryVal = v;
                                    _.each(eventConfArr, function (eventConf) {
                                        var fn = _.get(_this, eventConf.action);
                                        if (fn) {
                                            var boundFunction = fn;
                                            if (eventConf.action.indexOf(".") == -1) {
                                                boundFunction = fn.bind(_this);
                                            }
                                            else {
                                                var objectName = eventConf.action.substring(0, eventConf.action.indexOf("."));
                                                boundFunction = fn.bind(_this[objectName]);
                                            }
                                            entryVal = boundFunction(entryVal, eventConf);
                                        }
                                    });
                                    if (!_.isEmpty(entryVal)) {
                                        curValue.push(entryVal);
                                    }
                                });
                            }
                            else {
                                _.each(eventConfArr, function (eventConf) {
                                    var fn = _.get(_this, eventConf.action);
                                    if (fn) {
                                        var boundFunction = fn;
                                        if (eventConf.action.indexOf(".") == -1) {
                                            boundFunction = fn.bind(_this);
                                        }
                                        else {
                                            var objectName = eventConf.action.substring(0, eventConf.action.indexOf("."));
                                            boundFunction = fn.bind(_this[objectName]);
                                        }
                                        curValue = boundFunction(curValue, eventConf);
                                    }
                                });
                            }
                            _this.reactEvent(eventName, curValue, value);
                        });
                    });
                });
            }
        }
    };
    FieldBase.prototype.emitEvent = function (eventName, eventData, origData) {
        this[eventName].emit(eventData);
    };
    FieldBase.prototype.reactEvent = function (eventName, eventData, origData) {
        var _this = this;
        this.value = eventData;
        this.formModel.setValue(eventData, { onlySelf: true, emitEvent: false });
        _.each(this.componentReactors, function (compReact) {
            compReact.reactEvent(eventName, eventData, origData, _this);
        });
    };
    FieldBase.prototype.setFieldMapEntry = function (fieldMap, fieldCompRef) {
        if (!_.isUndefined(this.name) && !_.isEmpty(this.name) && !_.isNull(this.name)) {
            _.set(fieldMap, this.getFullFieldName() + ".instance", fieldCompRef.instance);
        }
    };
    FieldBase.prototype.getFullFieldName = function (name) {
        if (name === void 0) { name = null; }
        var fldName = "" + (name ? name : this.name);
        // console.log(`Using fldName: ${fldName}`);
        // console.log(this.fieldMap);
        return fldName;
    };
    FieldBase.prototype.getControl = function (name, fieldMap) {
        if (name === void 0) { name = null; }
        if (fieldMap === void 0) { fieldMap = null; }
        return _.get(fieldMap ? fieldMap : this.fieldMap, this.getFullFieldName(name) + ".control");
    };
    FieldBase.prototype.setValue = function (value, emitEvent) {
        if (emitEvent === void 0) { emitEvent = true; }
        this.value = value;
        this.formModel.setValue(value, { onlySelf: true, emitEvent: emitEvent });
    };
    __decorate([
        core_1.Output(),
        __metadata("design:type", core_1.EventEmitter)
    ], FieldBase.prototype, "onValueUpdate", void 0);
    return FieldBase;
}());
exports.FieldBase = FieldBase;


/***/ }),

/***/ "./redbox-portal/angular/shared/form/field-contributor.component.html":
/***/ (function(module, exports) {

module.exports = "<div *ngIf=\"field.editMode\" class='padding-bottom-10'>\n  <div class=\"row\" *ngIf=\"field.label && field.showHeader\">\n    <div class=\"col-xs-4\">\n      <h5>\n        {{field.label}} {{getRequiredLabelStr()}}\n        <button type=\"button\" class=\"btn btn-default\" *ngIf=\"field.help\" (click)=\"toggleHelp()\"><span class=\"glyphicon glyphicon-question-sign\" aria-hidden=\"true\"></span></button>\n      </h5>\n      <span id=\"{{ 'helpBlock_' + field.name }}\" class=\"help-block\" *ngIf=\"this.helpShow\" [innerHtml]=\"field.help\"></span>\n    </div>\n  </div>\n  <div class=\"row\">\n    <ng-container *ngIf=\"field.freeText\" [formGroup]='field.formModel'>\n      <!-- Free Text version -->\n      <!--\n      <ng-container >\n        <div [ngClass]=\"getGroupClass('name')\">\n          <input formControlName=\"name\" type=\"text\" class=\"form-control\"/>\n          <div class=\"text-danger\" *ngIf=\"field.formModel.controls['name'].touched && field.formModel.controls['name'].hasError('required')\">{{field.validationMessages.required.name}}</div>\n        </div>\n        <div [ngClass]=\"getGroupClass('email')\">\n          <input formControlName=\"email\" type=\"text\" class=\"form-control\" />\n          <div class=\"text-danger\" *ngIf=\"field.formModel.controls['email'].touched && field.formModel.controls['email'].hasError('email')\">{{field.validationMessages.invalid.email}}</div>\n          <div class=\"text-danger\" *ngIf=\"field.formModel.controls['email'].touched && field.formModel.controls['email'].hasError('required')\">{{field.validationMessages.required.email}}</div>\n        </div>\n        <div >\n          <input formControlName=\"orcid\" type=\"text\" class=\"form-control\"/>\n        </div>\n      </ng-container>  -->\n\n      <div *ngIf=\"!isEmbedded\">\n        <div class=\"row\">\n          <span class='col-xs-10' >\n            <!-- Free text not embedded version -->\n            <div class='col-xs-1'>\n              <span class='text-right'>{{ field.nameColHdr }}</span>\n            </div>\n            <div [ngClass]=\"getGroupClass('text_full_name')\">\n              <input formControlName=\"text_full_name\" type=\"text\" class=\"form-control\"/>\n              <div class=\"text-danger\" *ngIf=\"field.formModel.controls['text_full_name'].touched && field.formModel.controls['text_full_name'].hasError('required')\">{{field.validationMessages.required.text_full_name}}</div>\n            </div>\n            <div class='col-xs-1'>\n              <span class='text-right'>{{ field.emailColHdr }}</span>\n            </div>\n            <div [ngClass]=\"getGroupClass('email')\">\n              <input formControlName=\"email\" type=\"text\" class=\"form-control\" />\n              <div class=\"text-danger\" *ngIf=\"field.formModel.controls['email'].touched && field.formModel.controls['email'].hasError('email')\">{{field.validationMessages.invalid.email}}</div>\n              <div class=\"text-danger\" *ngIf=\"field.formModel.controls['email'].touched && field.formModel.controls['email'].hasError('required')\">{{field.validationMessages.required.email}}</div>\n            </div>\n            <div class='col-xs-1'>\n              <span class='text-right'>{{ field.orcidColHdr }}</span>\n            </div>\n            <div [ngClass]=\"getGroupClass('orcid')\">\n              <input formControlName=\"orcid\" type=\"text\" class=\"form-control\"/>\n            </div>\n          </span>\n        </div>\n      </div>\n\n      <ng-container *ngIf=\"isEmbedded\">\n        <!-- Embedded free text version -->\n        <div class='col-xs-1'>\n          <span class='text-right'>{{ field.nameColHdr }}</span>\n        </div>\n        <div [ngClass]=\"getGroupClass('text_full_name')\">\n          <input formControlName=\"text_full_name\" type=\"text\" class=\"form-control\"/>\n          <div class=\"text-danger\" *ngIf=\"field.formModel.controls['text_full_name'].touched && field.formModel.controls['text_full_name'].hasError('required')\">{{field.validationMessages.required.text_full_name}}</div>\n        </div>\n        <div class='col-xs-1'>\n          <span class='text-right'>{{ field.emailColHdr }}</span>\n        </div>\n        <div [ngClass]=\"getGroupClass('email')\">\n          <input formControlName=\"email\" type=\"text\" class=\"form-control\" />\n          <div class=\"text-danger\" *ngIf=\"field.formModel.controls['email'].touched && field.formModel.controls['email'].hasError('email')\">{{field.validationMessages.invalid.email}}</div>\n          <div class=\"text-danger\" *ngIf=\"field.formModel.controls['email'].touched && field.formModel.controls['email'].hasError('required')\">{{field.validationMessages.required.email}}</div>\n        </div>\n        <div class='col-xs-1'>\n          <span class='text-right'>{{ field.orcidColHdr }}</span>\n        </div>\n        <div [ngClass]=\"getGroupClass('orcid')\">\n          <input formControlName=\"orcid\" type=\"text\" class=\"form-control\" />\n        </div>\n      </ng-container>\n\n    </ng-container>\n    <!-- Lookup version -->\n    <ng-container *ngIf=\"!field.freeText\" [formGroup]=\"field.formModel\">\n      <div *ngIf=\"!isEmbedded\">\n        <div class=\"row\">\n          <span class='col-xs-10' >\n            <!-- Lookup Not Embedded version -->\n            <div class='col-xs-1'>\n              <span class='text-right'>{{ field.nameColHdr }}</span>\n            </div>\n            <div [ngClass]=\"getGroupClass('text_full_name')\">\n              <ng2-completer #ngCompleter [overrideSuggested]=\"!field.forceLookupOnly\" [inputClass]=\"'form-control'\" [placeholder]=\"field.vocabField.placeHolder\" [clearUnselected]=\"field.forceLookupOnly\" (selected)=\"onSelect($event)\" [datasource]=\"field.vocabField.dataService\" [minSearchLength]=\"0\" [initialValue]=\"field.vocabField.initialValue\"></ng2-completer>\n              <div class=\"text-danger\" *ngIf=\"field.formModel.controls['text_full_name'].hasError('required')\">{{field.validationMessages.required.text_full_name}}</div>\n            </div>\n            <div class='col-xs-1'>\n              <span class='text-right'>{{ field.emailColHdr }}</span>\n            </div>\n            <div [ngClass]=\"getGroupClass('email')\">\n              <input formControlName=\"email\" type=\"text\" class=\"form-control\" [readOnly]=\"field.forceLookupOnly\"/>\n              <div class=\"text-danger\" *ngIf=\"field.formModel.controls['email'].touched && field.formModel.controls['email'].hasError('email')\">{{field.validationMessages.invalid.email}}</div>\n              <div class=\"text-danger\" *ngIf=\"field.formModel.controls['email'].touched && field.formModel.controls['email'].hasError('required')\">{{field.validationMessages.required.email}}</div>\n            </div>\n            <div class='col-xs-1'>\n              <span class='text-right'>{{ field.orcidColHdr }}</span>\n            </div>\n            <div [ngClass]=\"getGroupClass('orcid')\">\n              <input formControlName=\"orcid\" type=\"text\" class=\"form-control\" />\n            </div>\n          </span>\n        </div>\n      </div>\n      <ng-container *ngIf=\"isEmbedded\">\n        <!-- Lookup Embedded version -->\n        <div class='col-xs-1'>\n          <span class='text-right'>{{ field.nameColHdr }}</span>\n        </div>\n        <div [ngClass]=\"getGroupClass('text_full_name')\">\n          <ng2-completer #ngCompleter [overrideSuggested]=\"!field.forceLookupOnly\" [inputClass]=\"'form-control'\" [placeholder]=\"field.vocabField.placeHolder\" [clearUnselected]=\"field.forceLookupOnly\" (selected)=\"onSelect($event)\" [datasource]=\"field.vocabField.dataService\" [minSearchLength]=\"0\" [initialValue]=\"field.vocabField.initialValue\"></ng2-completer>\n          <div class=\"text-danger\" *ngIf=\"field.formModel.controls['text_full_name'].hasError('required')\">{{field.validationMessages.required.text_full_name}}</div>\n        </div>\n        <div class='col-xs-1'>\n          <span class='text-right'>{{ field.emailColHdr }}</span>\n        </div>\n        <div [ngClass]=\"getGroupClass('email')\">\n          <input formControlName=\"email\" type=\"text\" class=\"form-control\" [readOnly]=\"field.forceLookupOnly\"/>\n          <div class=\"text-danger\" *ngIf=\"field.formModel.controls['email'].touched && field.formModel.controls['email'].hasError('email')\">{{field.validationMessages.invalid.email}}</div>\n          <div class=\"text-danger\" *ngIf=\"field.formModel.controls['email'].touched && field.formModel.controls['email'].hasError('required')\">{{field.validationMessages.required.email}}</div>\n        </div>\n        <div class='col-xs-1'>\n          <span class='text-right'>{{ field.orcidColHdr }}</span>\n        </div>\n        <div [ngClass]=\"getGroupClass('orcid')\">\n          <input formControlName=\"orcid\" type=\"text\" class=\"form-control\" />\n        </div>\n      </ng-container>\n    </ng-container>\n  </div>\n</div>\n<div *ngIf=\"!field.editMode\">\n  <label *ngIf=\"field.label\">{{field.label}}</label>\n  <div class=\"row\" *ngIf=\"field.showHeader\">\n    <div class=\"col-xs-3\"><label>{{field.nameColHdr}}</label></div>\n    <div class=\"col-xs-3\"><label>{{field.emailColHdr}}</label></div>\n    <div class=\"col-xs-3\"><label>{{field.roleColHdr}}</label></div>\n    <div class=\"col-xs-3\"><label>{{field.orcidColHdr}}</label></div>\n  </div>\n  <div class=\"row\">\n    <div class=\"col-xs-3\">{{field.value.text_full_name}}</div>\n    <div class=\"col-xs-3\">{{field.value.email}}</div>\n    <div class=\"col-xs-3\">{{field.value.role}}</div>\n    <div class=\"col-xs-3\">{{field.value.orcid}}</div>\n  </div>\n</div>\n"

/***/ }),

/***/ "./redbox-portal/angular/shared/form/field-contributor.component.ts":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

// Copyright (c) 2017 Queensland Cyber Infrastructure Foundation (http://www.qcif.edu.au/)
//
// GNU GENERAL PUBLIC LICENSE
//    Version 2, June 1991
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation; either version 2 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this program; if not, write to the Free Software Foundation, Inc.,
// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
Object.defineProperty(exports, "__esModule", { value: true });
var core_1 = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
var field_simple_component_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-simple.component.ts");
var field_base_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-base.ts");
var forms_1 = __webpack_require__("./node_modules/@angular/forms/esm5/forms.js");
var _ = __webpack_require__("./node_modules/lodash-es/lodash.js");
var field_vocab_component_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-vocab.component.ts");
/**
 * Contributor Model
 *
 *
 * Author: <a href='https://github.com/shilob' target='_blank'>Shilo Banihit</a>
 *
 */
var ContributorField = /** @class */ (function (_super) {
    __extends(ContributorField, _super);
    function ContributorField(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.fullNameResponseField = "text_full_name";
        _this.clName = 'ContributorField';
        _this.controlType = 'textbox';
        _this.nameColHdr = options['nameColHdr'] ? _this.getTranslated(options['nameColHdr'], options['nameColHdr']) : 'Researcher Name';
        _this.emailColHdr = options['emailColHdr'] ? _this.getTranslated(options['emailColHdr'], options['emailColHdr']) : 'Email Address';
        _this.roleColHdr = options['roleColHdr'] ? _this.getTranslated(options['roleColHdr'], options['roleColHdr']) : 'Project Role';
        _this.orcidColHdr = options['orcidColHdr'] ? _this.getTranslated(options['orcidColHdr'], options['orcidColHdr']) : 'ORCID';
        _this.showHeader = options['showHeader'] || true;
        _this.roles = options['roles'] || [];
        _this.value = options['value'] || _this.setEmptyValue();
        _this.fieldNames = options['fieldNames'] || [];
        var textFullNameFieldName = _.find(_this.fieldNames, function (fieldNameObject) {
            return fieldNameObject['text_full_name'] != undefined;
        });
        if (textFullNameFieldName != null) {
            _this.fullNameResponseField = textFullNameFieldName['text_full_name'];
        }
        _this.validationMessages = options['validationMessages'] || { required: {
                email: _this.getTranslated(options['validation_required_email'], 'Email required'),
                text_full_name: _this.getTranslated(options['validation_required_name'], 'Name is required'),
                role: _this.getTranslated(options['validation_required_role'], 'Select a role')
            },
            invalid: { email: _this.getTranslated(options['validation_invalid_email'], 'Email format is incorrect') } };
        _this.groupFieldNames = ['text_full_name', 'email'];
        _this.freeText = options['freeText'] || false;
        _this.forceLookupOnly = options['forceLookupOnly'] || false;
        if (_this.forceLookupOnly) {
            // override free text as it doesn't make sense
            _this.freeText = false;
        }
        _this.role = options['role'] ? _this.getTranslated(options['role'], options['role']) : null;
        _this.username = options['username'] || '';
        _this.previousEmail = _this.value ? _this.value.email : '';
        _this.validators = {
            text_full_name: [forms_1.Validators.required],
            email: [forms_1.Validators.required, forms_1.Validators.email]
        };
        if (!_this.freeText) {
            _this.vocabField = new field_vocab_component_1.VocabField(_this.options, _this.injector);
            _this.hasLookup = true;
        }
        return _this;
    }
    ContributorField.prototype.setLookupServices = function (completerService, lookupService) {
        if (!this.freeText) {
            this.vocabField.setLookupServices(completerService, lookupService);
        }
    };
    ContributorField.prototype.createFormModel = function (valueElem) {
        if (valueElem === void 0) { valueElem = undefined; }
        if (valueElem) {
            this.value = valueElem;
        }
        if (!this.freeText) {
            this.vocabField.setEmptyValue();
            this.formModel = this.vocabField.createFormModel(this.value, true);
            this.formModel.addControl('username', new forms_1.FormControl(this.value.username));
            this.formModel.addControl('role', new forms_1.FormControl(this.value.role));
            this.formModel.addControl('orcid', new forms_1.FormControl(this.value.orcid));
            if (this.value) {
                this.setValue(this.value);
            }
        }
        else {
            this.formModel = new forms_1.FormGroup({ text_full_name: new forms_1.FormControl(this.value.text_full_name || null),
                email: new forms_1.FormControl(this.value.email || null),
                role: new forms_1.FormControl(this.value.role || null),
                username: new forms_1.FormControl(this.value.username || ''),
                orcid: new forms_1.FormControl(this.value.orcid || '')
            });
        }
        if (this.required) {
            this.enableValidators();
        }
        return this.formModel;
    };
    ContributorField.prototype.setValue = function (value, emitEvent, updateTitle) {
        if (emitEvent === void 0) { emitEvent = true; }
        if (updateTitle === void 0) { updateTitle = false; }
        if (!this.hasInit) {
            this.hasInit = true;
            value.username = _.isUndefined(value.username) ? '' : value.username;
        }
        else {
            if (_.isUndefined(value.username) || (value.email && value.email != this.previousEmail)) {
                value.username = '';
                this.previousEmail = value.email;
            }
        }
        this.formModel.patchValue(value, { emitEvent: emitEvent });
        this.formModel.markAsTouched();
        this.formModel.markAsDirty();
        if (updateTitle) {
            this.component.ngCompleter.ctrInput.nativeElement.value = this.vocabField.getTitle(value);
        }
    };
    ContributorField.prototype.toggleValidator = function (c) {
        var _this = this;
        return function (value) {
            if (value || _.find(_this.formModel.controls, function (c) { return c.value; })) {
                _this.enableValidators();
            }
            else {
                _this.disableValidators();
            }
        };
    };
    ContributorField.prototype.enableValidators = function () {
        var _this = this;
        if (this.enabledValidators) {
            return;
        }
        this.enabledValidators = true;
        _.forEach(this.groupFieldNames, function (f) {
            _this.formModel.controls[f].setValidators(_this.validators[f]);
        });
    };
    ContributorField.prototype.disableValidators = function () {
        if (!this.enabledValidators) {
            return;
        }
        this.enabledValidators = false;
        _.forEach(this.formModel.controls, function (c) {
            c.setValidators(null);
            c.setErrors(null);
        });
    };
    ContributorField.prototype.postInit = function (value) {
        if (value) {
            this.value = value;
            if (!this.freeText) {
                this.vocabField.value = value;
                this.vocabField.initialValue = _.cloneDeep(value);
                this.vocabField.initialValue.title = this.vocabField.getTitle(value);
                this.vocabField.initLookupData();
            }
        }
        else {
            this.setEmptyValue();
        }
    };
    ContributorField.prototype.setEmptyValue = function (emitEvent) {
        if (emitEvent === void 0) { emitEvent = true; }
        this.value = { text_full_name: null, email: null, role: null, username: '' };
        if (this.formModel) {
            _.forOwn(this.formModel.controls, function (c, cName) {
                c.setValue(null, { emitEvent: emitEvent });
            });
        }
        return this.value;
    };
    Object.defineProperty(ContributorField.prototype, "isValid", {
        get: function () {
            var _this = this;
            var validity = false;
            _.forEach(this.groupFieldNames, function (f) {
                validity = validity && _this.formModel.controls[f].valid;
            });
            return validity;
        },
        enumerable: true,
        configurable: true
    });
    ContributorField.prototype.triggerValidation = function () {
        var _this = this;
        _.forEach(this.groupFieldNames, function (f) {
            _this.formModel.controls[f].updateValueAndValidity({ onlySelf: true, emitEvent: false });
            _this.formModel.controls[f].markAsTouched();
        });
    };
    ContributorField.prototype.getValidationError = function () {
        var _this = this;
        var errObj = null;
        if (this.formModel) {
            _.forEach(this.groupFieldNames, function (f) {
                if (!_.isEmpty(_this.formModel.controls[f].errors)) {
                    errObj = _this.formModel.controls[f].errors;
                }
            });
        }
        return errObj;
    };
    ContributorField.prototype.reactEvent = function (eventName, eventData, origData) {
        this.setValue(eventData, false);
        _.each(this.componentReactors, function (compReact) {
            compReact.reactEvent(eventName, eventData, origData);
        });
    };
    return ContributorField;
}(field_base_1.FieldBase));
exports.ContributorField = ContributorField;
var ContributorComponent = /** @class */ (function (_super) {
    __extends(ContributorComponent, _super);
    function ContributorComponent() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.isEmbedded = false;
        return _this;
    }
    ContributorComponent.prototype.ngOnInit = function () {
        this.field.componentReactors.push(this);
        this.field.component = this;
    };
    ContributorComponent.prototype.getGroupClass = function (fldName) {
        var hasError = false;
        hasError = hasError || (this.field.formModel.controls[fldName].hasError('required'));
        if (!hasError && fldName == 'email') {
            hasError = hasError || (this.field.formModel.controls[fldName].hasError('email'));
        }
        return "col-xs-3 form-group" + (hasError ? ' has-error' : '');
    };
    ContributorComponent.prototype.onSelect = function (selected, emitEvent, updateTitle) {
        if (emitEvent === void 0) { emitEvent = true; }
        if (updateTitle === void 0) { updateTitle = false; }
        if (selected) {
            if ((_.isUndefined(selected.title) && _.isUndefined(selected.text_full_name) && _.isEmpty(selected.title) && _.isEmpty(selected.text_full_name))
                || (selected.title && selected.title == this.field.formModel.value.text_full_name)) {
                console.log("Same or empty selection, returning...");
                return;
            }
            var val = void 0;
            if (selected.text_full_name) {
                val = this.field.vocabField.getValue(selected);
            }
            else if (selected[this.field.fullNameResponseField]) {
                val = this.field.vocabField.getValue(selected);
            }
            else {
                val = { text_full_name: selected.title };
            }
            val.role = this.field.role;
            console.log("Using val:");
            console.log(JSON.stringify(val));
            this.field.setValue(val, emitEvent, updateTitle);
        }
        else {
            console.log("No selected user.");
            if (this.field.forceLookupOnly) {
                console.log("Forced lookup, clearing data..");
                this.field.setEmptyValue(emitEvent);
            }
        }
    };
    ContributorComponent.prototype.reactEvent = function (eventName, eventData, origData, elem) {
        console.log("Contributor component reacting:");
        console.log(eventData);
        this.onSelect(eventData, false, true);
    };
    __decorate([
        core_1.Input(),
        __metadata("design:type", Boolean)
    ], ContributorComponent.prototype, "isEmbedded", void 0);
    __decorate([
        core_1.ViewChild('ngCompleter'),
        __metadata("design:type", core_1.ElementRef)
    ], ContributorComponent.prototype, "ngCompleter", void 0);
    ContributorComponent = __decorate([
        core_1.Component({
            selector: 'rb-contributor',
            template: __webpack_require__("./redbox-portal/angular/shared/form/field-contributor.component.html"),
        })
    ], ContributorComponent);
    return ContributorComponent;
}(field_simple_component_1.SimpleComponent));
exports.ContributorComponent = ContributorComponent;


/***/ }),

/***/ "./redbox-portal/angular/shared/form/field-control-meta.service.ts":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};
Object.defineProperty(exports, "__esModule", { value: true });
var core_1 = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
var Observable_1 = __webpack_require__("./node_modules/rxjs/_esm5/Observable.js");
var _ = __webpack_require__("./node_modules/lodash-es/lodash.js");
var fieldClasses_1 = __webpack_require__("./redbox-portal/angular/shared/fieldClasses.ts");
var config_service_1 = __webpack_require__("./redbox-portal/angular/shared/config-service.ts");
var field_vocab_component_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-vocab.component.ts");
var ng2_completer_1 = __webpack_require__("./node_modules/ng2-completer/index.js");
var translation_service_1 = __webpack_require__("./redbox-portal/angular/shared/translation-service.ts");
var util_service_1 = __webpack_require__("./redbox-portal/angular/shared/util-service.ts");
var base_service_1 = __webpack_require__("./redbox-portal/angular/shared/base-service.ts");
var http_1 = __webpack_require__("./node_modules/@angular/http/esm5/http.js");
var FieldControlMetaService = /** @class */ (function (_super) {
    __extends(FieldControlMetaService, _super);
    function FieldControlMetaService(http, vocabFieldLookupService, completerService, configService, translationService, utilityService, app) {
        var _this = _super.call(this, http, configService) || this;
        _this.vocabFieldLookupService = vocabFieldLookupService;
        _this.completerService = completerService;
        _this.configService = configService;
        _this.translationService = translationService;
        _this.utilityService = utilityService;
        _this.app = app;
        _this.classes = fieldClasses_1.fieldClasses;
        return _this;
    }
    FieldControlMetaService.prototype.getFieldsMeta = function (fieldsArr) {
        var _this = this;
        var fields = _.map(fieldsArr, function (f) {
            console.log(f.class);
            if (typeof _this.classes[f.class] != 'undefined') {
                console.log(f.class + ' is null');
            }
            var inst = new _this.classes[f.class].meta(f.definition, _this.app['_injector']);
            inst.utilityService = _this.getInjectedService('utilityService');
            // set the component class
            if (_.isArray(_this.classes[f.class].comp)) {
                inst.compClass = _.find(_this.classes[f.class].comp, function (c) {
                    console.log("Checking if " + c.clName + " == " + f.compClass);
                    return c.clName == f.compClass;
                });
                // defaults to the first entry when compClass is undefined
                if (_.isUndefined(inst.compClass)) {
                    inst.compClass = _this.classes[f.class].comp[0];
                }
            }
            else {
                inst.compClass = _this.classes[f.class].comp;
            }
            if (f.definition && f.definition.fields) {
                inst.fields = _this.getFieldsMeta(f.definition.fields);
            }
            return inst;
        });
        return fields;
    };
    FieldControlMetaService.prototype.flattenFields = function (fields, fieldArr) {
        var _this = this;
        _.map(fields, function (f) {
            fieldArr.push(f);
            if (f.fields) {
                _this.flattenFields(f.fields, fieldArr);
            }
        });
    };
    FieldControlMetaService.prototype.getLookupData = function (fields) {
        var _this = this;
        var fieldArray = [];
        this.flattenFields(fields, fieldArray);
        return Observable_1.Observable.from(fieldArray).flatMap(function (f) {
            if (f.hasLookup) {
                var lookupServiceName = _this.classes[f.clName].lookupService;
                var serviceInst = _this.getInjectedService(lookupServiceName);
                f.setLookupServices(_this.getInjectedService('completerService'), serviceInst);
                // f.completerService = this.completerService;
                // f.lookupService = this[lookupServiceName];
                return serviceInst.getLookupData(f);
            }
            else {
                return Observable_1.Observable.of(null);
            }
        })
            .flatMap(function (field) {
            return Observable_1.Observable.of(field);
        })
            .last()
            .flatMap(function (whatever) {
            return Observable_1.Observable.of(fields);
        });
    };
    FieldControlMetaService.prototype.getInjectedService = function (serviceName) {
        var serviceInst = null;
        switch (serviceName) {
            case 'vocabFieldLookupService':
                serviceInst = this.vocabFieldLookupService;
                break;
            case 'completerService':
                serviceInst = this.completerService;
                break;
            case 'configService':
                serviceInst = this.configService;
                break;
            case 'translationService':
                serviceInst = this.translationService;
                break;
            case 'utilityService':
                serviceInst = this.utilityService;
                break;
        }
        return serviceInst;
    };
    FieldControlMetaService = __decorate([
        core_1.Injectable(),
        __param(0, core_1.Inject(http_1.Http)),
        __param(1, core_1.Inject(field_vocab_component_1.VocabFieldLookupService)),
        __param(2, core_1.Inject(ng2_completer_1.CompleterService)),
        __param(3, core_1.Inject(config_service_1.ConfigService)),
        __param(4, core_1.Inject(translation_service_1.TranslationService)),
        __param(5, core_1.Inject(util_service_1.UtilityService)),
        __metadata("design:paramtypes", [http_1.Http,
            field_vocab_component_1.VocabFieldLookupService,
            ng2_completer_1.CompleterService,
            config_service_1.ConfigService,
            translation_service_1.TranslationService,
            util_service_1.UtilityService,
            core_1.ApplicationRef])
    ], FieldControlMetaService);
    return FieldControlMetaService;
}(base_service_1.BaseService));
exports.FieldControlMetaService = FieldControlMetaService;


/***/ }),

/***/ "./redbox-portal/angular/shared/form/field-control.service.ts":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};
Object.defineProperty(exports, "__esModule", { value: true });
// Copyright (c) 2017 Queensland Cyber Infrastructure Foundation (http://www.qcif.edu.au/)
//
// GNU GENERAL PUBLIC LICENSE
//    Version 2, June 1991
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation; either version 2 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this program; if not, write to the Free Software Foundation, Inc.,
// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
var core_1 = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
var forms_1 = __webpack_require__("./node_modules/@angular/forms/esm5/forms.js");
var _ = __webpack_require__("./node_modules/lodash-es/lodash.js");
__webpack_require__("./node_modules/rxjs/_esm5/add/observable/of.js");
__webpack_require__("./node_modules/rxjs/_esm5/add/operator/mergeMap.js");
__webpack_require__("./node_modules/rxjs/_esm5/add/operator/last.js");
__webpack_require__("./node_modules/rxjs/_esm5/add/observable/from.js");
var ng2_completer_1 = __webpack_require__("./node_modules/ng2-completer/index.js");
var config_service_1 = __webpack_require__("./redbox-portal/angular/shared/config-service.ts");
var translation_service_1 = __webpack_require__("./redbox-portal/angular/shared/translation-service.ts");
var util_service_1 = __webpack_require__("./redbox-portal/angular/shared/util-service.ts");
var field_control_meta_service_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-control-meta.service.ts");
var fieldClasses_1 = __webpack_require__("./redbox-portal/angular/shared/fieldClasses.ts");
/**
 * Field / Model Factory Service...
 *
 * Author: <a href='https://github.com/shilob' target='_blank'>Shilo Banihit</a>
 *
 */
var FieldControlService = /** @class */ (function () {
    function FieldControlService(completerService, configService, translationService, utilityService, fcmetaService, app) {
        this.completerService = completerService;
        this.configService = configService;
        this.translationService = translationService;
        this.utilityService = utilityService;
        this.fcmetaService = fcmetaService;
        this.app = app;
        this.classes = fieldClasses_1.fieldClasses;
    }
    FieldControlService.prototype.addComponentClasses = function (componentClasses) {
        this.classes = _.merge(this.classes, componentClasses);
    };
    FieldControlService.prototype.getEmptyFormGroup = function () {
        return new forms_1.FormGroup({});
    };
    FieldControlService.prototype.toFormGroup = function (fields, fieldMap) {
        if (fieldMap === void 0) { fieldMap = null; }
        var group = {};
        this.populateFormGroup(fields, group, fieldMap);
        this.setupEventHandlers(fieldMap);
        return new forms_1.FormGroup(group);
    };
    FieldControlService.prototype.setupEventHandlers = function (fieldMap) {
        _.forOwn(fieldMap, function (fMap) {
            if (fMap.field) {
                fMap.field.setupEventHandlers();
            }
        });
    };
    FieldControlService.prototype.populateFormGroup = function (fields, group, fieldMap) {
        var _this = this;
        fields.forEach(function (field) {
            if (field.fields && !field.hasGroup) {
                _this.populateFormGroup(field.fields, group, fieldMap);
            }
            else {
                field.getGroup(group, fieldMap);
            }
        });
        return group;
    };
    FieldControlService.prototype.getFieldsMeta = function (fieldsArr) {
        var fields = this.fcmetaService.getFieldsMeta(fieldsArr);
        return fields;
    };
    FieldControlService.prototype.getLookupData = function (fields) {
        return this.fcmetaService.getLookupData(fields);
    };
    FieldControlService = __decorate([
        core_1.Injectable(),
        __param(0, core_1.Inject(ng2_completer_1.CompleterService)),
        __param(1, core_1.Inject(config_service_1.ConfigService)),
        __param(2, core_1.Inject(translation_service_1.TranslationService)),
        __param(3, core_1.Inject(util_service_1.UtilityService)),
        __param(4, core_1.Inject(field_control_meta_service_1.FieldControlMetaService)),
        __metadata("design:paramtypes", [ng2_completer_1.CompleterService,
            config_service_1.ConfigService,
            translation_service_1.TranslationService,
            util_service_1.UtilityService,
            field_control_meta_service_1.FieldControlMetaService,
            core_1.ApplicationRef])
    ], FieldControlService);
    return FieldControlService;
}());
exports.FieldControlService = FieldControlService;


/***/ }),

/***/ "./redbox-portal/angular/shared/form/field-data-location.html":
/***/ (function(module, exports) {

module.exports = "<!-- Basic Uppy styles -->\n<link rel=\"stylesheet\" href=\"/node_modules/uppy/dist/uppy.min.css\">\n<div class='padding-bottom-10'>\n  <label [attr.for]=\"field.name\">\n    {{field.label}} {{ getRequiredLabelStr()}}\n    <button type=\"button\" class=\"btn btn-default\" *ngIf=\"field.help\" (click)=\"toggleHelp()\"><span class=\"glyphicon glyphicon-question-sign\" aria-hidden=\"true\"></span></button>\n  </label><br/>\n  <div>\n    <div class=\"table-responsive\">\n    <table class=\"table table-bordered table-striped table-hover\">\n      <thead>\n        <tr>\n          <th width=\"15%\">Type of location</th>\n          <th width=\"40%\">Location</th>\n          <th width=\"40%\">Notes</th>\n          <th width=\"5%\" *ngIf=\"field.editMode\"></th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr *ngFor=\"let dataLocation of getDatalocations()\">\n          <td>{{ field.dataTypeLookup[dataLocation.type] }}</td>\n          <td>\n            <ng-container *ngIf=\"dataLocation && dataLocation.type != 'attachment'\">\n            {{ dataLocation.location }}\n            </ng-container>\n            <ng-container *ngIf=\"dataLocation.type == 'attachment'\">\n              <ng-container *ngIf=\"dataLocation.pending\">\n                {{ dataLocation.name }}\n              </ng-container>\n              <a *ngIf=\"!dataLocation.pending\" href=\"{{ getAbsUrl(dataLocation.location) }}\" target=\"_blank\">\n                {{ dataLocation.name }}\n              </a>\n            </ng-container>\n          </td>\n          <td>{{ dataLocation.notes }}</td>\n          <td *ngIf=\"field.editMode\">\n            <a class=\"fa fa-minus-circle btn text-20 btn-danger\" (click)=\"field.removeLocation(dataLocation)\"></a>\n          </td>\n        </tr>\n      </tbody>\n    </table>\n  </div>\n  <div class=\"row\" *ngIf=\"field.editMode\">\n    <div class=\"col-xs-3\">\n      <label>Type of location</label>\n    </div>\n    <div class=\"col-xs-4\">\n      <label>Location</label>\n    </div>\n    <div class=\"col-xs-5\">\n      <label *ngIf=\"field.newLocation.type != 'attachment'\">Notes</label>\n    </div>\n\n  </div>\n  <div class=\"row\" *ngIf=\"field.editMode\">\n\n    <div class=\"col-xs-3\">\n      <select [(ngModel)]=\"field.newLocation.type\" [id]=\"field.newLocation.type\" class=\"form-control\">\n         <option *ngFor=\"let opt of field.dataTypes\" [value]=\"opt.value\">{{opt.label}}</option>\n      </select>\n    </div>\n\n    <div class=\"col-xs-4\">\n      <input [(ngModel)]=\"field.newLocation.location\" *ngIf=\"field.newLocation.type != 'attachment'\" type=\"text\" class=\"form-control\" />\n      <a [class.disabled]=\"isAttachmentsDisabled()\"\n      class=\"btn btn-info UppyModalOpenerBtn\"\n      [style.display]=\"field.newLocation.type == 'attachment' ? 'inherit' : 'none'\" (click)=\"openModal()\">Add attachment(s)</a>\n    </div>\n    <div class=\"col-xs-4\">\n      <input [(ngModel)]=\"field.newLocation.notes\"  *ngIf=\"field.newLocation.type != 'attachment'\" type=\"text\" class=\"form-control\" />\n    </div>\n    <div class=\"col-xs-1\">\n      <a  *ngIf=\"field.newLocation.type != 'attachment'\" class=\"fa fa-plus-circle btn text-20 pull-right btn-success\" (click)=\"field.addLocation()\"></a>\n    </div>\n  </div>\n</div>\n</div>\n"

/***/ }),

/***/ "./redbox-portal/angular/shared/form/field-datalocation.component.ts":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
Object.defineProperty(exports, "__esModule", { value: true });
// Copyright (c) 2017 Queensland Cyber Infrastructure Foundation (http://www.qcif.edu.au/)
//
// GNU GENERAL PUBLIC LICENSE
//    Version 2, June 1991
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation; either version 2 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this program; if not, write to the Free Software Foundation, Inc.,
// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
var core_1 = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
var field_simple_component_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-simple.component.ts");
var field_base_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-base.ts");
var _ = __webpack_require__("./node_modules/lodash-es/lodash.js");
var records_service_1 = __webpack_require__("./redbox-portal/angular/shared/form/records.service.ts");
var Uppy = __webpack_require__("./node_modules/uppy/lib/index.js");
/**
 * Contributor Model
 *
 *
 * @author <a target='_' href='https://github.com/shilob'>Shilo Banihit</a>
 *
 */
var DataLocationField = /** @class */ (function (_super) {
    __extends(DataLocationField, _super);
    function DataLocationField(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.newLocation = { type: "url", location: "", notes: "" };
        _this.dataTypes = [{
                'label': 'URL',
                'value': 'url',
            },
            {
                'label': 'Physical location',
                'value': 'physical',
            },
            {
                'label': 'File path',
                'value': 'file',
            },
            {
                'label': 'Attachment',
                'value': 'attachment'
            }
        ];
        _this.dataTypeLookup = {
            'url': "URL",
            'physical': "Physical location",
            'attachment': "Attachment",
            'file': "File path"
        };
        _this.accessDeniedObjects = [];
        _this.columns = options['columns'] || [];
        _this.value = options['value'] || _this.setEmptyValue();
        _this.recordsService = _this.getFromInjector(records_service_1.RecordsService);
        return _this;
    }
    DataLocationField.prototype.setValue = function (value, emitEvent) {
        if (emitEvent === void 0) { emitEvent = true; }
        this.formModel.setValue(value, { emitEvent: emitEvent, emitModelToViewChange: true });
        this.formModel.markAsTouched();
        this.formModel.markAsDirty();
    };
    DataLocationField.prototype.setEmptyValue = function () {
        this.value = [];
        return this.value;
    };
    DataLocationField.prototype.addLocation = function () {
        this.value.push(this.newLocation);
        this.setValue(this.value);
        this.newLocation = { type: "url", location: "", notes: "" };
    };
    DataLocationField.prototype.appendLocation = function (newLoc) {
        this.value.push(newLoc);
        this.setValue(this.value, true);
    };
    DataLocationField.prototype.clearPendingAtt = function (value) {
        _.each(value, function (val) {
            if (val.type == 'attachment') {
                _.unset(val, 'pending');
            }
        });
    };
    DataLocationField.prototype.removeLocation = function (loc) {
        _.remove(this.value, function (val) {
            return val.type == loc.type && val.name == loc.name && val.location == loc.location;
        });
        this.setValue(this.value);
    };
    return DataLocationField;
}(field_base_1.FieldBase));
exports.DataLocationField = DataLocationField;
/**
* Component to display information from related objects within ReDBox
*
*
*
*
*/
var DataLocationComponent = /** @class */ (function (_super) {
    __extends(DataLocationComponent, _super);
    function DataLocationComponent() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.uppy = null;
        _this.oid = null;
        return _this;
    }
    DataLocationComponent.prototype.ngOnInit = function () {
        var oid = this.field.fieldMap._rootComp.oid;
        if (_.isNull(oid) || _.isUndefined(oid) || _.isEmpty(oid)) {
            // wait for the OID to be set when record is created
            if (!this.field.fieldMap._rootComp.getSubscription('recordCreated')) {
                console.log("Subscribing to record creation..... " + this.field.name);
                this.field.fieldMap._rootComp.subscribe('recordCreated', this.field.name, this.eventRecordCreate.bind(this));
                this.initUppy(oid);
            }
        }
        this.initUppy(oid);
    };
    DataLocationComponent.prototype.getDatalocations = function () {
        return this.field.value;
    };
    DataLocationComponent.prototype.eventRecordCreate = function (createdInfo) {
        console.log("Created record triggered: ");
        console.log(createdInfo);
        this.field.fieldMap[this.field.name].instance.initUppy(createdInfo.oid);
    };
    DataLocationComponent.prototype.tempClearPending = function () {
        // temporarily clearing pending values
        var fieldVal = _.cloneDeep(this.field.fieldMap._rootComp.form.value[this.field.name]);
        this.field.clearPendingAtt(fieldVal);
        this.field.fieldMap._rootComp.form.controls[this.field.name].setValue(fieldVal, { emitEvent: true });
    };
    DataLocationComponent.prototype.applyPendingChanges = function (savedInfo) {
        if (savedInfo.success) {
            // this.field.value = this.field.fieldMap._rootComp.form.value[this.field.name];
            var finalVal = this.field.fieldMap._rootComp.form.controls[this.field.name].value;
            this.field.fieldMap[this.field.name].field.value = finalVal;
        }
        else {
            // reverse the value
            console.log("Resetting....");
            this.field.fieldMap._rootComp.form.controls[this.field.name].setValue(this.field.fieldMap[this.field.name].field.value);
        }
    };
    DataLocationComponent.prototype.initUppy = function (oid) {
        var _this = this;
        this.field.fieldMap[this.field.name].instance.oid = oid;
        if (this.uppy) {
            console.log("Uppy already created... setting oid to: " + oid);
            this.field.fieldMap[this.field.name].instance.uppy.getPlugin('Tus').opts.endpoint = this.field.recordsService.getBrandingAndPortalUrl + "/record/" + oid + "/attach";
            return;
        }
        var uppyConfig = {
            debug: true,
            autoProceed: false
        };
        console.debug("Using Uppy config:");
        console.debug(JSON.stringify(uppyConfig));
        var appConfig = this.field.recordsService.getConfig();
        var tusConfig = {
            endpoint: this.field.recordsService.getBrandingAndPortalUrl + "/record/" + oid + "/attach"
        };
        console.debug("Using TUS config:::");
        console.debug(JSON.stringify(tusConfig));
        this.uppy = Uppy.Core(uppyConfig);
        this.uppy.use(Uppy.Dashboard, {
            // trigger: '.UppyModalOpenerBtn',
            inline: false,
            metaFields: [
                { id: 'notes', name: 'Notes', placeholder: 'Notes about this file.' }
            ]
        })
            .use(Uppy.Tus, tusConfig)
            .run();
        console.log(this.uppy);
        var fieldVal = null;
        // attach event handers...
        this.uppy.on('upload-success', function (file, resp, uploadURL) {
            console.debug("File info:");
            console.debug(file);
            console.debug("Response:");
            console.debug(resp);
            console.debug("Upload URL:" + uploadURL);
            // add to form control on each upload...
            var urlParts = uploadURL.split('/');
            var fileId = urlParts[urlParts.length - 1];
            var choppedUrl = urlParts.slice(6, urlParts.length).join('/');
            var newLoc = { type: "attachment", pending: true, location: choppedUrl, notes: file.meta.notes, mimeType: file.type, name: file.meta.name, fileId: fileId, uploadUrl: uploadURL };
            console.debug("Adding new location:");
            console.debug(newLoc);
            _this.field.appendLocation(newLoc);
        });
        // clearing all pending attachments...
        this.field.fieldMap._rootComp.subscribe('onBeforeSave', this.field.name, function (savedInfo) {
            console.log("Before saving record triggered.. ");
            _this.field.fieldMap[_this.field.name].instance.tempClearPending();
        });
        // attach event handling for saving the record
        this.field.fieldMap._rootComp.subscribe('recordSaved', this.field.name, function (savedInfo) {
            console.log("Saved record triggered.. ");
            _this.field.fieldMap[_this.field.name].instance.applyPendingChanges(savedInfo);
        });
    };
    DataLocationComponent.prototype.isAttachmentsDisabled = function () {
        return _.isEmpty(this.oid);
    };
    DataLocationComponent.prototype.getAbsUrl = function (location) {
        return this.field.recordsService.getBrandingAndPortalUrl + "/record/" + location;
    };
    DataLocationComponent.prototype.openModal = function () {
        this.uppy && this.uppy.getPlugin('Dashboard') && this.uppy.getPlugin('Dashboard').openModal();
    };
    DataLocationComponent = __decorate([
        core_1.Component({
            selector: 'data-location-selector',
            template: __webpack_require__("./redbox-portal/angular/shared/form/field-data-location.html")
        })
    ], DataLocationComponent);
    return DataLocationComponent;
}(field_simple_component_1.SimpleComponent));
exports.DataLocationComponent = DataLocationComponent;


/***/ }),

/***/ "./redbox-portal/angular/shared/form/field-group.component.ts":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
Object.defineProperty(exports, "__esModule", { value: true });
// Copyright (c) 2018 Queensland Cyber Infrastructure Foundation (http://www.qcif.edu.au/)
//
// GNU GENERAL PUBLIC LICENSE
//    Version 2, June 1991
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation; either version 2 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this program; if not, write to the Free Software Foundation, Inc.,
// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
var core_1 = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
var field_repeatable_component_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-repeatable.component.ts");
/**
#### Generic Group Component

Generic component for grouping components together. The resulting JSON will have the field names as keys.

```
{
   class: 'Container',
   compClass: 'GenericGroupComponent',
   definition: {
     name: "related_website",
     cssClasses: "form-inline",
     fields: [
       {
         class: 'TextField',
         editOnly: true,
         definition: {
           name: 'related_url',
           label: '@dmpt-related-website-url',
           type: 'text',
           required: true,
           groupName: 'related_website',
           groupClasses: 'width-30',
           cssClasses : "width-80 form-control"
         }
       },
       {
         class: 'TextField',
         editOnly: true,
         definition: {
           name: 'related_title',
           label: '@dmpt-related-website-title',
           type: 'text',
           required: true,
           groupName: 'related_website',
           groupClasses: 'width-30',
           cssClasses : "width-80 form-control"
         }
       },
       {
         class: 'TextField',
         editOnly: true,
         definition: {
           name: 'related_notes',
           label: '@dmpt-related-website-notes',
           type: 'text',
           required: true,
           groupName: 'related_website',
           groupClasses: 'width-30',
           cssClasses : "width-80 form-control"
         }
       }
     ]
   }
 }
```
 * @author <a target='_' href='https://github.com/shilob'>Shilo Banihit</a>
 */
var GenericGroupComponent = /** @class */ (function (_super) {
    __extends(GenericGroupComponent, _super);
    function GenericGroupComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    GenericGroupComponent.clName = 'GenericGroupComponent';
    GenericGroupComponent = __decorate([
        core_1.Component({
            selector: 'generic-group-field',
            template: "\n  <ng-container *ngIf=\"field.editMode\">\n    <div *ngIf=\"field.label\">\n      <label>\n        {{field.label}} {{getRequiredLabelStr()}}\n        <button type=\"button\" class=\"btn btn-default\" *ngIf=\"field.help\" (click)=\"toggleHelp()\"><span class=\"glyphicon glyphicon-question-sign\" aria-hidden=\"true\"></span></button>\n      </label>\n      <span id=\"{{ 'helpBlock_' + field.name }}\" class=\"help-block\" *ngIf=\"this.helpShow\" >{{field.help}}</span>\n    </div>\n    <ng-container *ngIf=\"isEmbedded\">\n      <div [formGroup]='form' [ngClass]=\"field.cssClasses\">\n        <div class='row'>\n          <div class=\"col-xs-11\">\n            <dmp-field *ngFor=\"let childField of field.fields\" [name]=\"name\" [index]=\"index\" [field]=\"childField\" [form]=\"form\" [fieldMap]=\"fieldMap\"></dmp-field>\n          </div>\n          <div class=\"col-xs-1\">\n            <button type='button' *ngIf=\"removeBtnText\" [disabled]=\"!canRemove\" (click)=\"onRemove($event)\" [ngClass]=\"removeBtnClass\" >{{removeBtnText}}</button>\n            <button [disabled]=\"!canRemove\" type='button' [ngClass]=\"removeBtnClass\" (click)=\"onRemove($event)\"></button>\n          </div>\n        </div>\n      </div>\n    </ng-container>\n    <ng-container *ngIf=\"!isEmbedded\">\n      <div [formGroup]='form' [ngClass]=\"field.cssClasses\">\n        <dmp-field *ngFor=\"let field of field.fields\" [field]=\"field\" [form]=\"form\" [fieldMap]=\"fieldMap\"></dmp-field>\n      </div>\n    </ng-container>\n  </ng-container>\n  <ng-container *ngIf=\"!field.editMode\">\n    <div [formGroup]='form' [ngClass]=\"field.cssClasses\">\n      <dmp-field *ngFor=\"let fieldElem of field.fields\" [field]=\"fieldElem\" [form]=\"form\" [fieldMap]=\"fieldMap\"></dmp-field>\n    </div>\n  </ng-container>\n  ",
        })
    ], GenericGroupComponent);
    return GenericGroupComponent;
}(field_repeatable_component_1.EmbeddableComponent));
exports.GenericGroupComponent = GenericGroupComponent;
/**
 * ### Repeatable Generic Component
 *
 *
 * ```
 * {
   class: 'RepeatableContainer',
   compClass: 'RepeatableGroupComponent',
   definition: {
     name: "related_websites",
     label: "@dmpt-related-website",
     help: "@dmpt-related-website-help",
     forceClone: ['fields', 'fieldMap'],
     fields: [
       {
         class: 'Container',
         compClass: 'GenericGroupComponent',
         definition: {
           name: "related_website",
           cssClasses: "form-inline",
           fields: [
             {
               class: 'TextField',
               editOnly: true,
               definition: {
                 name: 'related_url',
                 label: '@dmpt-related-website-url',
                 type: 'text',
                 required: true,
                 groupName: 'related_website',
                 groupClasses: 'width-30',
                 cssClasses : "width-80 form-control"
               }
             },
             {
               class: 'TextField',
               editOnly: true,
               definition: {
                 name: 'related_title',
                 label: '@dmpt-related-website-title',
                 type: 'text',
                 required: true,
                 groupName: 'related_website',
                 groupClasses: 'width-30',
                 cssClasses : "width-80 form-control"
               }
             },
             {
               class: 'TextField',
               editOnly: true,
               definition: {
                 name: 'related_notes',
                 label: '@dmpt-related-website-notes',
                 type: 'text',
                 required: true,
                 groupName: 'related_website',
                 groupClasses: 'width-30',
                 cssClasses : "width-80 form-control"
               }
             }
           ]
         }
       }
     ]
   }
 }
 ```
 * @author <a target='_' href='https://github.com/shilob'>Shilo Banihit</a>
 */
var RepeatableGroupComponent = /** @class */ (function (_super) {
    __extends(RepeatableGroupComponent, _super);
    function RepeatableGroupComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    RepeatableGroupComponent.clName = 'RepeatableGroupComponent';
    RepeatableGroupComponent = __decorate([
        core_1.Component({
            selector: 'repeatable-group',
            template: "\n  <div *ngIf=\"field.editMode\">\n    <div *ngIf=\"field.label\">\n      <label>\n        {{field.label}} {{getRequiredLabelStr()}}\n        <button type=\"button\" class=\"btn btn-default\" *ngIf=\"field.help\" (click)=\"toggleHelp()\"><span class=\"glyphicon glyphicon-question-sign\" aria-hidden=\"true\"></span></button>\n      </label>\n      <span id=\"{{ 'helpBlock_' + field.name }}\" class=\"help-block\" *ngIf=\"this.helpShow\" >{{field.help}}</span>\n    </div>\n    <ng-container *ngFor=\"let fieldElem of field.fields; let i = index;\" >\n      <div class=\"row\">\n        <span class=\"col-xs-12\">\n          <generic-group-field [name]=\"field.name\" [field]=\"fieldElem\" [form]=\"form\" [fieldMap]=\"fieldMap\" [isEmbedded]=\"true\" [removeBtnText]=\"field.removeButtonText\" [removeBtnClass]=\"field.removeButtonClass\" [canRemove]=\"field.fields.length > 1\" (onRemoveBtnClick)=\"removeElem($event[0], $event[1])\" [index]=\"i\"></generic-group-field>\n        </span>\n      </div>\n      <div class=\"row\">\n        <span class=\"col-xs-12\">&nbsp;</span>\n      </div>\n    </ng-container>\n    <div class=\"row\">\n      <span class=\"col-xs-11\">&nbsp;\n      </span>\n      <span class=\"col-xs-1\">\n        <button *ngIf=\"field.addButtonText\" type='button' (click)=\"addElem($event)\" [ngClass]=\"field.addButtonTextClass\" >{{field.addButtonText}}</button>\n        <button *ngIf=\"!field.addButtonText\" type='button' (click)=\"addElem($event)\" [ngClass]=\"field.addButtonClass\"></button>\n      </span>\n    </div>\n  </div>\n  <li *ngIf=\"!field.editMode\" class=\"key-value-pair\">\n    <span *ngIf=\"field.label\" class=\"key\">{{field.label}}</span>\n    <span class=\"value\">\n      <ul class=\"key-value-list\">\n        <generic-group-field *ngFor=\"let fieldElem of field.fields; let i = index;\" [name]=\"field.name\" [index]=\"i\" [field]=\"fieldElem\" [form]=\"form\" [fieldMap]=\"fieldMap\"></generic-group-field>\n      </ul>\n    </span>\n  </li>\n  ",
        })
    ], RepeatableGroupComponent);
    return RepeatableGroupComponent;
}(field_repeatable_component_1.RepeatableComponent));
exports.RepeatableGroupComponent = RepeatableGroupComponent;


/***/ }),

/***/ "./redbox-portal/angular/shared/form/field-map.component.ts":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
Object.defineProperty(exports, "__esModule", { value: true });
// Copyright (c) 2017 Queensland Cyber Infrastructure Foundation (http://www.qcif.edu.au/)
//
// GNU GENERAL PUBLIC LICENSE
//    Version 2, June 1991
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation; either version 2 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this program; if not, write to the Free Software Foundation, Inc.,
// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
var core_1 = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
var field_simple_component_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-simple.component.ts");
var field_base_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-base.ts");
var forms_1 = __webpack_require__("./node_modules/@angular/forms/esm5/forms.js");
var _ = __webpack_require__("./node_modules/lodash-es/lodash.js");
/**
 * Map Model
 *
 *
 * @author <a target='_' href='https://github.com/andrewbrazzatti'>Andrew Brazzatti</a>
 *
 */
var MapField = /** @class */ (function (_super) {
    __extends(MapField, _super);
    function MapField(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.initialised = false;
        _this.importDataString = "";
        _this.layerGeoJSON = {};
        _this.importFailed = false;
        _this.layers = [];
        _this.drawnItems = new L.FeatureGroup();
        _this.googleMaps = L.tileLayer('http://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}', {
            maxZoom: 20,
            subdomains: ['mt0', 'mt1', 'mt2', 'mt3'],
            detectRetina: true
        });
        _this.googleHybrid = L.tileLayer('http://{s}.google.com/vt/lyrs=s,h&x={x}&y={y}&z={z}', {
            maxZoom: 20,
            subdomains: ['mt0', 'mt1', 'mt2', 'mt3'],
            detectRetina: true
        });
        /*
        *
        * Draw options
        */
        /* Draw options that we do not want to be overridden by form config as it'll break functionality */
        _this.masterDrawOptions = {
            edit: {
                featureGroup: _this.drawnItems
            },
        };
        _this.defaultDrawOptions = {
            position: 'topright',
            edit: {
                featureGroup: _this.drawnItems
            },
            draw: {
                marker: {
                    icon: L.icon({
                        iconSize: [25, 41],
                        iconAnchor: [13, 41],
                        iconUrl: 'http://localhost:1500/default/rdmp/images/leaflet/marker-icon.png',
                        shadowUrl: 'http://localhost:1500/default/rdmp/images/leaflet/marker-shadow.png'
                    })
                },
                circlemarker: false,
                circle: false
            }
        };
        _this.drawOptions = _this.defaultDrawOptions;
        /*
        *
        * Leaf options
        */
        _this.masterLeafletOptions = {
            layers: [_this.googleMaps, _this.drawnItems],
        };
        _this.defaultLeafletOptions = {
            zoom: 4,
            center: L.latLng([-24.673148, 134.074574])
        };
        _this.leafletOptions = _this.defaultLeafletOptions;
        _this.layersControl = {
            baseLayers: {
                'Google Maps': _this.googleMaps,
                'Google Hybrid': _this.googleHybrid
            }
        };
        _this.clName = 'MapField';
        _this.leafletOptions = options['leafletOptions'] || _this.defaultLeafletOptions;
        // merge in master options to ensure we have the right layers configured
        _this.leafletOptions = _.merge(_this.leafletOptions, _this.masterLeafletOptions);
        _this.drawOptions = options['drawOptions'] || _this.drawOptions;
        // merge in master options to ensure we have the right layers configured
        _this.drawOptions = _.merge(_this.drawOptions, _this.masterDrawOptions);
        _this.tabId = options['tabId'] || null;
        _this.layerGeoJSON = options.value;
        return _this;
    }
    MapField.prototype.onMapReady = function (map) {
        var _this = this;
        this.map = map;
        var that = this;
        this.registerMapEventHandlers(map);
        this.setValue(this.layerGeoJSON);
        if (this.tabId === null) {
            map.invalidateSize();
            map.fitBounds(this.drawnItems.getBounds());
        }
        else {
            if (this.editMode) {
                // TODO: need a better way to select the tab component
                this.fieldMap._rootComp.fields[0]["onTabChange"].subscribe(function (tabName) {
                    if (tabName == _this.tabId) {
                        map.invalidateSize();
                        if (!that.initialised) {
                            try {
                                // if there are no layers present this will throw an error
                                map.fitBounds(_this.drawnItems.getBounds());
                            }
                            catch (e) {
                            }
                            that.initialised = true;
                        }
                    }
                });
            }
            else {
                setTimeout(5000, function () { map.invalidateSize(); });
            }
        }
    };
    MapField.prototype.registerMapEventHandlers = function (map) {
        var that = this;
        map.on(L.Draw.Event.CREATED, function (e) {
            var type = e.layerType, layer = e.layer;
            that.layers.push(layer);
            that.layerGeoJSON = L.featureGroup(that.layers).toGeoJSON();
            return false;
        });
        map.on('draw:edited', function (e) {
            var layers = e.layers;
            var that2 = that;
            layers.eachLayer(function (layer) {
                var layerIndex = _.findIndex(that2.layers, function (o) { return o._leaflet_id == layer._leaflet_id; });
                if (layerIndex == -1) {
                    that2.layers.push(layer);
                }
                else {
                    that2.layers[layerIndex] = layer;
                }
            });
        });
        map.on('draw:editstop', function (e) {
            that.layerGeoJSON = L.featureGroup(that.layers).toGeoJSON();
            that.setValue(that.layerGeoJSON);
        });
        map.on('draw:deletestop', function (e) {
            that.layerGeoJSON = L.featureGroup(that.layers).toGeoJSON();
            that.setValue(that.layerGeoJSON);
        });
        map.on('draw:deleted', function (e) {
            var layers = e.layers;
            var that2 = that;
            layers.eachLayer(function (layer) {
                _.remove(that2.layers, function (o) { return o._leaflet_id == layer._leaflet_id; });
            });
        });
    };
    MapField.prototype.drawLayers = function () {
        this.drawnItems.clearLayers();
        var geoJSONLayer = L.geoJSON(this.layerGeoJSON);
        this.layers = [];
        var that = this;
        geoJSONLayer.eachLayer(function (layer) {
            layer.addTo(that.drawnItems);
            that.layers.push(layer);
        });
    };
    MapField.prototype.postInit = function (value) {
        if (!_.isEmpty(value)) {
            this.layerGeoJSON = value;
            this.drawLayers();
        }
    };
    MapField.prototype.createFormModel = function (valueElem) {
        if (valueElem === void 0) { valueElem = undefined; }
        if (valueElem) {
            this.layerGeoJSON = valueElem;
        }
        this.formModel = new forms_1.FormControl(this.layerGeoJSON || {});
        return this.formModel;
    };
    MapField.prototype.setValue = function (value) {
        if (!_.isEmpty(value)) {
            this.layerGeoJSON = value;
            this.drawLayers();
            this.formModel.patchValue(this.layerGeoJSON, { emitEvent: false });
            this.formModel.markAsTouched();
        }
    };
    MapField.prototype.setEmptyValue = function () {
        this.layerGeoJSON = {};
        return this.layerGeoJSON;
    };
    MapField.prototype.importData = function () {
        var _this = this;
        if (this.importDataString.length > 0) {
            try {
                if (this.importDataString.indexOf("<") == 0) {
                    //probably KML
                    var parsedLayers = omnivore.kml.parse(this.importDataString);
                    if (parsedLayers.getLayers().length == 0) {
                        this.importFailed = true;
                        return false;
                    }
                    var that_1 = this;
                    parsedLayers.eachLayer(function (layer) {
                        layer.addTo(that_1.drawnItems);
                        that_1.layers.push(layer);
                        that_1.layerGeoJSON = L.featureGroup(that_1.layers).toGeoJSON();
                        _this.drawLayers();
                        that_1.map.fitBounds(that_1.drawnItems.getBounds());
                    });
                    this.importDataString = "";
                    this.importFailed = false;
                }
                else {
                    var parsedLayers = L.geoJSON(JSON.parse(this.importDataString));
                    var that_2 = this;
                    parsedLayers.eachLayer(function (layer) {
                        layer.addTo(that_2.drawnItems);
                        that_2.layers.push(layer);
                        that_2.layerGeoJSON = L.featureGroup(that_2.layers).toGeoJSON();
                        _this.drawLayers();
                        that_2.map.fitBounds(that_2.drawnItems.getBounds());
                    });
                    this.importDataString = "";
                    this.importFailed = false;
                }
            }
            catch (e) {
                this.importFailed = true;
            }
        }
        return false;
    };
    return MapField;
}(field_base_1.FieldBase));
exports.MapField = MapField;
// Setting the template url to a constant rather than directly in the component as the latter breaks document generation
var rbMapDataTemplate = './field-map.html';
if (typeof aotMode == 'undefined') {
    rbMapDataTemplate = '../angular/shared/form/field-map.html';
}
/**
* #### Map Component.
*
* Uses Leaflet.js to render a widget and the Leaflet.draw plugin to be able to select regions
*
* #### Usage
* ```
*  {
*   class: 'MapField',
*   compClass: 'MapComponent',
*   definition: {
*     name: 'geocoords',
*     label: '@dataRecord-coverage',
*     help: '@dataRecord-coverage',
*     tabId: 'coverage',
*     leafletOptions: {
*                      zoom: 3,
*                      center: latLng([108.94248962402342, 34.26516142452615)
*                     }
*     }
*   }
* ```
*
*| Property Name  | Description                                                                                                                                                                                                                                                                                                                       | Required | Default                                                                                                                                                                                                                                                                                  |
*|----------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
*| label          | The label to show above the component                                                                                                                                                                                                                                                                                             | No       *|                                                                                                                                                                                                                                                                                          |
*| help           | Help text                                                                                                                                                                                                                                                                                                                         | No       *|                                                                                                                                                                                                                                                                                          |
*| tabId          | The name of the tab the widget is placed, this is needed as Leaflet needs the map to be visible before the tiles can be loaded correctly. Leave empty if widget isn't placed in a tab.                                                                                                                                            | No       *|                                                                                                                                                                                                                                                                                          |
*| leafletOptions | The leaflet options object. See the [Leaflet's documentation](http://leafletjs.com/reference-1.3.0.html#map-option) for more information. Note: layers cannot be changed as other functionality depends on it being set as it is and will be overridden. Defaults to a map centred on Australia (if no elements are drawn on map) | No       | ```{zoom: 4, center:" latLng([-24.673148, 134.074574]) }```                                                                                                                                                                                                                              |
*| drawOptions    | The leaflet draw options object. See the [Leaflet Draw's documentation](https://leaflet.github.io/Leaflet.draw/docs/leaflet-draw-latest.html#options) for more information. Note: the edit featureGroup cannot be changed as other functionality depends on it being set as it is and will be overridden.                         | No       | ```{position:"topright",draw:{marker:{icon:icon({iconSize:[25,41],iconAnchor:[13,41],iconUrl:"http://localhost:1500/default/rdmp/images/leaflet/marker-icon.png",shadowUrl:"http://localhost:1500/default/rdmp/images/leaflet/marker-shadow.png"})},circlemarker:false,circle:false}}``` |
*/
var MapComponent = /** @class */ (function (_super) {
    __extends(MapComponent, _super);
    function MapComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    MapComponent = __decorate([
        core_1.Component({
            selector: 'rb-mapdata',
            template: __webpack_require__("./redbox-portal/angular/shared/form/field-map.html")
        })
    ], MapComponent);
    return MapComponent;
}(field_simple_component_1.SimpleComponent));
exports.MapComponent = MapComponent;


/***/ }),

/***/ "./redbox-portal/angular/shared/form/field-map.html":
/***/ (function(module, exports) {

module.exports = "<div class='padding-bottom-10'>\n  <div *ngIf=\"field.editMode\" [formGroup]='form' class=\"form-group\">\n  <label [attr.for]=\"field.name\">\n    {{field.label}} {{ getRequiredLabelStr()}}\n    <button type=\"button\" class=\"btn btn-default\" *ngIf=\"field.help\" (click)=\"toggleHelp()\"><span class=\"glyphicon glyphicon-question-sign\" aria-hidden=\"true\"></span></button>\n  </label><br/>\n  <span id=\"{{ 'helpBlock_' + field.name }}\" class=\"help-block\" *ngIf=\"this.helpShow\" [innerHtml]=\"field.help\"></span>\n\n  <div leaflet style=\"height: 450px;\"\n       leafletDraw\n       [leafletOptions]=\"field.leafletOptions\"\n       [leafletDrawOptions]=\"field.drawOptions\"\n       (leafletMapReady)=\"field.onMapReady($event)\"\n       [leafletLayersControl]=\"field.layersControl\">\n  </div>\n  <div class='padding-top-10'>\n  <div><label>Enter KML or GeoJSON</label><br/><textarea class=\"form-control\" rows=\"5\" [(ngModel)]=\"field.importDataString\" [ngModelOptions]=\"{standalone: true}\"></textarea></div>\n  <div class=\"padding-top-10\"><a class=\"btn btn-info\" (click)=\"field.importData()\">Import</a> <span *ngIf=\"field.importFailed\" class=\"text-danger\">Entered text is not a valid KML or GeoJSON</span></div>\n</div>\n</div>\n</div>\n<div *ngIf=\"!field.editMode\">\n  <div leaflet style=\"height: 450px;\"\n       [leafletOptions]=\"field.leafletOptions\"\n       (leafletMapReady)=\"field.onMapReady($event)\"\n       [leafletLayersControl]=\"field.layersControl\">\n  </div>\n</div>\n"

/***/ }),

/***/ "./redbox-portal/angular/shared/form/field-publishdatalocationselector.component.ts":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
Object.defineProperty(exports, "__esModule", { value: true });
// Copyright (c) 2017 Queensland Cyber Infrastructure Foundation (http://www.qcif.edu.au/)
//
// GNU GENERAL PUBLIC LICENSE
//    Version 2, June 1991
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation; either version 2 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this program; if not, write to the Free Software Foundation, Inc.,
// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
var core_1 = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
var field_simple_component_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-simple.component.ts");
var field_base_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-base.ts");
var _ = __webpack_require__("./node_modules/lodash-es/lodash.js");
var records_service_1 = __webpack_require__("./redbox-portal/angular/shared/form/records.service.ts");
/**
 * Contributor Model
 *
 *
 * @author <a target='_' href='https://github.com/shilob'>Shilo Banihit</a>
 *
 */
var PublishDataLocationSelectorField = /** @class */ (function (_super) {
    __extends(PublishDataLocationSelectorField, _super);
    function PublishDataLocationSelectorField(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.newLocation = { type: "url", location: "", notes: "" };
        _this.dataTypes = [{
                'label': 'URL',
                'value': 'url',
            },
            {
                'label': 'Physical location',
                'value': 'physical',
            },
            {
                'label': 'File path',
                'value': 'file',
            },
            {
                'label': 'Attachment',
                'value': 'attachment'
            }
        ];
        _this.dataTypeLookup = {
            'url': "URL",
            'physical': "Physical location",
            'attachment': "Attachment",
            'file': "File path"
        };
        _this.accessDeniedObjects = [];
        _this.columns = options['columns'] || [];
        _this.value = options['value'] || _this.setEmptyValue();
        _this.recordsService = _this.getFromInjector(records_service_1.RecordsService);
        return _this;
    }
    PublishDataLocationSelectorField.prototype.setValue = function (value, emitEvent) {
        if (emitEvent === void 0) { emitEvent = true; }
        this.formModel.setValue(value, { emitEvent: emitEvent, emitModelToViewChange: true });
        this.formModel.markAsTouched();
        this.formModel.markAsDirty();
    };
    PublishDataLocationSelectorField.prototype.setEmptyValue = function () {
        this.value = [];
        return this.value;
    };
    PublishDataLocationSelectorField.prototype.addLocation = function () {
        this.value.push(this.newLocation);
        this.setValue(this.value);
        this.newLocation = { type: "url", location: "", notes: "" };
    };
    PublishDataLocationSelectorField.prototype.appendLocation = function (newLoc) {
        this.value.push(newLoc);
        this.setValue(this.value, true);
    };
    PublishDataLocationSelectorField.prototype.clearPendingAtt = function (value) {
        _.each(value, function (val) {
            if (val.type == 'attachment') {
                _.unset(val, 'pending');
            }
        });
    };
    PublishDataLocationSelectorField.prototype.populateDataLocation = function (oid, config) {
        var _this = this;
        console.log(oid);
        this.recordsService.getRecordMeta(oid).then(function (record) {
            _this.value = record.dataLocations;
        });
    };
    PublishDataLocationSelectorField.prototype.removeLocation = function (loc) {
        _.remove(this.value, function (val) {
            return val.type == loc.type && val.name == loc.name && val.location == loc.location;
        });
        this.setValue(this.value);
    };
    return PublishDataLocationSelectorField;
}(field_base_1.FieldBase));
exports.PublishDataLocationSelectorField = PublishDataLocationSelectorField;
/**
* Component to display information from related objects within ReDBox
*
*
*
*
*/
var PublishDataLocationSelectorComponent = /** @class */ (function (_super) {
    __extends(PublishDataLocationSelectorComponent, _super);
    function PublishDataLocationSelectorComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    PublishDataLocationSelectorComponent.prototype.ngOnInit = function () {
    };
    PublishDataLocationSelectorComponent.prototype.locationSelected = function (location) {
        _.each(this.field.value, function (dataLocation) {
            if (dataLocation['location'] == location) {
                if (dataLocation['selected']) {
                    dataLocation['selected'] = false;
                }
                else {
                    dataLocation['selected'] = true;
                }
            }
        });
    };
    PublishDataLocationSelectorComponent.prototype.getDatalocations = function () {
        return this.field.value;
    };
    PublishDataLocationSelectorComponent.prototype.getAbsUrl = function (location) {
        return this.field.recordsService.getBrandingAndPortalUrl + "/record/" + location;
    };
    PublishDataLocationSelectorComponent = __decorate([
        core_1.Component({
            selector: 'publish-data-location-selector',
            template: __webpack_require__("./redbox-portal/angular/shared/form/field-publishdatalocationselector.html")
        })
    ], PublishDataLocationSelectorComponent);
    return PublishDataLocationSelectorComponent;
}(field_simple_component_1.SimpleComponent));
exports.PublishDataLocationSelectorComponent = PublishDataLocationSelectorComponent;


/***/ }),

/***/ "./redbox-portal/angular/shared/form/field-publishdatalocationselector.html":
/***/ (function(module, exports) {

module.exports = "<div class='padding-bottom-10'>\n  <label [attr.for]=\"field.name\">\n    {{field.label}} {{ getRequiredLabelStr()}}\n    <button type=\"button\" class=\"btn btn-default\" *ngIf=\"field.help\" (click)=\"toggleHelp()\"><span class=\"glyphicon glyphicon-question-sign\" aria-hidden=\"true\"></span></button>\n  </label><br/>\n  <div>\n    <div class=\"table-responsive\">\n    <table class=\"table table-bordered table-striped table-hover\">\n      <thead>\n        <tr>\n          <th width=\"5%\"></th><th width=\"15%\">Type of location</th><th width=\"40%\">Location</th><th width=\"40%\">Notes</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr *ngFor=\"let dataLocation of getDatalocations()\">\n          <td><input type=\"checkbox\" (change)=\"locationSelected(dataLocation.location)\"/></td>\n          <td>{{ field.dataTypeLookup[dataLocation.type] }}</td>\n          <td>\n            <ng-container *ngIf=\"dataLocation && dataLocation.type != 'attachment'\">\n            {{ dataLocation.location }}\n            </ng-container>\n            <ng-container *ngIf=\"dataLocation.type == 'attachment'\">\n              <ng-container *ngIf=\"dataLocation.pending\">\n                {{ dataLocation.name }}\n              </ng-container>\n              <a *ngIf=\"!dataLocation.pending\" href=\"{{ getAbsUrl(dataLocation.location) }}\" target=\"_blank\">\n                {{ dataLocation.name }}\n              </a>\n            </ng-container>\n          </td>\n          <td>{{ dataLocation.notes }}</td>\n\n        </tr>\n      </tbody>\n    </table>\n  </div>\n  <!-- <div><button class=\"btn btn-info\">Export</button></div> -->\n</div>\n</div>\n"

/***/ }),

/***/ "./redbox-portal/angular/shared/form/field-relatedobjectdata.component.ts":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
Object.defineProperty(exports, "__esModule", { value: true });
// Copyright (c) 2017 Queensland Cyber Infrastructure Foundation (http://www.qcif.edu.au/)
//
// GNU GENERAL PUBLIC LICENSE
//    Version 2, June 1991
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation; either version 2 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this program; if not, write to the Free Software Foundation, Inc.,
// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
var core_1 = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
var field_simple_component_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-simple.component.ts");
var field_base_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-base.ts");
var forms_1 = __webpack_require__("./node_modules/@angular/forms/esm5/forms.js");
var _ = __webpack_require__("./node_modules/lodash-es/lodash.js");
var records_service_1 = __webpack_require__("./redbox-portal/angular/shared/form/records.service.ts");
/**
 * Contributor Model
 *
 *
 * @author <a target='_' href='https://github.com/shilob'>Shilo Banihit</a>
 *
 */
var RelatedObjectDataField = /** @class */ (function (_super) {
    __extends(RelatedObjectDataField, _super);
    function RelatedObjectDataField(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.relatedObjects = [];
        _this.accessDeniedObjects = [];
        _this.failedObjects = [];
        _this.columns = options['columns'] || [];
        var relatedObjects = _this.relatedObjects;
        _this.value = options['value'] || _this.setEmptyValue();
        _this.recordsService = _this.getFromInjector(records_service_1.RecordsService);
        var that = _this;
        _.forEach(_this.value, function (item) {
            _this.recordsService.getRecordMeta(item.id).then(function (meta) {
                if (!meta) {
                    that.failedObjects.push(meta);
                }
                else if (meta.status == "Access Denied") {
                    that.accessDeniedObjects.push(meta);
                }
                else if (meta.title) {
                    that.relatedObjects.push(meta);
                }
                else {
                    that.failedObjects.push(meta);
                }
            });
        });
        return _this;
    }
    RelatedObjectDataField.prototype.createFormModel = function (valueElem) {
        if (valueElem === void 0) { valueElem = undefined; }
        if (valueElem) {
            this.value = valueElem;
        }
        this.formModel = new forms_1.FormControl(this.value || []);
        if (this.value) {
            this.setValue(this.value);
        }
        return this.formModel;
    };
    RelatedObjectDataField.prototype.setValue = function (value) {
        this.formModel.patchValue(value, { emitEvent: false });
        this.formModel.markAsTouched();
    };
    RelatedObjectDataField.prototype.setEmptyValue = function () {
        this.value = [];
        return this.value;
    };
    return RelatedObjectDataField;
}(field_base_1.FieldBase));
exports.RelatedObjectDataField = RelatedObjectDataField;
// Setting the template url to a constant rather than directly in the component as the latter breaks document generation
var rbRelatedObjectDataTemplate = './field-relatedobjectdata.html';
if (typeof aotMode == 'undefined') {
    rbRelatedObjectDataTemplate = '../angular/shared/form/field-relatedobjectdata.html';
}
/**
* Component to display information from related objects within ReDBox
*
*
*
*
*/
var RelatedObjectDataComponent = /** @class */ (function (_super) {
    __extends(RelatedObjectDataComponent, _super);
    function RelatedObjectDataComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    RelatedObjectDataComponent = __decorate([
        core_1.Component({
            selector: 'rb-relatedobjectdata',
            template: __webpack_require__("./redbox-portal/angular/shared/form/field-relatedobjectdata.html")
        })
    ], RelatedObjectDataComponent);
    return RelatedObjectDataComponent;
}(field_simple_component_1.SimpleComponent));
exports.RelatedObjectDataComponent = RelatedObjectDataComponent;


/***/ }),

/***/ "./redbox-portal/angular/shared/form/field-relatedobjectdata.html":
/***/ (function(module, exports) {

module.exports = "<div class='padding-bottom-10'>\n\n  <div class=\"row\">\n    <table class=\"table\">\n      <thead>\n          <tr>\n              <ng-container *ngFor=\"let header of field.columns\"><th *ngIf='header.show != false'>{{ header.label }}</th></ng-container>\n          </tr>\n      </thead>\n      <tbody>\n        <tr *ngFor=\"let item of field.relatedObjects\">\n          <ng-container *ngFor=\"let column of field.columns\">\n            <td *ngIf='column.show != false'>\n              <span *ngIf='column.link === \"relative\"; then relative'></span>\n              <span *ngIf='column.link === \"absolute\"; then absolute; else noProcessing'></span>\n              <ng-template #multivalue></ng-template>\n              <ng-template #relative><a href=\"/{{ branding }}/{{ portal }}/{{ column.link.pattern}}\">{{ column.link.pattern | stringTemplate:item }}</a></ng-template>\n              <ng-template #absolute><a target=\"_blank\" rel=\"noopener noreferrer\" href=\"{{item[column.property]}}\">{{item[column.property]}}</a></ng-template>\n              <ng-template #noProcessing>{{ item[column.property] }}</ng-template>\n            </td>\n          </ng-container>\n        </tr>\n      </tbody>\n    </table>\n    <p *ngIf=\"field.failedObjects.length > 0\">There were {{ field.failedObjects.length }} records that failed to load</p>\n    <p *ngIf=\"field.accessDeniedObjects.length > 0\">There were {{ field.accessDeniedObjects.length }} records that you do not have access to</p>\n  </div>\n</div>\n"

/***/ }),

/***/ "./redbox-portal/angular/shared/form/field-relatedobjectselector.component.ts":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
Object.defineProperty(exports, "__esModule", { value: true });
// Copyright (c) 2017 Queensland Cyber Infrastructure Foundation (http://www.qcif.edu.au/)
//
// GNU GENERAL PUBLIC LICENSE
//    Version 2, June 1991
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation; either version 2 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this program; if not, write to the Free Software Foundation, Inc.,
// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
var core_1 = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
var field_simple_component_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-simple.component.ts");
var field_base_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-base.ts");
var forms_1 = __webpack_require__("./node_modules/@angular/forms/esm5/forms.js");
var _ = __webpack_require__("./node_modules/lodash-es/lodash.js");
var dashboard_service_1 = __webpack_require__("./redbox-portal/angular/shared/dashboard-service.ts");
/**
 * Contributor Model
 *
 *
 * @author <a target='_' href='https://github.com/shilob'>Shilo Banihit</a>
 *
 */
var RelatedObjectSelectorField = /** @class */ (function (_super) {
    __extends(RelatedObjectSelectorField, _super);
    function RelatedObjectSelectorField(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.relatedObjectSelected = new core_1.EventEmitter();
        _this.clName = 'RelatedObjectDataField';
        _this.columnTitle = options['columnTitle'] || "Record title";
        _this.value = options['value'] || _this.setEmptyValue();
        _this.recordType = options['recordType'];
        _this.dashboardService = _this.getFromInjector(dashboard_service_1.DashboardService);
        var that = _this;
        _this.dashboardService.getAllRecordsCanEdit(_this.recordType, '').then(function (draftPlans) {
            _this.plans = draftPlans;
            _this.onFilterChange();
        });
        return _this;
    }
    RelatedObjectSelectorField.prototype.recordSelected = function (record, event) {
        this.setValue({ oid: record.oid, title: record.title });
        this.relatedObjectSelected.emit(record.oid);
    };
    RelatedObjectSelectorField.prototype.resetSelector = function () {
        this.setEmptyValue();
    };
    RelatedObjectSelectorField.prototype.createFormModel = function (valueElem) {
        if (valueElem === void 0) { valueElem = undefined; }
        if (valueElem) {
            this.value = valueElem;
        }
        this.formModel = new forms_1.FormControl(this.value || []);
        if (this.value) {
            this.setValue(this.value);
        }
        return this.formModel;
    };
    RelatedObjectSelectorField.prototype.setValue = function (value) {
        this.value = value;
        this.formModel.patchValue(value, { emitEvent: false });
        this.formModel.markAsTouched();
    };
    RelatedObjectSelectorField.prototype.setEmptyValue = function () {
        this.value = {};
        return this.value;
    };
    RelatedObjectSelectorField.prototype.onFilterChange = function () {
        var _this = this;
        this.filteredPlans = _.filter(this.plans.items, function (plan) {
            plan.selected = false;
            var title = _.isArray(plan.title) ? plan.title[0] : plan.title;
            return _.toLower(title).includes(_.toLower(_this.searchFilterName));
        });
    };
    RelatedObjectSelectorField.prototype.resetFilter = function () {
        this.searchFilterName = null;
        this.onFilterChange();
    };
    return RelatedObjectSelectorField;
}(field_base_1.FieldBase));
exports.RelatedObjectSelectorField = RelatedObjectSelectorField;
/**
* Component to display information from related objects within ReDBox
*
*
*
*/
var RelatedObjectSelectorComponent = /** @class */ (function (_super) {
    __extends(RelatedObjectSelectorComponent, _super);
    function RelatedObjectSelectorComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    RelatedObjectSelectorComponent = __decorate([
        core_1.Component({
            selector: 'rb-RelatedObjectSelector',
            template: __webpack_require__("./redbox-portal/angular/shared/form/field-relatedobjectselector.html")
        })
    ], RelatedObjectSelectorComponent);
    return RelatedObjectSelectorComponent;
}(field_simple_component_1.SimpleComponent));
exports.RelatedObjectSelectorComponent = RelatedObjectSelectorComponent;


/***/ }),

/***/ "./redbox-portal/angular/shared/form/field-relatedobjectselector.html":
/***/ (function(module, exports) {

module.exports = "<div class='padding-bottom-10'>\n  <label [attr.for]=\"field.name\">\n    {{field.label}} {{ getRequiredLabelStr()}}\n    <button type=\"button\" class=\"btn btn-default\" *ngIf=\"field.help\" (click)=\"toggleHelp()\"><span class=\"glyphicon glyphicon-question-sign\" aria-hidden=\"true\"></span></button>\n  </label><br/>\n  <div *ngIf=\"field.value.oid\">\n     {{ field.value.title }} <button class=\"btn btn-info\" (click)=\"field.resetSelector()\">Change</button>\n  </div>\n  <div *ngIf=\"!field.value.oid\">\n    <div class=\"input-group\">\n      <span class=\"input-group-addon\" id=\"name-addon\">Filter by name</span>\n      <input type=\"text\" (keyup)=\"field.onFilterChange()\" [(ngModel)]=\"field.searchFilterName\" class=\"form-control\" placeholder=\"Name\" aria-describedby=\"name-addon\">\n      <span  (click)=\"field.resetFilter()\" class=\"input-group-btn\"><button class=\"btn btn-primary\" type='button'>{{ 'transfer-ownership-reset' | translate }}</button></span>\n    </div>\n    <div><br/></div>\n    <div class=\"table-responsive\">\n    <table class=\"table table-bordered table-striped table-hover\">\n      <thead>\n        <tr>\n          <th>{{ field.columnTitle }}</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr *ngFor=\"let plan of field.filteredPlans\" (click)=\"field.recordSelected(plan,$event)\">\n          <td>{{ plan.title }}</td>\n        </tr>\n      </tbody>\n    </table>\n  </div>\n</div>\n</div>\n"

/***/ }),

/***/ "./redbox-portal/angular/shared/form/field-repeatable.component.ts":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

// Copyright (c) 2017 Queensland Cyber Infrastructure Foundation (http://www.qcif.edu.au/)
//
// GNU GENERAL PUBLIC LICENSE
//    Version 2, June 1991
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation; either version 2 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this program; if not, write to the Free Software Foundation, Inc.,
// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
Object.defineProperty(exports, "__esModule", { value: true });
var core_1 = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
var field_simple_component_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-simple.component.ts");
var field_simple_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-simple.ts");
var forms_1 = __webpack_require__("./node_modules/@angular/forms/esm5/forms.js");
var _ = __webpack_require__("./node_modules/lodash-es/lodash.js");
/**
 * Repeatable Field Container
 *
 * Author: <a href='https://github.com/shilob' target='_blank'>Shilo Banihit</a>
 *
 */
var RepeatableContainer = /** @class */ (function (_super) {
    __extends(RepeatableContainer, _super);
    function RepeatableContainer(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.hasGroup = true;
        _this.addButtonText = options['addButtonText'] || '';
        _this.removeButtonText = options['removeButtonText'] || null;
        _this.skipClone = options['skipClone'] || [];
        _this.forceClone = options['forceClone'] || [];
        _this.addButtonTextClass = options['addButtonTextClass'] || 'btn btn-success pull-right';
        _this.addButtonClass = options['addButtonClass'] || 'fa fa-plus-circle btn text-20 pull-right btn-success';
        _this.removeButtonTextClass = options['removeButtonTextClass'] || 'btn btn-danger pull-right';
        _this.removeButtonClass = options['removeButtonClass'] || 'fa fa-minus-circle btn text-20 pull-right btn-danger';
        return _this;
    }
    RepeatableContainer.prototype.getInitArrayEntry = function () {
        if (this.fields[0].isGroup) {
            var grp = {};
            var fm = {};
            var fg = this.fields[0].getGroup(grp, fm);
            return [fg];
        }
        return [this.fields[0].createFormModel()];
    };
    RepeatableContainer.prototype.getGroup = function (group, fieldMap) {
        var _this = this;
        this.fieldMap = fieldMap;
        fieldMap[this.name] = { field: this };
        if (!this.value || this.value.length == 0) {
            this.formModel = this.required ? new forms_1.FormArray(this.getInitArrayEntry(), forms_1.Validators.required) : new forms_1.FormArray(this.getInitArrayEntry());
        }
        else {
            var fieldCtr_1 = 0;
            var baseField_1 = this.fields[0];
            var elems_1 = [];
            this.fields = _.map(this.value, function (valueElem) {
                var fieldClone = null;
                if (fieldCtr_1 == 0) {
                    fieldClone = baseField_1;
                    fieldClone.value = _.isArray(valueElem) ? valueElem[fieldCtr_1] : valueElem;
                }
                else {
                    fieldClone = _this.createNewElem(baseField_1, _.isArray(valueElem) ? valueElem[fieldCtr_1] : valueElem);
                    fieldClone.value = _.isArray(valueElem) ? valueElem[fieldCtr_1] : valueElem;
                }
                fieldCtr_1++;
                elems_1.push(fieldClone.createFormModel());
                return fieldClone;
            });
            this.formModel = this.required ? new forms_1.FormArray(elems_1, forms_1.Validators.required) : new forms_1.FormArray(elems_1);
            _.each(this.fields, function (f) {
                f.setupEventHandlers();
            });
        }
        fieldMap[this.name].control = this.formModel;
        if (this.groupName) {
            if (group[this.groupName]) {
                group[this.groupName].addControl(this.name, this.formModel);
            }
            else {
                var fg = {};
                fg[this.name] = this.formModel;
                group[this.groupName] = fg;
            }
        }
        else {
            group[this.name] = this.formModel;
        }
    };
    RepeatableContainer.prototype.createNewElem = function (baseFieldInst, value) {
        var _this = this;
        if (value === void 0) { value = null; }
        var newOpts = _.cloneDeep(baseFieldInst.options);
        newOpts.value = null;
        var newInst = new baseFieldInst.constructor(newOpts, this.injector);
        _.forEach(this.skipClone, function (f) {
            newInst[f] = null;
        });
        _.forEach(this.forceClone, function (f) {
            if (_.isString(f)) {
                newInst[f] = _.cloneDeep(baseFieldInst[f]);
            }
            else {
                newInst[f.field] = _.cloneDeepWith(baseFieldInst[f.field], _this.getCloneCustomizer(f));
            }
        });
        if (_.isFunction(newInst.postInit)) {
            newInst.postInit(value);
        }
        return newInst;
    };
    RepeatableContainer.prototype.getCloneCustomizer = function (cloneOpts) {
        return function (value, key) {
            if (_.find(cloneOpts.skipClone, function (skippedEntry) { return skippedEntry == key; })) {
                return false;
            }
        };
    };
    RepeatableContainer.prototype.addElem = function (val) {
        if (val === void 0) { val = null; }
        var newElem = this.createNewElem(this.fields[0], val);
        if (val == null && _.isFunction(newElem.setEmptyValue)) {
            newElem.setEmptyValue();
        }
        this.fields.push(newElem);
        var newFormModel = newElem.createFormModel();
        this.formModel.push(newFormModel);
        return newElem;
    };
    RepeatableContainer.prototype.removeElem = function (index) {
        _.remove(this.fields, function (val, idx) { return idx == index; });
        this.formModel.removeAt(index);
    };
    RepeatableContainer.prototype.setValueAtElem = function (index, value) {
        this.fields[index].setValue(value, true);
    };
    RepeatableContainer.prototype.triggerValidation = function () {
        _.forEach(this.fields, function (f) {
            f.triggerValidation();
        });
    };
    RepeatableContainer.prototype.reactEvent = function (eventName, eventData, origData) {
        var _this = this;
        console.log("Repeatable container field reacting: " + eventName);
        console.log(eventData);
        // delete first...
        if (this.fields.length > eventData.length) {
            for (var toDelIdx = eventData.length - 1; toDelIdx <= this.fields.length; toDelIdx++) {
                this.removeElem(toDelIdx);
            }
        }
        _.each(eventData, function (entry, idx) {
            if (idx >= _this.formModel.controls.length) {
                _this.addElem(entry);
            }
            else {
                _this.setValueAtElem(idx, entry);
            }
        });
    };
    return RepeatableContainer;
}(field_simple_1.Container));
exports.RepeatableContainer = RepeatableContainer;
var EmbeddableComponent = /** @class */ (function (_super) {
    __extends(EmbeddableComponent, _super);
    function EmbeddableComponent() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.canRemove = false;
        _this.removeBtnText = null;
        _this.removeBtnClass = 'btn fa fa-minus-circle btn text-20 pull-left btn btn-danger';
        _this.onRemoveBtnClick = new core_1.EventEmitter();
        return _this;
    }
    EmbeddableComponent.prototype.onRemove = function (event) {
        this.onRemoveBtnClick.emit([event, this.index]);
    };
    EmbeddableComponent.prototype.getGroupClass = function (fldName) {
        if (fldName === void 0) { fldName = null; }
        var baseClass = 'form-group';
        if (this.isEmbedded) {
            baseClass = '';
        }
        return baseClass + " " + (this.hasRequiredError() ? 'has-error' : '') + " " + this.field.groupClasses;
    };
    __decorate([
        core_1.Input(),
        __metadata("design:type", Boolean)
    ], EmbeddableComponent.prototype, "canRemove", void 0);
    __decorate([
        core_1.Input(),
        __metadata("design:type", String)
    ], EmbeddableComponent.prototype, "removeBtnText", void 0);
    __decorate([
        core_1.Input(),
        __metadata("design:type", String)
    ], EmbeddableComponent.prototype, "removeBtnClass", void 0);
    __decorate([
        core_1.Input(),
        __metadata("design:type", Number)
    ], EmbeddableComponent.prototype, "index", void 0);
    __decorate([
        core_1.Output(),
        __metadata("design:type", core_1.EventEmitter)
    ], EmbeddableComponent.prototype, "onRemoveBtnClick", void 0);
    return EmbeddableComponent;
}(field_simple_component_1.SimpleComponent));
exports.EmbeddableComponent = EmbeddableComponent;
var RepeatableComponent = /** @class */ (function (_super) {
    __extends(RepeatableComponent, _super);
    function RepeatableComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    RepeatableComponent.prototype.addElem = function (event) {
        this.field.addElem();
    };
    RepeatableComponent.prototype.removeElem = function (event, i) {
        this.field.removeElem(i);
    };
    return RepeatableComponent;
}(field_simple_component_1.SimpleComponent));
exports.RepeatableComponent = RepeatableComponent;
var RepeatableVocab = /** @class */ (function (_super) {
    __extends(RepeatableVocab, _super);
    function RepeatableVocab(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.clName = 'RepeatableVocab';
        return _this;
    }
    RepeatableVocab.prototype.setValueAtElem = function (index, value) {
        console.log("Repeatable vocab setting value at: " + index);
        console.log(value);
        this.fields[index].component.onSelect(value, false, true);
    };
    return RepeatableVocab;
}(RepeatableContainer));
exports.RepeatableVocab = RepeatableVocab;
var RepeatableVocabComponent = /** @class */ (function (_super) {
    __extends(RepeatableVocabComponent, _super);
    function RepeatableVocabComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    RepeatableVocabComponent.clName = 'RepeatableVocabComponent';
    RepeatableVocabComponent = __decorate([
        core_1.Component({
            selector: 'repeatable-vocab',
            template: "\n  <div *ngIf=\"field.editMode\">\n    <div class=\"row\">\n      <div class=\"col-xs-12\">\n      <label>{{field.label}}\n        <button type=\"button\" class=\"btn btn-default\" *ngIf=\"field.help\" (click)=\"toggleHelp()\"><span class=\"glyphicon glyphicon-question-sign\" aria-hidden=\"true\"></span></button>\n      </label>\n      <span id=\"{{ 'helpBlock_' + field.name }}\" class=\"help-block\" *ngIf=\"this.helpShow\" [innerHtml]=\"field.help\"></span>\n      </div>\n    </div>\n    <div *ngFor=\"let fieldElem of field.fields; let i = index;\" class=\"row\">\n      <span class=\"col-xs-12\">\n        <rb-vocab [field]=\"fieldElem\" [form]=\"form\" [fieldMap]=\"fieldMap\" [isEmbedded]=\"true\" [removeBtnText]=\"field.removeButtonText\" [removeBtnClass]=\"field.removeButtonClass\" [canRemove]=\"field.fields.length > 1\" (onRemoveBtnClick)=\"removeElem($event[0], $event[1])\" [index]=\"i\"></rb-vocab>\n      </span>\n    </div>\n    <div class=\"row\">\n      <span class=\"col-xs-11\">&nbsp;\n      </span>\n      <span class=\"col-xs-1\">\n        <button *ngIf=\"field.addButtonText\" type='button' (click)=\"addElem($event)\" [ngClass]=\"field.addButtonTextClass\" >{{field.addButtonText}}</button>\n        <button *ngIf=\"!field.addButtonText\" type='button' (click)=\"addElem($event)\" [ngClass]=\"field.addButtonClass\"></button>\n      </span>\n    </div>\n  </div>\n  <li *ngIf=\"!field.editMode\" class=\"key-value-pair\">\n    <span *ngIf=\"field.label\" class=\"key\">{{field.label}}</span>\n    <span class=\"value\">\n      <ul class=\"key-value-list\">\n        <rb-vocab *ngFor=\"let fieldElem of field.fields; let i = index;\" [field]=\"fieldElem\" [form]=\"form\" [fieldMap]=\"fieldMap\"></rb-vocab>\n      </ul>\n    </span>\n  </li>\n  ",
        })
    ], RepeatableVocabComponent);
    return RepeatableVocabComponent;
}(RepeatableComponent));
exports.RepeatableVocabComponent = RepeatableVocabComponent;
var RepeatableContributor = /** @class */ (function (_super) {
    __extends(RepeatableContributor, _super);
    function RepeatableContributor() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    RepeatableContributor.prototype.setValueAtElem = function (index, value) {
        this.fields[index].component.onSelect(value, false, true);
    };
    return RepeatableContributor;
}(RepeatableContainer));
exports.RepeatableContributor = RepeatableContributor;
var RepeatableContributorComponent = /** @class */ (function (_super) {
    __extends(RepeatableContributorComponent, _super);
    function RepeatableContributorComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    RepeatableContributorComponent.prototype.ngOnInit = function () {
        this.field.fields[0].marginTop = '25px';
        this.field.fields[0].componentReactors.push(this);
    };
    RepeatableContributorComponent.prototype.addElem = function (event) {
        var newElem = this.field.addElem();
        newElem.marginTop = '0px';
        newElem.vocabField.initialValue = null;
        newElem.setupEventHandlers();
        newElem.componentReactors.push(this);
    };
    RepeatableContributorComponent.prototype.removeElem = function (event, i) {
        this.field.removeElem(i);
        if (i == 0) {
            this.field.fields[0].marginTop = '25px';
            this.field.fields[0]["showHeader"] = true;
        }
    };
    RepeatableContributorComponent.prototype.reactEvent = function (eventName, eventData, origData, elem) {
        if (this.field.fields.length > 0) {
            elem.marginTop = '0px';
            elem.vocabField.initialValue = eventData;
            elem.setupEventHandlers();
            elem.componentReactors.push(this);
        }
    };
    RepeatableContributorComponent = __decorate([
        core_1.Component({
            selector: 'repeatable-contributor',
            template: "\n  <div *ngIf=\"field.editMode\">\n    <div *ngFor=\"let fieldElem of field.fields; let i = index;\" class=\"row\">\n      <span class=\"col-xs-10\">\n        <rb-contributor [field]=\"fieldElem\" [form]=\"form\" [fieldMap]=\"fieldMap\" [isEmbedded]=\"true\"></rb-contributor>\n      </span>\n      <span class=\"col-xs-2\">\n        <button type='button' *ngIf=\"field.fields.length > 1 && field.removeButtonText\" (click)=\"removeElem($event, i)\"  [ngClass]=\"field.removeButtonTextClass\" [ngStyle]=\"{'margin-top': fieldElem.marginTop}\" >{{field.removeButtonText}}</button>\n        <button type='button' *ngIf=\"field.fields.length > 1 && !field.removeButtonText\" (click)=\"removeElem($event, i)\" [ngClass]=\"field.removeButtonClass\" [ngStyle]=\"{'margin-top': fieldElem.marginTop}\" ></button>\n      </span>\n    </div>\n    <div class=\"row\">\n      <span class=\"col-xs-12\">\n        <button *ngIf=\"field.addButtonText\" type='button' (click)=\"addElem($event)\" [ngClass]=\"field.addButtonTextClass\" >{{field.addButtonText}}</button>\n        <button *ngIf=\"!field.addButtonText\" type='button' (click)=\"addElem($event)\" [ngClass]=\"field.addButtonClass\" ></button>\n      </span>\n    </div>\n  </div>\n  <ng-container  *ngIf=\"!field.editMode\">\n    <div class=\"row\">\n      <div class=\"col-xs-3\"><label>{{field.fields[0].nameColHdr}}</label></div>\n      <div class=\"col-xs-3\"><label>{{field.fields[0].emailColHdr}}</label></div>\n      <div class=\"col-xs-3\"><label>{{field.fields[0].roleColHdr}}</label></div>\n      <div class=\"col-xs-3\"><label>{{field.fields[0].orcidColHdr}}</label></div>\n    </div>\n    <div class=\"row\" *ngFor=\"let fieldElem of field.fields; let i = index;\">\n      <div class=\"col-xs-3\">{{fieldElem.value.text_full_name}}</div>\n      <div class=\"col-xs-3\">{{fieldElem.value.email}}</div>\n      <div class=\"col-xs-3\">{{fieldElem.value.role}}</div>\n      <div class=\"col-xs-3\">{{fieldElem.value.orcid}}</div>\n    </div>\n  </ng-container>\n  ",
        })
    ], RepeatableContributorComponent);
    return RepeatableContributorComponent;
}(RepeatableComponent));
exports.RepeatableContributorComponent = RepeatableContributorComponent;


/***/ }),

/***/ "./redbox-portal/angular/shared/form/field-simple.component.ts":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

// Copyright (c) 2017 Queensland Cyber Infrastructure Foundation (http://www.qcif.edu.au/)
//
// GNU GENERAL PUBLIC LICENSE
//    Version 2, June 1991
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation; either version 2 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this program; if not, write to the Free Software Foundation, Inc.,
// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
Object.defineProperty(exports, "__esModule", { value: true });
var core_1 = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
var field_base_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-base.ts");
var forms_1 = __webpack_require__("./node_modules/@angular/forms/esm5/forms.js");
var _ = __webpack_require__("./node_modules/lodash-es/lodash.js");
/**
 * A component base class
 *
 * Author: <a href='https://github.com/shilob' target='_blank'>Shilo Banihit</a>
 */
var SimpleComponent = /** @class */ (function () {
    function SimpleComponent() {
        this.isEmbedded = false;
    }
    /**
     * Return the NG2 FormControl or subclass thereof
     * @param  {string = null} name
     * @return {FormControl}
     */
    SimpleComponent.prototype.getFormControl = function (name, ctrlIndex) {
        if (name === void 0) { name = null; }
        if (ctrlIndex === void 0) { ctrlIndex = null; }
        var fc = null;
        if (_.isEmpty(name)) {
            name = this.name;
        }
        if (_.isEmpty(name)) {
            name = this.field.name;
        }
        if (this.fieldMap && this.field) {
            // console.log(name);
            fc = this.field.getControl(name, this.fieldMap);
        }
        if (!_.isNull(ctrlIndex) && !_.isUndefined(ctrlIndex)) {
            if (!_.isNull(fc.controls) && !_.isUndefined(fc.controls)) {
                fc = fc.controls[ctrlIndex];
            }
        }
        else if (this.index != null) {
            fc = fc.controls[this.index];
        }
        if (name != this.field.name && !_.isEmpty(this.field.name) && !_.isUndefined(fc.controls)) {
            fc = fc.controls[this.field.name];
        }
        return fc;
    };
    /**
     * Returns the CSS class
     * @param  {string=null} fldName
     * @return {string}
     */
    SimpleComponent.prototype.getGroupClass = function (fldName) {
        if (fldName === void 0) { fldName = null; }
        return this.field.groupClasses + " form-group " + (this.hasRequiredError() ? 'has-error' : '');
    };
    /**
     * If this field has a 'required' error.
     * Author: <a href='https://github.com/shilob' target='_blank'>Shilo Banihit</a>
     * @return {[type]}
     */
    SimpleComponent.prototype.hasRequiredError = function () {
        return (this.field.formModel ? this.field.formModel.touched && this.field.formModel.hasError('required') : false);
    };
    /**
     * Convenience method to toggle help mode.
     * @return {[type]}
     */
    SimpleComponent.prototype.toggleHelp = function () {
        this.helpShow = !this.helpShow;
    };
    /**
     * Returns label
     * @return {string}
     */
    SimpleComponent.prototype.getRequiredLabelStr = function () {
        return this.field.required ? '(*)' : '';
    };
    /**
     * Returns the NG2 root injector
     * @param  {any} token
     * @return {any}
     */
    SimpleComponent.prototype.getFromInjector = function (token) {
        return this.injector.get(token);
    };
    __decorate([
        core_1.Input(),
        __metadata("design:type", field_base_1.FieldBase)
    ], SimpleComponent.prototype, "field", void 0);
    __decorate([
        core_1.Input(),
        __metadata("design:type", forms_1.FormGroup)
    ], SimpleComponent.prototype, "form", void 0);
    __decorate([
        core_1.Input(),
        __metadata("design:type", Object)
    ], SimpleComponent.prototype, "fieldMap", void 0);
    __decorate([
        core_1.Input(),
        __metadata("design:type", Object)
    ], SimpleComponent.prototype, "index", void 0);
    __decorate([
        core_1.Input(),
        __metadata("design:type", Object)
    ], SimpleComponent.prototype, "name", void 0);
    __decorate([
        core_1.Input(),
        __metadata("design:type", Boolean)
    ], SimpleComponent.prototype, "isEmbedded", void 0);
    return SimpleComponent;
}());
exports.SimpleComponent = SimpleComponent;
var SelectionComponent = /** @class */ (function (_super) {
    __extends(SelectionComponent, _super);
    function SelectionComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    SelectionComponent.prototype.getLabel = function (val) {
        var opt = _.find(this.field.options, function (opt) {
            return opt.value == val;
        });
        if (opt) {
            return opt.label;
        }
        else {
            return '';
        }
    };
    return SelectionComponent;
}(SimpleComponent));
exports.SelectionComponent = SelectionComponent;
var DropdownFieldComponent = /** @class */ (function (_super) {
    __extends(DropdownFieldComponent, _super);
    function DropdownFieldComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    DropdownFieldComponent.clName = 'DropdownFieldComponent';
    DropdownFieldComponent = __decorate([
        core_1.Component({
            selector: 'dropdownfield',
            template: "\n  <div [formGroup]='form' *ngIf=\"field.editMode\" [ngClass]=\"getGroupClass()\">\n     <label [attr.for]=\"field.name\">\n      {{field.label}} {{ getRequiredLabelStr()}}\n      <button type=\"button\" class=\"btn btn-default\" *ngIf=\"field.help\" (click)=\"toggleHelp()\"><span class=\"glyphicon glyphicon-question-sign\" aria-hidden=\"true\"></span></button>\n     </label><br/>\n     <span id=\"{{ 'helpBlock_' + field.name }}\" class=\"help-block\" *ngIf=\"this.helpShow\" [innerHtml]=\"field.help\"></span>\n     <select [formControl]=\"getFormControl()\"  [id]=\"field.name\" [ngClass]=\"field.cssClasses\">\n        <option *ngFor=\"let opt of field.options\" [value]=\"opt.value\">{{opt.label}}</option>\n     </select>\n     <div class=\"text-danger\" *ngIf=\"getFormControl().hasError('required') && getFormControl().touched && !field.validationMessages?.required\">{{field.label}} is required</div>\n     <div class=\"text-danger\" *ngIf=\"getFormControl().hasError('required') && getFormControl().touched && field.validationMessages?.required\">{{field.validationMessages.required}}</div>\n  </div>\n  <div *ngIf=\"!field.editMode\" class=\"key-value-pair\">\n    <span class=\"key\" *ngIf=\"field.label\">{{field.label}}</span>\n    <span class=\"value\">{{getLabel(field.value)}}</span>\n  </div>\n  ",
        })
    ], DropdownFieldComponent);
    return DropdownFieldComponent;
}(SelectionComponent));
exports.DropdownFieldComponent = DropdownFieldComponent;
var SelectionFieldComponent = /** @class */ (function (_super) {
    __extends(SelectionFieldComponent, _super);
    function SelectionFieldComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    SelectionFieldComponent.prototype.isRadio = function () {
        return this.field.controlType == 'radio';
    };
    SelectionFieldComponent.prototype.getControlFromOption = function (opt) {
        var control = _.find(this.getFormControl()['controls'], function (ctrl) {
            return opt.value == ctrl.value;
        });
        return control;
    };
    SelectionFieldComponent.prototype.onChange = function (opt, event) {
        var formcontrol = this.getFormControl();
        if (event.target.checked) {
            formcontrol.push(new forms_1.FormControl(opt.value));
        }
        else {
            var idx_1 = null;
            _.forEach(formcontrol.controls, function (ctrl, i) {
                if (ctrl.value == opt.value) {
                    idx_1 = i;
                    return false;
                }
            });
            formcontrol.removeAt(idx_1);
        }
    };
    SelectionFieldComponent.clName = 'SelectionFieldComponent';
    SelectionFieldComponent = __decorate([
        core_1.Component({
            selector: 'selectionfield',
            template: "\n  <div [formGroup]='form' *ngIf=\"field.editMode\" class=\"form-group\">\n     <label [attr.for]=\"field.name\">\n      {{field.label}} {{ getRequiredLabelStr()}}\n      <button type=\"button\" class=\"btn btn-default\" *ngIf=\"field.help\" (click)=\"toggleHelp()\"><span class=\"glyphicon glyphicon-question-sign\" aria-hidden=\"true\"></span></button>\n     </label><br/>\n     <span id=\"{{ 'helpBlock_' + field.name }}\" class=\"help-block\" *ngIf=\"this.helpShow\" [innerHtml]=\"field.help\"></span>\n     <span *ngFor=\"let opt of field.options\">\n      <!-- radio type hard-coded otherwise accessor directive will not work! -->\n      <input *ngIf=\"isRadio()\" type=\"radio\" name=\"{{field.name}}\" [id]=\"field.name + '_' + opt.value\" [formControl]=\"getFormControl()\" [value]=\"opt.value\">\n      <input *ngIf=\"!isRadio()\" type=\"{{field.controlType}}\" name=\"{{field.name}}\" [id]=\"field.name + '_' + opt.value\" [value]=\"opt.value\" (change)=\"onChange(opt, $event)\" [attr.selected]=\"getControlFromOption(opt)\" [attr.checked]=\"getControlFromOption(opt)\">\n      <label for=\"{{field.name + '_' + opt.value}}\" class=\"radio-label\">{{ opt.label }}</label>\n      <br/>\n     </span>\n     <div class=\"text-danger\" *ngIf=\"getFormControl().hasError('required') && getFormControl().touched && !field.validationMessages?.required\">{{field.label}} is required</div>\n     <div class=\"text-danger\" *ngIf=\"getFormControl().hasError('required') && getFormControl().touched && field.validationMessages?.required\">{{field.validationMessages.required}}</div>\n  </div>\n  <div *ngIf=\"!field.editMode\" class=\"key-value-pair\">\n    <ng-container *ngIf=\"isRadio()\">\n      <span *ngIf=\"field.label\" class=\"key\">{{field.label}}</span>\n      <span class=\"value\">{{getLabel(field.value)}}</span>\n    </ng-container>\n    <ng-container *ngIf=\"!isRadio()\">\n      <span *ngIf=\"field.label\" class=\"key\">{{field.label}}</span>\n      <span class=\"value\">{{getLabel(value)}}<br/></span>\n    </ng-container>\n  </div>\n  ",
        })
    ], SelectionFieldComponent);
    return SelectionFieldComponent;
}(SelectionComponent));
exports.SelectionFieldComponent = SelectionFieldComponent;
/****************************************************************************
Container components
*****************************************************************************/
var TabOrAccordionContainerComponent = /** @class */ (function (_super) {
    __extends(TabOrAccordionContainerComponent, _super);
    function TabOrAccordionContainerComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TabOrAccordionContainerComponent.prototype.ngAfterViewChecked = function () {
        var that = this;
        jQuery("[role='tab']").on('shown.bs.tab', function () {
            that.field.onTabChange.emit(this.getAttribute("href").substring(1, this.getAttribute("href").length));
        });
    };
    TabOrAccordionContainerComponent = __decorate([
        core_1.Component({
            selector: 'tabcontainer',
            template: "\n  <div *ngIf=\"field.editMode\" class=\"row\" style=\"min-height:300px;\">\n    <div [ngClass]=\"field.cssClasses\">\n      <div [ngClass]=\"field.tabNavContainerClass\">\n        <ul [ngClass]=\"field.tabNavClass\">\n          <li *ngFor=\"let tab of field.fields\" [ngClass]=\"{'active': tab.active}\"><a href=\"#{{tab.id}}\" data-toggle=\"tab\" role=\"tab\">{{tab.label}}</a></li>\n        </ul>\n      </div>\n      <div [ngClass]=\"field.tabContentContainerClass\">\n        <div [ngClass]=\"field.tabContentClass\">\n      <!--\n      Inlined the tab definition instead of creating it's own component otherwise Bootstrap refuses to toggle the panes\n      Likely because of the extra DOM node (component selector) that it doesn't know what to do.\n      TODO: remove inlining, or perhaps consider a 3rd-party NG2 tab component\n      -->\n          <div *ngFor=\"let tab of field.fields\" [ngClass]=\"{'tab-pane': true, 'fade': true, 'active': tab.active==true, 'in': tab.active==true}\" id=\"{{tab.id}}\">\n            <dmp-field *ngFor=\"let field of tab.fields\" [field]=\"field\" [form]=\"form\" class=\"form-row\" [fieldMap]=\"fieldMap\" [parentId]=\"tab.id\"></dmp-field>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n  <div *ngIf=\"!field.editMode\" [ngClass]=\"field.accContainerClass\">\n    <div class=\"panel-group\">\n      <div *ngFor=\"let tab of field.fields\" [ngClass]=\"field.accClass\">\n        <div class=\"panel-heading\">\n          <h4 class=\"panel-title\">\n            <a data-toggle=\"collapse\" href=\"#{{tab.id}}\">{{tab.label}}</a>\n          </h4>\n        </div>\n        <div id=\"{{tab.id}}\" class=\"panel-collapse collapse\">\n          <div class=\"panel-body\">\n            <ul class=\"key-value-list\">\n              <dmp-field *ngFor=\"let field of tab.fields\" [field]=\"field\" [form]=\"form\" class=\"form-row\" [fieldMap]=\"fieldMap\"></dmp-field>\n            </ul>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n  "
        })
    ], TabOrAccordionContainerComponent);
    return TabOrAccordionContainerComponent;
}(SimpleComponent));
exports.TabOrAccordionContainerComponent = TabOrAccordionContainerComponent;
var ButtonBarContainerComponent = /** @class */ (function (_super) {
    __extends(ButtonBarContainerComponent, _super);
    function ButtonBarContainerComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    ButtonBarContainerComponent = __decorate([
        core_1.Component({
            selector: 'buttonbarcontainer',
            template: "\n    <div *ngIf=\"field.editMode\" class=\"form-row\">\n      <div class=\"pull-right col-md-10\">\n      <dmp-field *ngFor=\"let field1 of field.fields\" [field]=\"field1\" [form]=\"form\" class=\"form-row\" [fieldMap]=\"fieldMap\"></dmp-field>\n    </div>\n  "
        })
    ], ButtonBarContainerComponent);
    return ButtonBarContainerComponent;
}(SimpleComponent));
exports.ButtonBarContainerComponent = ButtonBarContainerComponent;
// Break in case of an emergency....
var HtmlRawComponent = /** @class */ (function (_super) {
    __extends(HtmlRawComponent, _super);
    function HtmlRawComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    HtmlRawComponent = __decorate([
        core_1.Component({
            selector: 'htmlraw',
            template: "\n  <ng-content></ng-content>\n  ",
        })
    ], HtmlRawComponent);
    return HtmlRawComponent;
}(SimpleComponent));
exports.HtmlRawComponent = HtmlRawComponent;
// For creating text blocks with help sections?
var TextBlockComponent = /** @class */ (function (_super) {
    __extends(TextBlockComponent, _super);
    function TextBlockComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TextBlockComponent.clName = 'TextBlockComponent';
    TextBlockComponent = __decorate([
        core_1.Component({
            selector: 'text-block',
            template: "\n  <div [ngSwitch]=\"field.type\">\n    <h1 *ngSwitchCase=\"'h1'\" [ngClass]=\"field.cssClasses\">{{field.value}}</h1>\n    <h2 *ngSwitchCase=\"'h2'\" [ngClass]=\"field.cssClasses\">{{field.value}}</h2>\n    <h3 *ngSwitchCase=\"'h3'\" [ngClass]=\"field.cssClasses\">{{field.value}}</h3>\n    <h4 *ngSwitchCase=\"'h4'\" [ngClass]=\"field.cssClasses\">{{field.value}}</h4>\n    <h5 *ngSwitchCase=\"'h5'\" [ngClass]=\"field.cssClasses\">{{field.value}}</h5>\n    <hr *ngSwitchCase=\"'hr'\" [ngClass]=\"field.cssClasses\">\n    <span *ngSwitchCase=\"'span'\" [ngClass]=\"field.cssClasses\">{{field.value}}</span>\n    <p *ngSwitchDefault [ngClass]=\"field.cssClasses\">{{field.value}}</p>\n  </div>\n  ",
        })
    ], TextBlockComponent);
    return TextBlockComponent;
}(SimpleComponent));
exports.TextBlockComponent = TextBlockComponent;
/**
* #### Save Button Component.
*
* Calls the form framework's save function to create or update the record.
*
* #### Usage
* ```
*     {
*          class: "SaveButton",
*          definition: {
*            label: 'Save & Close',
*            closeOnSave: true,
*            redirectLocation: '/@branding/@portal/dashboard'
*          }
*        }
* ```
*
*| Property Name    | Description                                                    | Required | Default |
*|------------------|----------------------------------------------------------------|----------|---------|
*| label            | The text to display on the button                              | Yes      |         |
*| closeOnSave      | Flag to leave the page on successful save                      | No       | false   |
*| redirectLocation | The location to redirect to if closeOnSave flag is set to true | No       |         |
*/
var SaveButtonComponent = /** @class */ (function (_super) {
    __extends(SaveButtonComponent, _super);
    function SaveButtonComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    SaveButtonComponent.prototype.onClick = function (event) {
        var _this = this;
        if (this.field.closeOnSave == true) {
            var successObs = this.fieldMap._rootComp.onSubmit();
            successObs.subscribe(function (successful) {
                if (successful) {
                    window.location.href = _this.field.redirectLocation;
                }
            });
        }
        else {
            this.fieldMap._rootComp.onSubmit().subscribe();
        }
    };
    SaveButtonComponent = __decorate([
        core_1.Component({
            selector: 'save-button',
            template: "\n    <button type=\"button\" (click)=\"onClick($event)\" class=\"btn\" [ngClass]=\"field.cssClasses\" [disabled]=\"!fieldMap._rootComp.needsSave || fieldMap._rootComp.isSaving()\">{{field.label}}</button>\n  ",
        })
    ], SaveButtonComponent);
    return SaveButtonComponent;
}(SimpleComponent));
exports.SaveButtonComponent = SaveButtonComponent;
/**
* # Cancel Button Component
*
* #### Button designed to
*  @param  {CancelButton} cancelButton
*   @return {FormControl}
*/
var CancelButtonComponent = /** @class */ (function (_super) {
    __extends(CancelButtonComponent, _super);
    function CancelButtonComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    CancelButtonComponent = __decorate([
        core_1.Component({
            selector: 'cancel-button',
            template: "\n    <button type=\"button\" class=\"btn btn-warning\" [disabled]=\"fieldMap._rootComp.isSaving()\" (click)=\"fieldMap._rootComp.onCancel()\">{{field.label}}</button>\n  ",
        })
    ], CancelButtonComponent);
    return CancelButtonComponent;
}(SimpleComponent));
exports.CancelButtonComponent = CancelButtonComponent;
var AnchorOrButtonComponent = /** @class */ (function (_super) {
    __extends(AnchorOrButtonComponent, _super);
    function AnchorOrButtonComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    AnchorOrButtonComponent.prototype.onClick = function (event) {
        this.fieldMap._rootComp[this.field.onClick_RootFn]();
    };
    AnchorOrButtonComponent.prototype.isDisabled = function () {
        if (this.field.isDisabledFn) {
            return this.fieldMap._rootComp[this.field.isDisabledFn]();
        }
        return false;
    };
    AnchorOrButtonComponent = __decorate([
        core_1.Component({
            selector: 'anchor-button',
            template: "\n  <button *ngIf=\"field.controlType=='button'\" type=\"{{field.type}}\" [ngClass]=\"field.cssClasses\" (click)=\"onClick($event)\" [disabled]=\"isDisabled()\">{{field.label}}</button>\n  <a *ngIf=\"field.controlType=='anchor'\" href='{{field.value}}' [ngClass]=\"field.cssClasses\" ><span *ngIf=\"field.showPencil\" class=\"glyphicon glyphicon-pencil\">&nbsp;</span>{{field.label}}</a>\n  ",
        })
    ], AnchorOrButtonComponent);
    return AnchorOrButtonComponent;
}(SimpleComponent));
exports.AnchorOrButtonComponent = AnchorOrButtonComponent;
var TabNavButtonComponent = /** @class */ (function (_super) {
    __extends(TabNavButtonComponent, _super);
    function TabNavButtonComponent(changeRef) {
        var _this = _super.call(this) || this;
        _this.changeRef = changeRef;
        return _this;
    }
    TabNavButtonComponent.prototype.ngOnInit = function () {
        var _this = this;
        this.field.getTabs();
        jQuery('a[data-toggle="tab"]').on('shown.bs.tab', function (e) {
            var tabId = e.target.href.split('#')[1];
            _this.field.currentTab = tabId;
            _this.changeRef.detectChanges();
        });
    };
    TabNavButtonComponent.prototype.stepToTab = function (step) {
        var tabId = this.field.getTabId(step);
        if (tabId) {
            this.fieldMap._rootComp.gotoTab(tabId);
        }
        else {
            console.log("Invalid tab: " + tabId);
        }
    };
    TabNavButtonComponent = __decorate([
        core_1.Component({
            selector: 'tab-nav-button',
            template: "\n    <button type='button'[ngClass]='field.cssClasses' [disabled]=\"!field.getTabId(-1)\" (click)=\"stepToTab(-1)\" >{{field.prevLabel}}</button>\n    <button type='button'[ngClass]='field.cssClasses' [disabled]=\"!field.getTabId(1)\" (click)=\"stepToTab(1)\" >{{field.nextLabel}}</button>\n  ",
        }),
        __metadata("design:paramtypes", [core_1.ChangeDetectorRef])
    ], TabNavButtonComponent);
    return TabNavButtonComponent;
}(SimpleComponent));
exports.TabNavButtonComponent = TabNavButtonComponent;
var LinkValueComponent = /** @class */ (function (_super) {
    __extends(LinkValueComponent, _super);
    function LinkValueComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    LinkValueComponent.prototype.isVisible = function () {
        return !_.isEmpty(this.field.value);
    };
    LinkValueComponent = __decorate([
        core_1.Component({
            selector: 'link-value',
            template: "\n  <li *ngIf=\"!field.editMode && isVisible()\" class=\"key-value-pair padding-bottom-10\">\n    <span class=\"key\" *ngIf=\"field.label\">{{field.label}}</span>\n    <span class=\"value\"><a href='{{field.value}}' target=\"field.target\">{{field.value}}</a></span>\n  </li>\n  ",
        })
    ], LinkValueComponent);
    return LinkValueComponent;
}(SimpleComponent));
exports.LinkValueComponent = LinkValueComponent;
var HiddenValueComponent = /** @class */ (function (_super) {
    __extends(HiddenValueComponent, _super);
    function HiddenValueComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    HiddenValueComponent.prototype.handleChange = function (value, source) {
        var _this = this;
        console.log("Hidden Value change: " + source);
        console.log(value);
        var targetVal = null;
        if (_.isArray(value)) {
            targetVal = [];
            _.forEach(value, function (v) {
                var tVal = '';
                _.forEach(_this.field.onChange.control.subFields, function (subField) {
                    tVal = "" + (_.isEmpty(tVal) ? tVal : "" + tVal + _this.field.onChange.control.delim) + v[subField];
                });
                targetVal.push(tVal);
            });
        }
        this.getFormControl().setValue(targetVal, this.field.onChange.updateConf);
        console.log("Form now has value:");
        console.log(this.form.value);
    };
    HiddenValueComponent = __decorate([
        core_1.Component({
            selector: 'hidden-field',
            template: "\n  <div [formGroup]='form'>\n    <input type=\"hidden\" name=\"{{field.name}}\" [formControl]=\"getFormControl()\" />\n  </div>\n  ",
        })
    ], HiddenValueComponent);
    return HiddenValueComponent;
}(SimpleComponent));
exports.HiddenValueComponent = HiddenValueComponent;
/**
Wrapped: https://github.com/nkalinov/ng2-datetime
Based on: https://bootstrap-datepicker.readthedocs.io/en/stable/
*/
var DateTimeComponent = /** @class */ (function (_super) {
    __extends(DateTimeComponent, _super);
    function DateTimeComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    /**
     * Component method that formats the value, delegates to field.
     */
    DateTimeComponent.prototype.formatValue = function () {
        return this.field.formatValue(this.getFormControl().value);
    };
    DateTimeComponent = __decorate([
        core_1.Component({
            selector: 'date-time',
            template: "\n  <div *ngIf=\"field.editMode\" [formGroup]='form' class=\"form-group\">\n    <label [attr.for]=\"field.name\">\n      {{field.label}} {{ getRequiredLabelStr()}}\n      <button type=\"button\" class=\"btn btn-default\" *ngIf=\"field.help\" (click)=\"toggleHelp()\"><span class=\"glyphicon glyphicon-question-sign\" aria-hidden=\"true\"></span></button>\n    </label><br/>\n    <span id=\"{{ 'helpBlock_' + field.name }}\" class=\"help-block\" *ngIf=\"this.helpShow\" [innerHtml]=\"field.help\"></span>\n    <datetime #dateTime [formControl]=\"getFormControl()\" [timepicker]=\"field.timePickerOpts\" [datepicker]=\"field.datePickerOpts\" [hasClearButton]=\"field.hasClearButton\"></datetime>\n  </div>\n  <li *ngIf=\"!field.editMode\" class=\"key-value-pair\">\n    <span class=\"key\" *ngIf=\"field.label\">{{field.label}}</span>\n    <span class=\"value\">{{field.formatValueForDisplay()}}</span>\n  </li>\n  "
        })
    ], DateTimeComponent);
    return DateTimeComponent;
}(SimpleComponent));
exports.DateTimeComponent = DateTimeComponent;
var ParameterRetrieverComponent = /** @class */ (function (_super) {
    __extends(ParameterRetrieverComponent, _super);
    function ParameterRetrieverComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    ParameterRetrieverComponent.prototype.ngAfterViewInit = function () {
        var paramValue = this.getUrlParameter(this.field.parameterName);
        if (paramValue) {
            this.field.publishParameterValue(paramValue);
        }
    };
    ParameterRetrieverComponent.prototype.getUrlParameter = function (param) {
        var pageURL = decodeURIComponent(window.location.search.substring(1)), urlVariables = pageURL.split('&'), parameterName, i;
        for (i = 0; i < urlVariables.length; i++) {
            parameterName = urlVariables[i].split('=');
            if (parameterName[0] === param) {
                return parameterName[1] === undefined ? true : parameterName[1];
            }
        }
    };
    ParameterRetrieverComponent = __decorate([
        core_1.Component({
            selector: 'parameter-retriever',
            template: "\n  <div>\n\n  </div>\n  ",
        })
    ], ParameterRetrieverComponent);
    return ParameterRetrieverComponent;
}(SimpleComponent));
exports.ParameterRetrieverComponent = ParameterRetrieverComponent;
var SpacerComponent = /** @class */ (function (_super) {
    __extends(SpacerComponent, _super);
    function SpacerComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    SpacerComponent = __decorate([
        core_1.Component({
            selector: 'spacer',
            template: "\n  <span [style.display]=\"'inline-block'\" [style.width]=\"field.width\" [style.height]=\"field.height\">&nbsp;</span>\n  ",
        })
    ], SpacerComponent);
    return SpacerComponent;
}(SimpleComponent));
exports.SpacerComponent = SpacerComponent;


/***/ }),

/***/ "./redbox-portal/angular/shared/form/field-simple.ts":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
Object.defineProperty(exports, "__esModule", { value: true });
// Copyright (c) 2017 Queensland Cyber Infrastructure Foundation (http://www.qcif.edu.au/)
//
// GNU GENERAL PUBLIC LICENSE
//    Version 2, June 1991
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation; either version 2 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this program; if not, write to the Free Software Foundation, Inc.,
// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
var core_1 = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
var field_base_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-base.ts");
var forms_1 = __webpack_require__("./node_modules/@angular/forms/esm5/forms.js");
var _ = __webpack_require__("./node_modules/lodash-es/lodash.js");
var moment_es6_1 = __webpack_require__("./node_modules/moment-es6/index.js");
var SelectionField = /** @class */ (function (_super) {
    __extends(SelectionField, _super);
    function SelectionField(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.options = [];
        // this.options = options['options'] || [];
        _this.options = _.map(options['options'] || [], function (option) {
            option['label'] = _this.getTranslated(option['label'], option['label']);
            option['value'] = _this.getTranslated(option['value'], option['value']);
            return option;
        });
        return _this;
    }
    SelectionField.prototype.createFormModel = function () {
        var _this = this;
        if (this.controlType == 'checkbox') {
            var fgDef_1 = [];
            _.map(this.options, function (opt) {
                var hasValue = _.find(_this.value, function (val) {
                    return val == opt.value;
                });
                if (hasValue) {
                    fgDef_1.push(new forms_1.FormControl(opt.value));
                }
            });
            // const fg = new FormArray(fgDef);
            // return fg;
            return new forms_1.FormArray(fgDef_1);
        }
        else {
            // const model = super.createFormModel();
            // console.log(`Created form model:`);
            // console.log(model);
            // return model;
            return _super.prototype.createFormModel.call(this);
        }
    };
    return SelectionField;
}(field_base_1.FieldBase));
exports.SelectionField = SelectionField;
var Container = /** @class */ (function (_super) {
    __extends(Container, _super);
    function Container(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.controlType = 'div';
        _this.content = options['content'] || '';
        _this.active = options['active'] || false;
        _this.type = options['type'] || '';
        _this.isGroup = true;
        _this.hasControl = _.isUndefined(_this.groupName);
        return _this;
    }
    Container.prototype.getGroup = function (group, fieldMap) {
        this.fieldMap = fieldMap;
        _.set(fieldMap, this.getFullFieldName() + ".field", this);
        group[this.name] = this.required ? new forms_1.FormGroup({}, forms_1.Validators.required) : new forms_1.FormGroup({});
        _.each(this.fields, function (field) {
            field.getGroup(group, fieldMap);
        });
        return group[this.name];
    };
    Container.prototype.createFormModel = function (valueElem) {
        var _this = this;
        if (valueElem === void 0) { valueElem = null; }
        var grp = {};
        _.each(this.fields, function (field) {
            var fldVal = null;
            if (_this.value) {
                fldVal = _.get(_this.value, field.name);
            }
            field.value = fldVal;
            grp[field.name] = field.createFormModel(fldVal);
        });
        this.formModel = this.required ? new forms_1.FormGroup(grp, forms_1.Validators.required) : new forms_1.FormGroup(grp);
        return this.formModel;
    };
    return Container;
}(field_base_1.FieldBase));
exports.Container = Container;
var TabOrAccordionContainer = /** @class */ (function (_super) {
    __extends(TabOrAccordionContainer, _super);
    function TabOrAccordionContainer(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.onTabChange = new core_1.EventEmitter();
        // defaults to nav-pills, nav-stacked, nav size col-md-2, tab content col-md-10
        _this.tabNavContainerClass = options['tabNavContainerClass'] || 'col-md-2';
        _this.tabNavClass = options['tabNavClass'] || 'nav nav-pills nav-stacked';
        _this.tabContentContainerClass = options['tabContentContainerClass'] || 'col-md-10';
        _this.tabContentClass = options['tabContentClass'] || 'tab-content';
        _this.accContainerClass = options['accContainerClass'] || 'col-md-12';
        _this.accClass = options['accClass'] || 'panel panel-default';
        return _this;
    }
    __decorate([
        core_1.Output(),
        __metadata("design:type", core_1.EventEmitter)
    ], TabOrAccordionContainer.prototype, "onTabChange", void 0);
    return TabOrAccordionContainer;
}(Container));
exports.TabOrAccordionContainer = TabOrAccordionContainer;
var ButtonBarContainer = /** @class */ (function (_super) {
    __extends(ButtonBarContainer, _super);
    function ButtonBarContainer(options, injector) {
        return _super.call(this, options, injector) || this;
    }
    return ButtonBarContainer;
}(Container));
exports.ButtonBarContainer = ButtonBarContainer;
var DateTime = /** @class */ (function (_super) {
    __extends(DateTime, _super);
    function DateTime(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.datePickerOpts = options['datePickerOpts'] || false;
        _this.timePickerOpts = options['timePickerOpts'] || false;
        _this.hasClearButton = options['hasClearButton'] || false;
        _this.valueFormat = options['valueFormat'] || 'YYYY-MM-DD';
        _this.displayFormat = options['displayFormat'] || 'YYYY-MM-DD';
        _this.controlType = 'datetime';
        _this.value = _this.value ? _this.parseToDate(_this.value) : _this.value;
        return _this;
    }
    DateTime.prototype.formatValue = function (value) {
        // assume local date
        console.log("Formatting value: " + value);
        return value ? moment_es6_1.default(value).local().format(this.valueFormat) : value;
    };
    DateTime.prototype.parseToDate = function (value) {
        return moment_es6_1.default(value, this.valueFormat).local().toDate();
    };
    DateTime.prototype.formatValueForDisplay = function () {
        var locale = window.navigator.language; // commented out, no support for below IE 11: window.navigator.userLanguage || window.navigator.language;
        return this.value ? moment_es6_1.default(this.value).locale(locale).format(this.displayFormat) : '';
    };
    DateTime.prototype.reactEvent = function (eventName, eventData, origData) {
        var thisDate = moment_es6_1.default(eventData);
        var prevStartDate = moment_es6_1.default(this.formModel.value);
        if (!prevStartDate.isValid() || thisDate.isAfter(prevStartDate)) {
            this.formModel.setValue(eventData);
        }
        var newOpts = _.cloneDeep(this.datePickerOpts);
        newOpts.startDate = eventData;
        this.datePickerOpts = newOpts;
    };
    return DateTime;
}(field_base_1.FieldBase));
exports.DateTime = DateTime;
var SaveButton = /** @class */ (function (_super) {
    __extends(SaveButton, _super);
    function SaveButton(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.label = options['label'];
        _this.closeOnSave = options['closeOnSave'] || false;
        _this.redirectLocation = options['redirectLocation'] || false;
        _this.cssClasses = options['cssClasses'] || "btn-primary";
        return _this;
    }
    return SaveButton;
}(field_base_1.FieldBase));
exports.SaveButton = SaveButton;
var CancelButton = /** @class */ (function (_super) {
    __extends(CancelButton, _super);
    function CancelButton(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.label = options['label'];
        return _this;
    }
    return CancelButton;
}(field_base_1.FieldBase));
exports.CancelButton = CancelButton;
var TabNavButton = /** @class */ (function (_super) {
    __extends(TabNavButton, _super);
    function TabNavButton(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.tabs = [];
        _this.prevLabel = _this.getTranslated(options.prevLabel, 'Previous');
        _this.nextLabel = _this.getTranslated(options.nextLabel, 'Next');
        _this.targetTabContainerId = options.targetTabContainerId;
        return _this;
    }
    TabNavButton.prototype.getTabs = function () {
        var _this = this;
        var targetContainerTab = this.getTargetTab(this.fieldMap._rootComp.formDef.fields);
        if (targetContainerTab) {
            _.each(targetContainerTab.definition.fields, function (tab) {
                _this.tabs.push(tab.definition.id);
            });
            this.currentTab = this.tabs[0];
        }
        else {
            console.log("Target Container Tab not found: " + this.targetTabContainerId);
        }
    };
    TabNavButton.prototype.getTargetTab = function (fields) {
        var _this = this;
        var targetTab = _.find(fields, function (f) {
            if (f.definition && f.definition.id == _this.targetTabContainerId) {
                return true;
            }
            if (f.definition && f.definition.fields) {
                return _this.getTargetTab(f.definition.fields);
            }
        });
        return targetTab;
    };
    TabNavButton.prototype.getCurrentTabIdx = function () {
        var _this = this;
        return _.findIndex(this.tabs, function (curTab) { return curTab == _this.currentTab; });
    };
    TabNavButton.prototype.getTabId = function (step) {
        var curTabIdx = this.getCurrentTabIdx();
        var tabIdx = curTabIdx + step;
        if (tabIdx >= 0 && tabIdx < this.tabs.length) {
            return this.tabs[tabIdx];
        }
        return null;
    };
    return TabNavButton;
}(field_base_1.FieldBase));
exports.TabNavButton = TabNavButton;
var AnchorOrButton = /** @class */ (function (_super) {
    __extends(AnchorOrButton, _super);
    function AnchorOrButton(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.onClick_RootFn = options['onClick_RootFn'] || null;
        _this.isDisabledFn = options['isDisabledFn'] || null;
        _this.type = options['type'] || 'button';
        _this.controlType = options['controlType'] || 'button';
        _this.hasControl = false;
        _this.showPencil = options['showPencil'] || false;
        return _this;
    }
    return AnchorOrButton;
}(field_base_1.FieldBase));
exports.AnchorOrButton = AnchorOrButton;
var HiddenValue = /** @class */ (function (_super) {
    __extends(HiddenValue, _super);
    function HiddenValue(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.controlType = 'hidden';
        return _this;
    }
    return HiddenValue;
}(field_base_1.FieldBase));
exports.HiddenValue = HiddenValue;
var LinkValue = /** @class */ (function (_super) {
    __extends(LinkValue, _super);
    function LinkValue(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.controlType = 'link';
        _this.target = options.target || '_blank';
        return _this;
    }
    return LinkValue;
}(field_base_1.FieldBase));
exports.LinkValue = LinkValue;
var ParameterRetrieverField = /** @class */ (function (_super) {
    __extends(ParameterRetrieverField, _super);
    function ParameterRetrieverField(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.parameterName = options.parameterName || '';
        return _this;
    }
    ParameterRetrieverField.prototype.publishParameterValue = function (value) {
        this.onValueUpdate.emit(value);
    };
    return ParameterRetrieverField;
}(field_base_1.FieldBase));
exports.ParameterRetrieverField = ParameterRetrieverField;
var Spacer = /** @class */ (function (_super) {
    __extends(Spacer, _super);
    function Spacer(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.width = options.width;
        _this.height = options.height;
        return _this;
    }
    return Spacer;
}(field_base_1.FieldBase));
exports.Spacer = Spacer;


/***/ }),

/***/ "./redbox-portal/angular/shared/form/field-textfield.component.ts":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

// Copyright (c) 2017 Queensland Cyber Infrastructure Foundation (http://www.qcif.edu.au/)
//
// GNU GENERAL PUBLIC LICENSE
//    Version 2, June 1991
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation; either version 2 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this program; if not, write to the Free Software Foundation, Inc.,
// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
Object.defineProperty(exports, "__esModule", { value: true });
var core_1 = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
var _ = __webpack_require__("./node_modules/lodash-es/lodash.js");
var field_base_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-base.ts");
var field_repeatable_component_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-repeatable.component.ts");
/**
 * Text Field Model
 *
 * Author: <a href='https://github.com/shilob' target='_blank'>Shilo Banihit</a>

 */
var TextField = /** @class */ (function (_super) {
    __extends(TextField, _super);
    function TextField(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.type = options['type'] || '';
        _this.controlType = 'textbox';
        _this.cssClasses = _.isEmpty(_this.cssClasses) ? 'form-control' : _this.cssClasses;
        return _this;
    }
    TextField.prototype.postInit = function (value) {
        if (_.isEmpty(value)) {
            this.value = this.defaultValue ? this.defaultValue : '';
        }
        else {
            this.value = value;
        }
    };
    return TextField;
}(field_base_1.FieldBase));
exports.TextField = TextField;
var MarkdownTextArea = /** @class */ (function (_super) {
    __extends(MarkdownTextArea, _super);
    function MarkdownTextArea(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.rows = options['rows'] || 5;
        _this.cols = options['cols'] || null;
        _this.controlType = 'textarea';
        return _this;
    }
    MarkdownTextArea.prototype.formatValueForDisplay = function () {
        this.lines = this.value ? this.value.split("\n") : [];
    };
    return MarkdownTextArea;
}(field_base_1.FieldBase));
exports.MarkdownTextArea = MarkdownTextArea;
var TextArea = /** @class */ (function (_super) {
    __extends(TextArea, _super);
    function TextArea(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.rows = options['rows'] || 5;
        _this.cols = options['cols'] || null;
        _this.controlType = 'textarea';
        _this.cssClasses = _.isEmpty(_this.cssClasses) ? 'form-control' : _this.cssClasses;
        return _this;
    }
    TextArea.prototype.formatValueForDisplay = function () {
        this.lines = this.value ? this.value.split("\n") : [];
    };
    return TextArea;
}(field_base_1.FieldBase));
exports.TextArea = TextArea;
var TextFieldComponent = /** @class */ (function (_super) {
    __extends(TextFieldComponent, _super);
    function TextFieldComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TextFieldComponent = __decorate([
        core_1.Component({
            selector: 'textfield',
            template: "\n  <div *ngIf=\"field.editMode\" [ngClass]=\"getGroupClass()\">\n    <div *ngIf=\"!isEmbedded\" >\n      <label [attr.for]=\"field.name\">\n        {{field.label}} {{ getRequiredLabelStr() }}\n        <button type=\"button\" class=\"btn btn-default\" *ngIf=\"field.help\" (click)=\"toggleHelp()\"><span class=\"glyphicon glyphicon-question-sign\" aria-hidden=\"true\"></span></button>\n        <span id=\"{{ 'helpBlock_' + field.name }}\" class=\"help-block\" *ngIf=\"this.helpShow\" [innerHtml]=\"field.help\"></span>\n      </label>\n      <input [formGroup]='form' [formControl]=\"getFormControl()\"  [id]=\"field.name\" [type]=\"field.type\" [readonly]=\"field.readOnly\" [ngClass]=\"field.cssClasses\" [attr.aria-describedby]=\"field.help ? 'helpBlock_' + field.name : null\">\n    </div>\n    <div *ngIf=\"isEmbedded\" class=\"input-group padding-bottom-15\">\n      <input [formControl]=\"getFormControl(name, index)\"  [id]=\"field.name\" [type]=\"field.type\" [readonly]=\"field.readOnly\" [ngClass]=\"field.cssClasses\" [attr.aria-describedby]=\"field.help ? 'helpBlock_' + field.name : null\">\n      <span class=\"input-group-btn\">\n        <button type='button' *ngIf=\"removeBtnText\" [disabled]=\"!canRemove\" (click)=\"onRemove($event)\" [ngClass]=\"removeBtnClass\" >{{removeBtnText}}</button>\n        <button [disabled]=\"!canRemove\" type='button' [ngClass]=\"removeBtnClass\" (click)=\"onRemove($event)\"></button>\n      </span>\n    </div>\n    <div *ngIf=\"field.required\" [style.visibility]=\"getFormControl() && getFormControl().hasError('required') && getFormControl().touched ? 'inherit':'hidden'\">\n      <div class=\"text-danger\" *ngIf=\"!field.validationMessages?.required\">{{field.label}} is required</div>\n      <div class=\"text-danger\" *ngIf=\"field.validationMessages?.required\">{{field.validationMessages.required}}</div>\n    </div>\n  </div>\n  <div *ngIf=\"!field.editMode\" class=\"key-value-pair\">\n    <span class=\"key\" *ngIf=\"field.label\">{{field.label}}</span>\n    <span class=\"value\">{{field.value}}</span>\n  </div>\n  ",
        })
    ], TextFieldComponent);
    return TextFieldComponent;
}(field_repeatable_component_1.EmbeddableComponent));
exports.TextFieldComponent = TextFieldComponent;
var RepeatableTextfieldComponent = /** @class */ (function (_super) {
    __extends(RepeatableTextfieldComponent, _super);
    function RepeatableTextfieldComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    RepeatableTextfieldComponent.prototype.ngOnInit = function () {
    };
    RepeatableTextfieldComponent.prototype.addElem = function (event) {
        var newElem = this.field.addElem();
    };
    RepeatableTextfieldComponent.prototype.removeElem = function (event, i) {
        this.field.removeElem(i);
    };
    RepeatableTextfieldComponent.clName = 'RepeatableTextfieldComponent';
    RepeatableTextfieldComponent = __decorate([
        core_1.Component({
            selector: 'repeatable-textfield',
            template: "\n  <div *ngIf=\"field.editMode\">\n    <div class=\"row\">\n      <div class=\"col-xs-12\">\n      <label>\n        {{field.label}} {{ getRequiredLabelStr() }}\n        <button type=\"button\" class=\"btn btn-default\" *ngIf=\"field.help\" (click)=\"toggleHelp()\"><span class=\"glyphicon glyphicon-question-sign\" aria-hidden=\"true\"></span></button>\n      </label>\n      <span id=\"{{ 'helpBlock_' + field.name }}\" class=\"help-block\" *ngIf=\"this.helpShow\" [innerHtml]=\"field.help\"></span>\n      </div>\n    </div>\n    <div *ngFor=\"let fieldElem of field.fields; let i = index;\" class=\"row\">\n      <span class=\"col-xs-12\">\n        <textfield [name]=\"field.name\" [field]=\"fieldElem\" [form]=\"form\" [fieldMap]=\"fieldMap\" [isEmbedded]=\"true\" [removeBtnText]=\"field.removeButtonText\" [removeBtnClass]=\"field.removeButtonClass\" [canRemove]=\"field.fields.length > 1\" (onRemoveBtnClick)=\"removeElem($event[0], $event[1])\" [index]=\"i\"></textfield>\n      </span>\n    </div>\n    <div class=\"row\">\n      <span class=\"col-xs-12\">\n        <button *ngIf=\"field.addButtonText\" type='button' (click)=\"addElem($event)\" [ngClass]=\"field.addButtonTextClass\" >{{field.addButtonText}}</button>\n        <button *ngIf=\"!field.addButtonText\" type='button' (click)=\"addElem($event)\" [ngClass]=\"field.addButtonClass\"></button>\n      </span>\n    </div>\n  </div>\n  <li *ngIf=\"!field.editMode\" class=\"key-value-pair\">\n    <span *ngIf=\"field.label\" class=\"key\">{{field.label}}</span>\n    <span class=\"value\">\n      <ul class=\"key-value-list\">\n        <textfield *ngFor=\"let fieldElem of field.fields; let i = index;\"  [field]=\"fieldElem\" [form]=\"form\" [fieldMap]=\"fieldMap\"></textfield>\n      </ul>\n    </span>\n  </li>\n  ",
        })
    ], RepeatableTextfieldComponent);
    return RepeatableTextfieldComponent;
}(field_repeatable_component_1.RepeatableComponent));
exports.RepeatableTextfieldComponent = RepeatableTextfieldComponent;
/**
 * Component
 * Author: <a href='https://github.com/shilob' target='_blank'>Shilo Banihit</a>
 */
var TextAreaComponent = /** @class */ (function (_super) {
    __extends(TextAreaComponent, _super);
    function TextAreaComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TextAreaComponent.prototype.ngOnInit = function () {
        if (!this.field.editMode) {
            this.field.formatValueForDisplay();
        }
    };
    TextAreaComponent = __decorate([
        core_1.Component({
            selector: 'text-area',
            template: "\n  <div *ngIf=\"field.editMode\" [formGroup]='form' [ngClass]=\"getGroupClass()\">\n    <label [attr.for]=\"field.name\">\n      {{field.label}} {{ getRequiredLabelStr()}}\n      <button type=\"button\" class=\"btn btn-default\" *ngIf=\"field.help\" (click)=\"toggleHelp()\"><span class=\"glyphicon glyphicon-question-sign\" aria-hidden=\"true\"></span></button>\n    </label>\n    <!-- Normal version -->\n    <ng-container *ngIf=\"!field.isEmbedded\">\n      <ng-container *ngIf=\"this.helpShow\">\n        <br/>\n        <span id=\"{{ 'helpBlock_' + field.name }}\" class=\"help-block\" [innerHtml]=\"field.help\"></span>\n      </ng-container>\n      <textarea [formControl]=\"getFormControl()\"  [attr.rows]=\"field.rows\" [attr.cols]=\"field.cols\" [id]=\"field.name\" [ngClass]=\"field.cssClasses\" >{{field.value}}</textarea>\n    </ng-container>\n    <!-- Embedded version -->\n    <div *ngIf=\"isEmbedded\" class=\"input-group padding-bottom-15\">\n      <textarea [formControl]=\"getFormControl(name, index)\"  [attr.rows]=\"field.rows\" [attr.cols]=\"field.cols\" [id]=\"field.name\" [ngClass]=\"field.cssClasses\">{{field.value}}</textarea>\n    </div>\n    <!-- Validation messages -->\n    <div *ngIf=\"field.required\" [style.visibility]=\"getFormControl() && getFormControl().hasError('required') && getFormControl().touched ? 'inherit':'hidden'\">\n      <div class=\"text-danger\" *ngIf=\"getFormControl().hasError('required') && getFormControl().touched && !field.validationMessages?.required\">{{field.label}} is required</div>\n      <div class=\"text-danger\" *ngIf=\"getFormControl().hasError('required') && getFormControl().touched && field.validationMessages?.required\">{{field.validationMessages.required}}</div>\n    </div>\n  </div>\n  <li *ngIf=\"!field.editMode\" class=\"key-value-pair\">\n    <span class=\"key\" *ngIf=\"field.label\">{{field.label}}</span>\n    <span *ngFor=\"let line of field.lines\">\n      {{line}}\n      <br/>\n    </span>\n    <br/>\n  </li>\n  "
        })
    ], TextAreaComponent);
    return TextAreaComponent;
}(field_repeatable_component_1.EmbeddableComponent));
exports.TextAreaComponent = TextAreaComponent;
var MarkdownTextAreaComponent = /** @class */ (function (_super) {
    __extends(MarkdownTextAreaComponent, _super);
    function MarkdownTextAreaComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    MarkdownTextAreaComponent.prototype.ngOnInit = function () {
        if (!this.field.editMode) {
            this.field.formatValueForDisplay();
        }
    };
    MarkdownTextAreaComponent = __decorate([
        core_1.Component({
            selector: 'markdown-text-area',
            template: "\n  <div *ngIf=\"field.editMode\" [formGroup]='form' class=\"form-group\">\n    <label [attr.for]=\"field.name\">\n      {{field.label}} {{ getRequiredLabelStr()}}\n      <button type=\"button\" class=\"btn btn-default\" *ngIf=\"field.help\" (click)=\"toggleHelp()\"><span class=\"glyphicon glyphicon-question-sign\" aria-hidden=\"true\"></span></button>\n    </label><br/>\n    <span id=\"{{ 'helpBlock_' + field.name }}\" class=\"help-block\" *ngIf=\"this.helpShow\" [innerHtml]=\"field.help\"></span>\n    <textarea [formControl]=\"getFormControl()\"  [attr.rows]=\"field.rows\" [attr.cols]=\"field.cols\" [id]=\"field.name\" class=\"form-control\" [(ngModel)]=\"field.value\"></textarea>\n    <div *ngIf=\"field.value\" style='font-weight:bold'>Preview</div>\n    <markdown [data]=\"field.value\"></markdown>\n    <div class=\"text-danger\" *ngIf=\"getFormControl().hasError('required') && getFormControl().touched && !field.validationMessages?.required\">{{field.label}} is required</div>\n    <div class=\"text-danger\" *ngIf=\"getFormControl().hasError('required') && getFormControl().touched && field.validationMessages?.required\">{{field.validationMessages.required}}</div>\n  </div>\n  <li *ngIf=\"!field.editMode\" class=\"key-value-pair\">\n    <span class=\"key\" *ngIf=\"field.label\">{{field.label}}</span>\n    <markdown [data]=\"field.value\"></markdown>\n    <br/>\n  </li>\n  "
        })
    ], MarkdownTextAreaComponent);
    return MarkdownTextAreaComponent;
}(field_repeatable_component_1.EmbeddableComponent));
exports.MarkdownTextAreaComponent = MarkdownTextAreaComponent;


/***/ }),

/***/ "./redbox-portal/angular/shared/form/field-vocab.component.ts":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

// Copyright (c) 2017 Queensland Cyber Infrastructure Foundation (http://www.qcif.edu.au/)
//
// GNU GENERAL PUBLIC LICENSE
//    Version 2, June 1991
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation; either version 2 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this program; if not, write to the Free Software Foundation, Inc.,
// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};
Object.defineProperty(exports, "__esModule", { value: true });
var core_1 = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
var field_simple_component_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-simple.component.ts");
var field_base_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-base.ts");
var forms_1 = __webpack_require__("./node_modules/@angular/forms/esm5/forms.js");
var _ = __webpack_require__("./node_modules/lodash-es/lodash.js");
var rxjs_1 = __webpack_require__("./node_modules/rxjs/Rx.js");
var Subject_1 = __webpack_require__("./node_modules/rxjs/_esm5/Subject.js");
__webpack_require__("./node_modules/rxjs/_esm5/add/operator/toPromise.js");
__webpack_require__("./node_modules/rxjs/_esm5/add/observable/of.js");
__webpack_require__("./node_modules/rxjs/_esm5/add/operator/map.js");
var http_1 = __webpack_require__("./node_modules/@angular/http/esm5/http.js");
var base_service_1 = __webpack_require__("./redbox-portal/angular/shared/base-service.ts");
var config_service_1 = __webpack_require__("./redbox-portal/angular/shared/config-service.ts");
var luceneEscapeQuery = __webpack_require__("./node_modules/lucene-escape-query/index.js");
/**
 * Vocabulary Field
 *
 * Author: <a href='https://github.com/shilob' target='_blank'>Shilo Banihit</a>
 *
 */
var VocabField = /** @class */ (function (_super) {
    __extends(VocabField, _super);
    function VocabField(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.clName = 'VocabField';
        _this.hasLookup = true;
        _this.vocabId = options['vocabId'] || '';
        _this.controlType = 'textbox';
        _this.titleFieldName = options['titleFieldName'] || 'title';
        _this.titleFieldArr = options['titleFieldArr'] || [];
        _this.searchFields = options['searchFields'] || '';
        _this.titleFieldDelim = options['titleFieldDelim'] || ' - ';
        _this.fieldNames = options['fieldNames'] || [];
        _this.sourceType = options['sourceType'] || 'vocab';
        _this.placeHolder = options['placeHolder'] || 'Select a valid value';
        _this.disableEditAfterSelect = options['disableEditAfterSelect'] == undefined ? true : options['disableEditAfterSelect'];
        _this.stringLabelToField = options['stringLabelToField'] ? options['stringLabelToField'] : 'dc_title';
        return _this;
    }
    VocabField.prototype.createFormModel = function (valueElem, createFormGroup) {
        var _this = this;
        if (valueElem === void 0) { valueElem = undefined; }
        if (createFormGroup === void 0) { createFormGroup = false; }
        if (valueElem) {
            this.value = valueElem;
        }
        if (createFormGroup) {
            var flds_1 = {};
            _.forEach(this.fieldNames, function (fld) {
                _.forOwn(fld, function (srcFld, targetFld) {
                    flds_1[targetFld] = new forms_1.FormControl(_this.value[targetFld] || '');
                });
            });
            this.formModel = new forms_1.FormGroup(flds_1);
        }
        else {
            this.formModel = new forms_1.FormControl(this.value || '');
        }
        if (this.value) {
            var init = _.cloneDeep(this.value);
            init.title = this.getTitle(this.value);
            this.initialValue = init;
        }
        if (this.required) {
            this.formModel.setValidators([forms_1.Validators.required]);
        }
        return this.formModel;
    };
    VocabField.prototype.postInit = function (value) {
        if (value) {
            this.value = value;
        }
        else {
            this.setEmptyValue();
        }
        this.initLookupData();
    };
    VocabField.prototype.setEmptyValue = function () {
        this.value = null;
        return this.value;
    };
    VocabField.prototype.setLookupServices = function (completerService, lookupService) {
        this.completerService = completerService;
        this.lookupService = lookupService;
    };
    VocabField.prototype.initLookupData = function () {
        var _this = this;
        if (this.sourceType == "vocab") {
            // Hack for creating the intended title...
            _.forEach(this.sourceData, function (data) {
                data.title = _this.getTitle(data);
            });
            this.dataService = this.completerService.local(this.sourceData, this.searchFields, 'title');
        }
        else if (this.sourceType == "collection" || this.sourceType == "user") {
            var url = this.lookupService.getCollectionRootUrl(this.vocabId);
            if (this.sourceType == "user") {
                url = this.lookupService.getUserLookupUrl();
            }
            console.log("Using: " + url);
            // at the moment, multiple titles arrays are not supported
            // TODO: consider replacing with ngx-bootstrap typeahead
            var title = this.titleFieldArr.length == 1 ? this.titleFieldArr[0] : 'title';
            console.log("Using title: " + title);
            this.dataService = this.completerService.remote(url, this.searchFields, title);
        }
        else if (this.sourceType == "mint") {
            var url = this.lookupService.getMintRootUrl(this.vocabId);
            console.log("Using: " + url);
            this.dataService = new MintLookupDataService(url, this.lookupService.http, this.fieldNames, this.titleFieldName, this.titleFieldArr, this.titleFieldDelim, this.searchFields);
        }
    };
    VocabField.prototype.getTitle = function (data) {
        var _this = this;
        var title = '';
        if (data) {
            if (_.isString(this.titleFieldDelim)) {
                _.forEach(this.titleFieldArr, function (titleFld) {
                    var titleVal = data[titleFld];
                    if (titleVal) {
                        title = "" + title + (_.isEmpty(title) ? '' : _this.titleFieldDelim) + titleVal;
                    }
                });
            }
            else {
                // expecting a delim pair array, 'prefix', 'suffix'
                _.forEach(this.titleFieldArr, function (titleFld, idx) {
                    var delimPair = _this.titleFieldDelim[idx];
                    var titleVal = data[titleFld];
                    if (titleVal) {
                        title = "" + title + (_.isEmpty(title) ? '' : delimPair.prefix) + titleVal + (_.isEmpty(title) ? '' : delimPair.suffix);
                    }
                });
            }
        }
        return title;
    };
    VocabField.prototype.getValue = function (data) {
        var _this = this;
        var valObj = {};
        if (_.isString(data)) {
            console.log("Data is string...");
            valObj[this.stringLabelToField] = data;
            return valObj;
        }
        _.forEach(this.fieldNames, function (fldName) {
            if (data.originalObject) {
                _this.getFieldValuePair(fldName, data.originalObject, valObj);
            }
            else {
                _this.getFieldValuePair(fldName, data, valObj);
            }
        });
        return valObj;
    };
    VocabField.prototype.getFieldValuePair = function (fldName, data, valObj) {
        if (_.isString(fldName)) {
            valObj[fldName] = _.get(data, fldName);
        }
        else {
            // expects a value pair
            _.forOwn(fldName, function (srcFld, targetFld) {
                if (_.get(data, srcFld)) {
                    valObj[targetFld] = _.get(data, srcFld);
                }
                else {
                    valObj[targetFld] = _.get(data, targetFld);
                }
            });
        }
    };
    VocabField.prototype.setValue = function (value, emitEvent, updateTitle) {
        if (emitEvent === void 0) { emitEvent = true; }
        if (updateTitle === void 0) { updateTitle = false; }
        this.formModel.setValue(value, { emitEvent: emitEvent });
        if (updateTitle) {
            this.component.ngCompleter.ctrInput.nativeElement.value = this.getTitle(value);
        }
    };
    return VocabField;
}(field_base_1.FieldBase));
exports.VocabField = VocabField;
var MintLookupDataService = /** @class */ (function (_super) {
    __extends(MintLookupDataService, _super);
    function MintLookupDataService(url, http, fields, compositeTitleName, titleFieldArr, titleFieldDelim, searchFieldStr) {
        var _this = _super.call(this) || this;
        _this.url = url;
        _this.http = http;
        _this.fields = fields;
        _this.compositeTitleName = compositeTitleName;
        _this.titleFieldArr = titleFieldArr;
        _this.titleFieldDelim = titleFieldDelim;
        _this.searchFields = searchFieldStr.split(',');
        return _this;
    }
    MintLookupDataService.prototype.search = function (term) {
        var _this = this;
        term = _.trim(luceneEscapeQuery.escape(term));
        var searchString = '';
        if (!_.isEmpty(term)) {
            term = _.toLower(term);
            _.forEach(this.searchFields, function (searchFld) {
                searchString = "" + searchString + (_.isEmpty(searchString) ? '' : ' OR ') + searchFld + ":" + term + "*";
            });
        }
        var searchUrl = "" + this.url + searchString;
        this.http.get("" + searchUrl).map(function (res, index) {
            // Convert the result to CompleterItem[]
            var data = res.json();
            var matches = _.map(data, function (mintDataItem) { return _this.convertToItem(mintDataItem); });
            _this.next(matches);
        }).subscribe();
    };
    MintLookupDataService.prototype.cancel = function () {
        // Handle cancel
    };
    MintLookupDataService.prototype.convertToItem = function (data) {
        if (!data) {
            return null;
        }
        var item = {};
        _.forEach(this.fields, function (fieldName) {
            if (_.isString(fieldName)) {
                item[fieldName] = data[fieldName];
            }
            else {
                // expects a value pair
                _.forOwn(fieldName, function (srcFld, targetFld) {
                    if (_.get(data, srcFld)) {
                        item[srcFld] = _.get(data, srcFld);
                    }
                    else {
                        item[targetFld] = _.get(data, targetFld);
                    }
                });
            }
        });
        // build the title,
        item[this.compositeTitleName] = this.getTitle(data);
        return item;
    };
    MintLookupDataService.prototype.getTitle = function (data) {
        var _this = this;
        var title = '';
        if (data) {
            if (_.isString(this.titleFieldDelim)) {
                _.forEach(this.titleFieldArr, function (titleFld) {
                    var titleVal = data[titleFld];
                    if (titleVal) {
                        title = "" + title + (_.isEmpty(title) ? '' : _this.titleFieldDelim) + data[titleFld];
                    }
                });
            }
            else {
                // expecting a delim pair array, 'prefix', 'suffix'
                _.forEach(this.titleFieldArr, function (titleFld, idx) {
                    var delimPair = _this.titleFieldDelim[idx];
                    var titleVal = data[titleFld];
                    if (titleVal) {
                        title = "" + title + delimPair.prefix + titleVal + delimPair.suffix;
                    }
                });
            }
        }
        return title;
    };
    return MintLookupDataService;
}(Subject_1.Subject));
var VocabFieldLookupService = /** @class */ (function (_super) {
    __extends(VocabFieldLookupService, _super);
    function VocabFieldLookupService(http, configService) {
        var _this = _super.call(this, http, configService) || this;
        _this.configService = configService;
        return _this;
    }
    VocabFieldLookupService.prototype.getLookupData = function (field) {
        var _this = this;
        var vocabId = field.vocabId;
        // only retrieving static data when on vocab mode
        if (field.sourceType == "vocab") {
            var url = this.brandingAndPortalUrl + "/" + this.config.vocabRootUrl + "/" + vocabId;
            return this.http.get(url, this.options)
                .flatMap(function (res) {
                var data = _this.extractData(res);
                field.sourceData = data;
                field.postInit(field.value);
                return rxjs_1.Observable.of(field);
            });
        }
        field.postInit(field.value);
        return rxjs_1.Observable.of(field);
    };
    VocabFieldLookupService.prototype.getCollectionRootUrl = function (collectionId) {
        return this.brandingAndPortalUrl + "/" + this.config.collectionRootUri + "/" + collectionId + "/?search=";
    };
    VocabFieldLookupService.prototype.getUserLookupUrl = function (searchSource) {
        if (searchSource === void 0) { searchSource = ''; }
        return this.brandingAndPortalUrl + "/" + this.config.userRootUri + "/?source=" + searchSource + "&name=";
    };
    VocabFieldLookupService.prototype.findLookupData = function (field, search) {
    };
    VocabFieldLookupService.prototype.getMintRootUrl = function (source) {
        return this.brandingAndPortalUrl + "/" + this.config.mintRootUri + "/" + source + "/?search=";
    };
    VocabFieldLookupService = __decorate([
        core_1.Injectable(),
        __param(0, core_1.Inject(http_1.Http)), __param(1, core_1.Inject(config_service_1.ConfigService)),
        __metadata("design:paramtypes", [http_1.Http, config_service_1.ConfigService])
    ], VocabFieldLookupService);
    return VocabFieldLookupService;
}(base_service_1.BaseService));
exports.VocabFieldLookupService = VocabFieldLookupService;
var VocabFieldComponent = /** @class */ (function (_super) {
    __extends(VocabFieldComponent, _super);
    function VocabFieldComponent() {
        var _this = _super.call(this) || this;
        _this.isEmbedded = false;
        _this.canRemove = false;
        _this.removeBtnText = null;
        _this.removeBtnClass = 'fa fa-minus-circle btn text-20 pull-right btn-danger';
        _this.disableEditAfterSelect = true;
        _this.onRemoveBtnClick = new core_1.EventEmitter();
        return _this;
    }
    VocabFieldComponent.prototype.ngOnInit = function () {
        this.field.component = this;
    };
    VocabFieldComponent.prototype.getGroupClass = function (fldName) {
        if (fldName === void 0) { fldName = null; }
        return "col-xs-12 form-group " + (this.hasRequiredError() ? 'has-error' : '');
    };
    VocabFieldComponent.prototype.onSelect = function (selected, emitEvent, updateTitle) {
        if (emitEvent === void 0) { emitEvent = true; }
        if (updateTitle === void 0) { updateTitle = false; }
        var disableEditAfterSelect = this.disableEditAfterSelect && this.field.disableEditAfterSelect;
        if (selected) {
            this.field.setValue(this.field.getValue(selected), emitEvent, updateTitle);
            if (disableEditAfterSelect)
                this.disableInput = true;
        }
        else {
            if (disableEditAfterSelect) {
                // means user can't edit, so no worries!
                this.field.setValue(null, emitEvent, updateTitle);
            }
            else {
                // set whatever value on the searchStr, let the fields decide how to parse the string...
                this.field.setValue(this.field.getValue(this.field.searchStr), emitEvent, updateTitle);
            }
        }
    };
    VocabFieldComponent.prototype.onKeyup = function (value) {
        var disableEditAfterSelect = this.disableEditAfterSelect && this.field.disableEditAfterSelect;
        if (!disableEditAfterSelect) {
            this.field.formModel.setValue(this.field.getValue(this.field.searchStr));
        }
    };
    VocabFieldComponent.prototype.onRemove = function (event) {
        this.onRemoveBtnClick.emit([event, this.index]);
    };
    VocabFieldComponent.prototype.getTitle = function () {
        return this.field && _.isFunction(this.field.getTitle) ? this.field.getTitle(this.field.value) : '';
    };
    __decorate([
        core_1.Input(),
        __metadata("design:type", VocabField)
    ], VocabFieldComponent.prototype, "field", void 0);
    __decorate([
        core_1.Input(),
        __metadata("design:type", Boolean)
    ], VocabFieldComponent.prototype, "isEmbedded", void 0);
    __decorate([
        core_1.Input(),
        __metadata("design:type", Boolean)
    ], VocabFieldComponent.prototype, "canRemove", void 0);
    __decorate([
        core_1.Input(),
        __metadata("design:type", String)
    ], VocabFieldComponent.prototype, "removeBtnText", void 0);
    __decorate([
        core_1.Input(),
        __metadata("design:type", String)
    ], VocabFieldComponent.prototype, "removeBtnClass", void 0);
    __decorate([
        core_1.Input(),
        __metadata("design:type", Number)
    ], VocabFieldComponent.prototype, "index", void 0);
    __decorate([
        core_1.Input(),
        __metadata("design:type", Boolean)
    ], VocabFieldComponent.prototype, "disableEditAfterSelect", void 0);
    __decorate([
        core_1.Output(),
        __metadata("design:type", core_1.EventEmitter)
    ], VocabFieldComponent.prototype, "onRemoveBtnClick", void 0);
    __decorate([
        core_1.ViewChild('ngCompleter'),
        __metadata("design:type", core_1.ElementRef)
    ], VocabFieldComponent.prototype, "ngCompleter", void 0);
    VocabFieldComponent = __decorate([
        core_1.Component({
            selector: 'rb-vocab',
            template: "\n  <div *ngIf=\"field.editMode && !isEmbedded\" [formGroup]='form' [ngClass]=\"getGroupClass()\">\n    <label>\n      {{field.label}} {{getRequiredLabelStr()}}\n      <button type=\"button\" class=\"btn btn-default\" *ngIf=\"field.help\" (click)=\"toggleHelp()\"><span class=\"glyphicon glyphicon-question-sign\" aria-hidden=\"true\"></span></button>\n    </label>\n    <span id=\"{{ 'helpBlock_' + field.name }}\" class=\"help-block\" *ngIf=\"this.helpShow\" >{{field.help}}</span>\n    <ng2-completer #ngCompleter [(ngModel)]=\"field.searchStr\" [ngModelOptions]=\"{standalone: true}\" [disableInput]=\"disableInput\" [placeholder]=\"field.placeHolder\" [clearUnselected]=\"disableEditAfterSelect && field.disableEditAfterSelect\" (keyup)=\"onKeyup($event)\" (selected)=\"onSelect($event)\" [datasource]=\"field.dataService\" [minSearchLength]=\"0\" [inputClass]=\"'form-control'\" [initialValue]=\"field.initialValue\"></ng2-completer>\n    <div class=\"text-danger\" *ngIf=\"hasRequiredError()\">{{field.validationMessages.required}}</div>\n  </div>\n  <div *ngIf=\"field.editMode && isEmbedded\" [formGroup]='form' [ngClass]=\"getGroupClass()\">\n    <div class=\"row\">\n      <span id=\"{{ 'helpBlock_' + field.name }}\" class=\"help-block\" *ngIf=\"this.helpShow\" >{{field.help}}</span>\n      <div class=\"col-xs-11 padding-remove\">\n        <ng2-completer #ngCompleter [(ngModel)]=\"field.searchStr\" [ngModelOptions]=\"{standalone: true}\" [disableInput]=\"disableInput\" [placeholder]=\"field.placeHolder\" [clearUnselected]=\"disableEditAfterSelect && field.disableEditAfterSelect\" (keyup)=\"onKeyup($event)\" (selected)=\"onSelect($event)\" [datasource]=\"field.dataService\" [minSearchLength]=\"0\" [inputClass]=\"'form-control'\" [initialValue]=\"field.initialValue\"></ng2-completer>\n      </div>\n      <div class=\"col-xs-1 padding-remove\">\n        <button type='button' *ngIf=\"removeBtnText\" [disabled]=\"!canRemove\" (click)=\"onRemove($event)\" [ngClass]=\"removeBtnClass\" >{{removeBtnText}}</button>\n        <button [disabled]=\"!canRemove\" type='button' [ngClass]=\"removeBtnClass\" (click)=\"onRemove($event)\"></button>\n      </div>\n    </div>\n    <div class=\"row\">\n      <div class=\"col-xs-12 text-danger\" *ngIf=\"hasRequiredError()\">{{field.validationMessages.required}}</div>\n    </div>\n  </div>\n\n  <li *ngIf=\"!field.editMode\" class=\"key-value-pair\">\n    <span *ngIf=\"field.label\" class=\"key\">{{field.label}}</span>\n    <span class=\"value\">{{getTitle()}}</span>\n  </li>\n  ",
        }),
        __metadata("design:paramtypes", [])
    ], VocabFieldComponent);
    return VocabFieldComponent;
}(field_simple_component_1.SimpleComponent));
exports.VocabFieldComponent = VocabFieldComponent;


/***/ }),

/***/ "./redbox-portal/angular/shared/form/record-meta.component.ts":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
Object.defineProperty(exports, "__esModule", { value: true });
// Copyright (c) 2017 Queensland Cyber Infrastructure Foundation (http://www.qcif.edu.au/)
//
// GNU GENERAL PUBLIC LICENSE
//    Version 2, June 1991
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation; either version 2 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this program; if not, write to the Free Software Foundation, Inc.,
// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
var core_1 = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
var field_base_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-base.ts");
var records_service_1 = __webpack_require__("./redbox-portal/angular/shared/form/records.service.ts");
var field_simple_component_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-simple.component.ts");
var RecordMetadataRetrieverField = /** @class */ (function (_super) {
    __extends(RecordMetadataRetrieverField, _super);
    function RecordMetadataRetrieverField(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.recordsService = _this.getFromInjector(records_service_1.RecordsService);
        _this.parameterName = options.parameterName || '';
        return _this;
    }
    RecordMetadataRetrieverField.prototype.publishMetadata = function (oid, config) {
        var _this = this;
        this.recordsService.getRecordMeta(oid).then(function (data) {
            _this.onValueUpdate.emit(data);
        });
    };
    return RecordMetadataRetrieverField;
}(field_base_1.FieldBase));
exports.RecordMetadataRetrieverField = RecordMetadataRetrieverField;
var RecordMetadataRetrieverComponent = /** @class */ (function (_super) {
    __extends(RecordMetadataRetrieverComponent, _super);
    function RecordMetadataRetrieverComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    RecordMetadataRetrieverComponent = __decorate([
        core_1.Component({
            selector: 'record-metadata-retriever',
            template: "\n  ",
        })
    ], RecordMetadataRetrieverComponent);
    return RecordMetadataRetrieverComponent;
}(field_simple_component_1.SimpleComponent));
exports.RecordMetadataRetrieverComponent = RecordMetadataRetrieverComponent;


/***/ }),

/***/ "./redbox-portal/angular/shared/form/records.service.ts":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

// Copyright (c) 2017 Queensland Cyber Infrastructure Foundation (http://www.qcif.edu.au/)
//
// GNU GENERAL PUBLIC LICENSE
//    Version 2, June 1991
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation; either version 2 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this program; if not, write to the Free Software Foundation, Inc.,
// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};
Object.defineProperty(exports, "__esModule", { value: true });
var core_1 = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
var base_service_1 = __webpack_require__("./redbox-portal/angular/shared/base-service.ts");
var http_1 = __webpack_require__("./node_modules/@angular/http/esm5/http.js");
__webpack_require__("./node_modules/rxjs/_esm5/add/operator/toPromise.js");
var field_control_meta_service_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-control-meta.service.ts");
var Observable_1 = __webpack_require__("./node_modules/rxjs/_esm5/Observable.js");
var _ = __webpack_require__("./node_modules/lodash-es/lodash.js");
var config_service_1 = __webpack_require__("./redbox-portal/angular/shared/config-service.ts");
/**
 * Plan Client-side services
 *
 *
 *
 * Author: <a href='https://github.com/shilob' target='_blank'>Shilo Banihit</a>
 */
var RecordsService = /** @class */ (function (_super) {
    __extends(RecordsService, _super);
    function RecordsService(http, fcmetaService, configService, app) {
        var _this = _super.call(this, http, configService) || this;
        _this.fcmetaService = fcmetaService;
        _this.configService = configService;
        _this.app = app;
        return _this;
    }
    RecordsService.prototype.getForm = function (oid, recordType, editable) {
        var _this = this;
        if (oid === void 0) { oid = null; }
        if (recordType === void 0) { recordType = null; }
        if (editable === void 0) { editable = true; }
        if (_.isEmpty(oid)) {
            oid = null;
        }
        return this.getFormFieldsMeta(recordType, editable, oid).then(function (form) {
            return _this.fcmetaService.getLookupData(form.fieldsMeta).flatMap(function (fields) {
                form.fieldsMata = fields;
                return Observable_1.Observable.of(form);
            });
        });
    };
    RecordsService.prototype.addRenderCompleteElement = function (fieldsMeta) {
        var renderCompleteElement = {
            "class": "Container",
            "compClass": "TextBlockComponent",
            "definition": {
                "value": "",
                "type": "span",
                "cssClasses": "form-render-complete"
            }
        };
        fieldsMeta.push(renderCompleteElement);
    };
    RecordsService.prototype.getFormFields = function (recordType, oid, editable) {
        var _this = this;
        if (oid === void 0) { oid = null; }
        var ts = new Date().getTime();
        console.log("Oid is: " + oid);
        var url = oid ? this.brandingAndPortalUrl + "/record/form/auto/" + oid + "?edit=" + editable + "&ts=" + ts : this.brandingAndPortalUrl + "/record/form/" + recordType + "?edit=" + editable + "&ts=" + ts;
        console.log("URL is: " + url);
        return this.http.get(url, this.options)
            .toPromise()
            .then(function (res) { return _this.extractData(res); });
    };
    RecordsService.prototype.getFormFieldsMeta = function (recordType, editable, oid) {
        var _this = this;
        if (oid === void 0) { oid = null; }
        return this.getFormFields(recordType, oid, editable).then(function (form) {
            if (form && form.fields) {
                if (!editable) {
                    // Add an empty element to the end of the form so a screenshot tool can detect the rendered form reliably
                    _this.addRenderCompleteElement(form.fields);
                }
                form.fieldsMeta = _this.fcmetaService.getFieldsMeta(form.fields);
            }
            else {
                console.error("Error loading form:" + recordType);
                throw form;
            }
            return form;
        });
    };
    RecordsService.prototype.create = function (record, recordType) {
        var _this = this;
        return this.http.post(this.brandingAndPortalUrl + "/recordmeta/" + recordType, record, this.getOptionsClient())
            .map(function (res) { return _this.extractData(res); });
    };
    RecordsService.prototype.update = function (oid, record) {
        var _this = this;
        return this.http.put(this.brandingAndPortalUrl + "/recordmeta/" + oid, record, this.getOptionsClient())
            .map(function (res) { return _this.extractData(res); });
    };
    RecordsService.prototype.stepTo = function (oid, record, targetStep) {
        var _this = this;
        return this.http.post(this.brandingAndPortalUrl + "/record/workflow/step/" + targetStep + "/" + oid, record, this.getOptionsClient())
            .toPromise()
            .then(function (res) { return _this.extractData(res); });
    };
    RecordsService.prototype.getDashboardUrl = function (recType) {
        if (recType === void 0) { recType = 'rdmp'; }
        return this.brandingAndPortalUrl + "/dashboard/" + recType;
    };
    RecordsService.prototype.modifyEditors = function (records, username, email) {
        var _this = this;
        return this.http.post(this.brandingAndPortalUrl + "/record/editors/modify", { records: records, username: username, email: email }, this.getOptionsClient())
            .toPromise()
            .then(function (res) { return _this.extractData(res); });
    };
    RecordsService.prototype.updateResponsibilities = function (records, role, email, name) {
        var _this = this;
        return this.http.post(this.brandingAndPortalUrl + "/record/responsibility/update", { records: records, role: role, email: email, name: name }, this.getOptionsClient())
            .toPromise()
            .then(function (res) { return _this.extractData(res); });
    };
    RecordsService.prototype.getTransferResponsibility = function (recordType) {
        var _this = this;
        return this.http.get(this.brandingAndPortalUrl + "/transferconfig/" + recordType, this.getOptionsClient())
            .toPromise()
            .then(function (res) { return _this.extractData(res); });
    };
    RecordsService.prototype.search = function (params) {
        var _this = this;
        var refinedSearchStr = '';
        params.filterActiveRefinersWithNoData();
        if (_.size(params.activeRefiners) > 0) {
            var exactSearchNames_1 = '';
            var exactSearchValues_1 = '';
            var facetSearchNames_1 = '';
            var facetSearchValues_1 = '';
            _.forEach(params.activeRefiners, function (refiner) {
                switch (refiner.type) {
                    case "exact":
                        exactSearchNames_1 = "" + (_.isEmpty(exactSearchNames_1) ? "&exactNames=" : exactSearchNames_1 + ",") + refiner.name;
                        exactSearchValues_1 = exactSearchValues_1 + "&exact_" + refiner.name + "=" + refiner.value;
                        break;
                    case "facet":
                        facetSearchNames_1 = "" + (_.isEmpty(facetSearchNames_1) ? "&facetNames=" : facetSearchNames_1 + ",") + refiner.name;
                        if (!_.isEmpty(refiner.activeValue)) {
                            facetSearchValues_1 = facetSearchValues_1 + "&facet_" + refiner.name + "=" + refiner.activeValue;
                        }
                        break;
                }
            });
            refinedSearchStr = "" + exactSearchNames_1 + exactSearchValues_1 + facetSearchNames_1 + facetSearchValues_1;
        }
        return this.http.get(this.brandingAndPortalUrl + "/record/search/" + params.recordType + "/?searchStr=" + params.basicSearch + refinedSearchStr, this.getOptionsClient())
            .toPromise()
            .then(function (res) { return _this.extractData(res); });
    };
    RecordsService.prototype.getType = function (name) {
        var _this = this;
        return this.http.get(this.brandingAndPortalUrl + "/record/type/" + name, this.getOptionsClient())
            .toPromise()
            .then(function (res) { return _this.extractData(res); });
    };
    RecordsService.prototype.getAllTypes = function () {
        var _this = this;
        return this.http.get(this.brandingAndPortalUrl + "/record/type/", this.getOptionsClient())
            .toPromise()
            .then(function (res) { return _this.extractData(res); });
    };
    RecordsService.prototype.getWorkflowSteps = function (name) {
        var _this = this;
        return this.http.get(this.brandingAndPortalUrl + "/record/wfSteps/" + name, this.getOptionsClient())
            .toPromise()
            .then(function (res) { return _this.extractData(res); });
    };
    RecordsService.prototype.getRecordMeta = function (oid) {
        var _this = this;
        if (oid === void 0) { oid = null; }
        return this.http.get(this.brandingAndPortalUrl + "/record/metadata/" + oid, this.options)
            .toPromise()
            .then(function (res) { return _this.extractData(res); });
    };
    RecordsService.prototype.executeAction = function (action, params) {
        var _this = this;
        return this.http.post(this.brandingAndPortalUrl + "/action/" + action, params, this.options)
            .toPromise()
            .then(function (res) { return _this.extractData(res); });
    };
    RecordsService = __decorate([
        core_1.Injectable(),
        __param(0, core_1.Inject(http_1.Http)),
        __param(1, core_1.Inject(field_control_meta_service_1.FieldControlMetaService)),
        __param(2, core_1.Inject(config_service_1.ConfigService)),
        __metadata("design:paramtypes", [http_1.Http,
            field_control_meta_service_1.FieldControlMetaService,
            config_service_1.ConfigService,
            core_1.ApplicationRef])
    ], RecordsService);
    return RecordsService;
}(base_service_1.BaseService));
exports.RecordsService = RecordsService;
var RecordActionResult = /** @class */ (function () {
    function RecordActionResult() {
    }
    return RecordActionResult;
}());
exports.RecordActionResult = RecordActionResult;
var RecordSearchRefiner = /** @class */ (function () {
    function RecordSearchRefiner(opts) {
        if (opts === void 0) { opts = {}; }
        this.name = opts.name;
        this.title = opts.title;
        this.type = opts.type;
        this.value = opts.value;
        this.typeLabel = opts.typeLabel;
        this.alwaysActive = opts.alwaysActive;
    }
    RecordSearchRefiner.prototype.setCurrentValue = function (value) {
        if (this.type == "facet") {
            this.activeValue = value;
        }
        else {
            this.value = value;
        }
    };
    return RecordSearchRefiner;
}());
exports.RecordSearchRefiner = RecordSearchRefiner;
var RecordSearchParams = /** @class */ (function () {
    function RecordSearchParams(recType) {
        this.recordType = recType;
        this.activeRefiners = [];
        this.clear();
    }
    RecordSearchParams.prototype.clear = function () {
        this.basicSearch = null;
        _.remove(this.activeRefiners, function (refiner) {
            refiner.value = null;
            refiner.activeValue = null;
            return !refiner.alwaysActive;
        });
    };
    RecordSearchParams.prototype.getRefinerConfig = function (name) {
        return _.find(this.refinerConfig, function (config) {
            return config.name == name;
        });
    };
    RecordSearchParams.prototype.setRefinerConfig = function (config) {
        var _this = this;
        this.refinerConfig = config;
        // parse through and activate those set as active...
        _.forEach(this.refinerConfig, function (refinerConfig) {
            if (refinerConfig.alwaysActive) {
                _this.addActiveRefiner(refinerConfig);
            }
        });
    };
    RecordSearchParams.prototype.getHttpQuery = function (searchUrl) {
        var refinerValues = '';
        _.forEach(this.activeRefiners, function (refiner) {
            if (refiner.type == "facet") {
                refinerValues = refinerValues + "&refiner|" + refiner.name + "=" + (_.isEmpty(refiner.activeValue) ? '' : refiner.activeValue);
            }
            else {
                refinerValues = refinerValues + "&refiner|" + refiner.name + "=" + (_.isEmpty(refiner.value) ? '' : refiner.value);
            }
        });
        return searchUrl + "?q=" + this.basicSearch + "&type=" + this.recordType + refinerValues;
    };
    RecordSearchParams.prototype.getRefinerConfigs = function () {
        return this.refinerConfig;
    };
    RecordSearchParams.prototype.addActiveRefiner = function (refiner) {
        var existingRefiner = _.find(this.activeRefiners, function (activeRefiner) {
            return activeRefiner.name == refiner.name;
        });
        if (existingRefiner) {
            existingRefiner.value = refiner.value;
        }
        else {
            this.activeRefiners.push(refiner);
        }
    };
    RecordSearchParams.prototype.parseQueryStr = function (queryStr) {
        var _this = this;
        queryStr = decodeURI(queryStr);
        var refinerValues = {};
        _.forEach(queryStr.split('&'), function (q) {
            var qObj = q.split('=');
            if (_.startsWith(qObj[0], "q")) {
                _this.basicSearch = qObj[1];
            }
            if (_.startsWith(qObj[0], "refiner|")) {
                var refinerName = qObj[0].split('|')[1];
                refinerValues[refinerName] = qObj[1];
            }
        });
        _.forOwn(refinerValues, function (value, name) {
            var config = _this.getRefinerConfig(name);
            config.setCurrentValue(value);
            _this.addActiveRefiner(config);
        });
    };
    RecordSearchParams.prototype.filterActiveRefinersWithNoData = function () {
        var removed = _.remove(this.activeRefiners, function (refiner) {
            var value = refiner.type == 'exact' ? refiner.value : refiner.activeValue;
            return !refiner.alwaysActive && (_.isEmpty(value) || _.isUndefined(value));
        });
    };
    RecordSearchParams.prototype.hasActiveRefiners = function () {
        var hasActive = false;
        _.forEach(this.activeRefiners, function (refiner) {
            if (!hasActive && (!_.isEmpty(refiner.value))) {
                hasActive = true;
            }
        });
        return hasActive;
    };
    RecordSearchParams.prototype.setFacetValues = function (facets) {
        var _this = this;
        _.forEach(facets, function (facet) {
            var refiner = _.find(_this.activeRefiners, function (refinerConfig) {
                return refinerConfig.name == facet.name;
            });
            if (refiner) {
                refiner.value = facet.values;
            }
        });
    };
    return RecordSearchParams;
}());
exports.RecordSearchParams = RecordSearchParams;


/***/ }),

/***/ "./redbox-portal/angular/shared/form/workflow-button.component.ts":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
Object.defineProperty(exports, "__esModule", { value: true });
var core_1 = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
var field_simple_component_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-simple.component.ts");
var field_simple_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-simple.ts");
var WorkflowStepButton = /** @class */ (function (_super) {
    __extends(WorkflowStepButton, _super);
    function WorkflowStepButton(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.targetStep = options['targetStep'] || null;
        return _this;
    }
    return WorkflowStepButton;
}(field_simple_1.AnchorOrButton));
exports.WorkflowStepButton = WorkflowStepButton;
// For workflow buttons
var WorkflowStepButtonComponent = /** @class */ (function (_super) {
    __extends(WorkflowStepButtonComponent, _super);
    function WorkflowStepButtonComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    WorkflowStepButtonComponent.prototype.gotoTargetStep = function (event) {
        return this.fieldMap._rootComp.stepTo(this.field.targetStep);
    };
    WorkflowStepButtonComponent = __decorate([
        core_1.Component({
            selector: 'workflowstep-button',
            template: "\n  <button type=\"{{field.type}}\" [ngClass]=\"field.cssClasses\" (click)=\"gotoTargetStep($event)\" [disabled]=\"isDisabled()\">{{field.label}}</button>\n  ",
        })
    ], WorkflowStepButtonComponent);
    return WorkflowStepButtonComponent;
}(field_simple_component_1.AnchorOrButtonComponent));
exports.WorkflowStepButtonComponent = WorkflowStepButtonComponent;


/***/ }),

/***/ "./redbox-portal/angular/shared/form/workspace-field.component.ts":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};
Object.defineProperty(exports, "__esModule", { value: true });
var core_1 = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
var field_base_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-base.ts");
var forms_1 = __webpack_require__("./node_modules/@angular/forms/esm5/forms.js");
var _ = __webpack_require__("./node_modules/lodash-es/lodash.js");
var workspace_service_1 = __webpack_require__("./redbox-portal/angular/shared/workspace-service.ts");
/**
 * Base component for a Workspace field.
 *
 * Author: <a href='https://github.com/moisbo' target='_blank'>moisbo</a>
 *
 */
var WorkspaceFieldComponent = /** @class */ (function () {
    /**
     * For DI'ing...
     */
    function WorkspaceFieldComponent(componentFactoryResolver, app) {
        this.componentFactoryResolver = componentFactoryResolver;
        this.app = app;
        this.disabledElements = [];
    }
    Object.defineProperty(WorkspaceFieldComponent.prototype, "isValid", {
        /**
         * If the form is valid.
         */
        get: function () {
            if (this.form && this.form.controls) {
                return this.form.controls[this.field.name].valid;
            }
            return false;
        },
        enumerable: true,
        configurable: true
    });
    /**
     *
     */
    WorkspaceFieldComponent.prototype.isDisabled = function () {
        var disabledExpression = this.field.options['disabledExpression'];
        if (disabledExpression != null) {
            var imports = this.fieldAnchor;
            var variables = {};
            variables['imports'] = this.fieldMap._rootComp;
            var compiled = _.template(disabledExpression, variables);
            var parentElement = jQuery(this.fieldElement.nativeElement.parentElement);
            if (compiled() == "true") {
                //take note of which elements where already disabled as we dont want to enable them if whole component becomes enabled again
                this.disabledElements = parentElement.find('*:disabled');
                parentElement.find('input').prop("disabled", true);
                return 'disabled';
            }
            else {
                if (jQuery(this.fieldElement.nativeElement).prop('disabled') == 'disabled') {
                    //previously disabled so lets re-enable
                    parentElement.find('input').prop("disabled", false);
                    _.each(this.disabledElements, function (disabledElement) { return disabledElement.prop("disabled", true); });
                }
                return null;
            }
        }
        return null;
    };
    /**
     * Change handler, instantiates the field component.
     */
    WorkspaceFieldComponent.prototype.ngOnChanges = function () {
        if (!this.field || !this.componentFactoryResolver) {
            return;
        }
        this.fieldAnchor.clear();
        var compFactory = this.componentFactoryResolver.resolveComponentFactory(this.field.compClass);
        var fieldCompRef = this.fieldAnchor.createComponent(compFactory, undefined, this.app['_injector']);
        fieldCompRef.instance.injector = this.app['_injector'];
        fieldCompRef.instance.field = this.field;
        fieldCompRef.instance.form = this.form;
        fieldCompRef.instance.fieldMap = this.fieldMap;
        fieldCompRef.instance.parentId = this.parentId;
        this.fieldMap[this.field.name].instance = fieldCompRef.instance;
    };
    __decorate([
        core_1.Input(),
        __metadata("design:type", field_base_1.FieldBase)
    ], WorkspaceFieldComponent.prototype, "field", void 0);
    __decorate([
        core_1.Input(),
        __metadata("design:type", forms_1.FormGroup)
    ], WorkspaceFieldComponent.prototype, "form", void 0);
    __decorate([
        core_1.Input(),
        __metadata("design:type", Object)
    ], WorkspaceFieldComponent.prototype, "value", void 0);
    __decorate([
        core_1.Input(),
        __metadata("design:type", Object)
    ], WorkspaceFieldComponent.prototype, "fieldMap", void 0);
    __decorate([
        core_1.ViewChild('field', { read: core_1.ViewContainerRef }),
        __metadata("design:type", core_1.ViewContainerRef)
    ], WorkspaceFieldComponent.prototype, "fieldAnchor", void 0);
    __decorate([
        core_1.Input(),
        __metadata("design:type", String)
    ], WorkspaceFieldComponent.prototype, "parentId", void 0);
    __decorate([
        core_1.ViewChild('field'),
        __metadata("design:type", Object)
    ], WorkspaceFieldComponent.prototype, "fieldElement", void 0);
    WorkspaceFieldComponent = __decorate([
        core_1.Component({
            selector: 'ws-field',
            template: '<span [attr.disabled]="isDisabled()" #field></span>'
        }),
        __param(0, core_1.Inject(core_1.ComponentFactoryResolver)),
        __metadata("design:paramtypes", [core_1.ComponentFactoryResolver, core_1.ApplicationRef])
    ], WorkspaceFieldComponent);
    return WorkspaceFieldComponent;
}());
exports.WorkspaceFieldComponent = WorkspaceFieldComponent;
var WorkspaceSelectorField = /** @class */ (function (_super) {
    __extends(WorkspaceSelectorField, _super);
    function WorkspaceSelectorField(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.workspaceApps = [];
        _this.workspaceTypeService = _this.getFromInjector(workspace_service_1.WorkspaceTypeService);
        _this.open = _this.getTranslated(options['open'], options['open']);
        _this.saveFirst = _this.getTranslated(options['saveFirst'], options['saveFirst']);
        _this.rdmp = undefined;
        // this.options = options['options'] || [];
        _this.workspaceApps = _.map(options['defaultSelection'] || [], function (option) {
            option['label'] = _this.getTranslated(option['label'], option['label']);
            option['name'] = '';
            return option;
        });
        _this.appLink = _this.workspaceTypeService.getBrand() + '/record/';
        _this.workspaceTypeService.getWorkspaceTypes().then(function (response) {
            if (response['status']) {
                //append results from database into workspaceApps
                _this.workspaceApps = _.concat(_this.workspaceApps, response['workspaceTypes']);
            }
            else {
                throw new Error('cannot get workspaces');
            }
        }).catch(function (error) {
            console.log(error);
        });
        return _this;
    }
    WorkspaceSelectorField.prototype.init = function () {
        this.rdmp = this.fieldMap._rootComp.oid || undefined;
    };
    WorkspaceSelectorField.prototype.registerEvents = function () {
        this.fieldMap._rootComp.recordCreated.subscribe(this.setOid.bind(this));
        this.fieldMap._rootComp.recordSaved.subscribe(this.setOid.bind(this));
    };
    WorkspaceSelectorField.prototype.setOid = function (o) {
        this.rdmp = o.oid;
    };
    WorkspaceSelectorField.prototype.loadWorkspaceDetails = function (value) {
        //GET me the value from the database
        if (!value) {
            this.workspaceApp = null;
        }
        else {
            this.workspaceApp = _.find(this.workspaceApps, function (w) {
                return w['name'] == value;
            });
        }
    };
    WorkspaceSelectorField.prototype.createFormModel = function () {
        var _this = this;
        if (this.controlType == 'checkbox') {
            var fgDef_1 = [];
            _.map(this.options, function (opt) {
                var hasValue = _.find(_this.value, function (val) {
                    return val == opt.value;
                });
                if (hasValue) {
                    fgDef_1.push(new forms_1.FormControl(opt.value));
                }
            });
            // const fg = new FormArray(fgDef);
            // return fg;
            return new forms_1.FormArray(fgDef_1);
        }
        else {
            // const model = super.createFormModel();
            // console.log(`Created form model:`);
            // console.log(model);
            // return model;
            return _super.prototype.createFormModel.call(this);
        }
    };
    return WorkspaceSelectorField;
}(field_base_1.FieldBase));
exports.WorkspaceSelectorField = WorkspaceSelectorField;


/***/ }),

/***/ "./redbox-portal/angular/shared/form/workspace-selector.component.ts":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
Object.defineProperty(exports, "__esModule", { value: true });
var core_1 = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
var field_simple_component_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-simple.component.ts");
var _ = __webpack_require__("./node_modules/lodash-es/lodash.js");
var WorkspaceSelectorComponent = /** @class */ (function (_super) {
    __extends(WorkspaceSelectorComponent, _super);
    function WorkspaceSelectorComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    WorkspaceSelectorComponent.prototype.getLabel = function (val) {
        var opt = _.find(this.field.options, function (opt) {
            return opt.value == val;
        });
        if (opt) {
            return opt.label;
        }
        else {
            return '';
        }
    };
    WorkspaceSelectorComponent.clName = 'WorkspaceSelectorComponent';
    WorkspaceSelectorComponent = __decorate([
        core_1.Component({
            selector: 'workspace-selector-parent',
            template: ''
        })
    ], WorkspaceSelectorComponent);
    return WorkspaceSelectorComponent;
}(field_simple_component_1.SimpleComponent));
exports.WorkspaceSelectorComponent = WorkspaceSelectorComponent;
var WorkspaceSelectorFieldComponent = /** @class */ (function (_super) {
    __extends(WorkspaceSelectorFieldComponent, _super);
    function WorkspaceSelectorFieldComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    WorkspaceSelectorFieldComponent.prototype.ngOnInit = function () {
        this.field.init();
        this.field.registerEvents();
    };
    WorkspaceSelectorFieldComponent.clName = 'WorkspaceSelectorFieldComponent';
    WorkspaceSelectorFieldComponent = __decorate([
        core_1.Component({
            selector: 'workspace-selector',
            template: "\n  <div [formGroup]='form' *ngIf=\"field.editMode\" [ngClass]=\"getGroupClass()\">\n  <label [attr.for]=\"field.name\">\n    {{field.label}} {{ getRequiredLabelStr()}}\n    <button type=\"button\" class=\"btn btn-default\" *ngIf=\"field.help\" (click)=\"toggleHelp()\"><span\n      class=\"glyphicon glyphicon-question-sign\" aria-hidden=\"true\"></span></button>\n  </label>\n  <br/>\n  <span id=\"{{ 'helpBlock_' + field.name }}\" class=\"help-block\" *ngIf=\"this.helpShow\" [innerHtml]=\"field.help\"></span>\n  <select [formControl]=\"getFormControl()\" [ngClass]=\"field.cssClasses\"\n          (change)=\"field.loadWorkspaceDetails($event.target.value)\">\n    <option *ngFor=\"let opt of field.workspaceApps; let i = index\"\n     [ngValue]=\"opt\" [selected]=\"i == 0\"\n     [value]=\"opt.name\">{{opt.label}}\n    </option>\n  </select>\n  <div class=\"text-danger\"\n       *ngIf=\"getFormControl().hasError('required') && getFormControl().touched && !field.validationMessages?.required\">\n    {{field.label}} is required\n  </div>\n  <div class=\"text-danger\"\n       *ngIf=\"getFormControl().hasError('required') && getFormControl().touched && field.validationMessages?.required\">\n    {{field.validationMessages.required}}\n  </div>\n  <br/><br/><br/>\n  <div class=\"row\">\n    <div *ngIf=\"field.workspaceApp\" class=\"panel panel-default\">\n      <div class=\"panel-heading\">\n        <h4 class=\"panel-title\">{{ field.workspaceApp.name | uppercase }}</h4>\n      </div>\n      <div class=\"panel-body\">\n        <div class=\"row\">\n          <div class=\"col-md-8 col-sm-8 col-xs-8 col-lg-8\">\n            <h5>{{ field.workspaceApp.subtitle }}</h5>\n            <p>{{ field.workspaceApp.description }}</p>\n            <span *ngIf=\"field.rdmp\">\n              <a href=\"{{ field.appLink + field.workspaceApp.name + '/edit?rdmp=' + field.rdmp }}\" class=\"btn btn-primary\">{{ field.open }}</a>\n            </span>\n            <span *ngIf=\"!field.rdmp\">\n              <a disabled href=\"#\" class=\"btn btn-default\">{{ field.saveFirst }}</a>\n            </span>\n          </div>\n          <div class=\"col-md-4 col-sm-4 col-xs-4 col-lg-4\">\n            <img src=\"{{ field.workspaceApp.logo }}\" alt=\"{{field.workspaceApp.name}}\">\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n  ",
        })
    ], WorkspaceSelectorFieldComponent);
    return WorkspaceSelectorFieldComponent;
}(WorkspaceSelectorComponent));
exports.WorkspaceSelectorFieldComponent = WorkspaceSelectorFieldComponent;


/***/ }),

/***/ "./redbox-portal/angular/shared/loadable.component.ts":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
/**
 * Convenience class to wrap JQuery calls ...
 *
 * Author: <a href='https://github.com/shilob' target='_blank'>Shilo Banihit</a>
 *
 */
var LoadableComponent = /** @class */ (function () {
    function LoadableComponent() {
        this.spinnerElem = "<i class=\"fa fa-spinner fa-pulse fa-1x fa-fw\"></i>";
        this.isLoading = true;
        this.synchLoading();
    }
    LoadableComponent.prototype.initTranslator = function (translationService) {
        var _this = this;
        this.translationService = translationService;
        translationService.isReady(function (tService) {
            _this.translatorReady = true;
        });
    };
    LoadableComponent.prototype.translatorLoaded = function () {
        this.translatorReady = true;
        this.checkIfHasLoaded();
    };
    LoadableComponent.prototype.checkIfHasLoaded = function () {
        if (this.hasLoaded()) {
            this.setLoading(false);
        }
    };
    LoadableComponent.prototype.hasLoaded = function () {
        return this.isLoading && (this.translationService ? this.translatorReady : true);
    };
    LoadableComponent.prototype.setLoading = function (loading) {
        if (loading === void 0) { loading = true; }
        this.isLoading = loading;
        this.synchLoading();
    };
    LoadableComponent.prototype.synchLoading = function () {
        if (this.isLoading) {
            jQuery("#loading").show();
        }
        else {
            jQuery("#loading").hide();
        }
    };
    return LoadableComponent;
}());
exports.LoadableComponent = LoadableComponent;


/***/ }),

/***/ "./redbox-portal/angular/shared/roles-service.ts":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

// Copyright (c) 2017 Queensland Cyber Infrastructure Foundation (http://www.qcif.edu.au/)
//
// GNU GENERAL PUBLIC LICENSE
//    Version 2, June 1991
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation; either version 2 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this program; if not, write to the Free Software Foundation, Inc.,
// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};
Object.defineProperty(exports, "__esModule", { value: true });
var core_1 = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
var http_1 = __webpack_require__("./node_modules/@angular/http/esm5/http.js");
__webpack_require__("./node_modules/rxjs/_esm5/add/operator/map.js");
__webpack_require__("./node_modules/rxjs/_esm5/add/operator/toPromise.js");
var base_service_1 = __webpack_require__("./redbox-portal/angular/shared/base-service.ts");
var config_service_1 = __webpack_require__("./redbox-portal/angular/shared/config-service.ts");
/**
 * Role related service
 *
 * Author: <a href='https://github.com/shilob' target='_blank'>Shilo Banihit</a>
 */
var RolesService = /** @class */ (function (_super) {
    __extends(RolesService, _super);
    function RolesService(http, configService) {
        var _this = _super.call(this, http, configService) || this;
        _this.configService = configService;
        return _this;
    }
    RolesService.prototype.getBrandRoles = function () {
        var _this = this;
        return this.http.get(this.brandingAndPortalUrl + "/admin/roles/get", this.options)
            .toPromise()
            .then(function (res) { return _this.extractData(res); });
    };
    RolesService.prototype.updateUserRoles = function (userid, roleIds) {
        var _this = this;
        return this.http.post(this.brandingAndPortalUrl + "/admin/roles/user", { userid: userid, roles: roleIds }, this.options)
            .toPromise()
            .then(function (res) { return _this.extractData(res); });
    };
    RolesService = __decorate([
        core_1.Injectable(),
        __param(0, core_1.Inject(http_1.Http)), __param(1, core_1.Inject(config_service_1.ConfigService)),
        __metadata("design:paramtypes", [http_1.Http, config_service_1.ConfigService])
    ], RolesService);
    return RolesService;
}(base_service_1.BaseService));
exports.RolesService = RolesService;


/***/ }),

/***/ "./redbox-portal/angular/shared/shared.module.ts":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
Object.defineProperty(exports, "__esModule", { value: true });
var core_1 = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
var angular2_markdown_1 = __webpack_require__("./node_modules/angular2-markdown/index.js");
var forms_1 = __webpack_require__("./node_modules/@angular/forms/esm5/forms.js");
var platform_browser_1 = __webpack_require__("./node_modules/@angular/platform-browser/esm5/platform-browser.js");
var records_service_1 = __webpack_require__("./redbox-portal/angular/shared/form/records.service.ts");
var field_control_service_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-control.service.ts");
var field_textfield_component_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-textfield.component.ts");
var field_simple_component_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-simple.component.ts");
var record_meta_component_1 = __webpack_require__("./redbox-portal/angular/shared/form/record-meta.component.ts");
var field_vocab_component_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-vocab.component.ts");
var field_repeatable_component_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-repeatable.component.ts");
var field_contributor_component_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-contributor.component.ts");
var field_relatedobjectdata_component_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-relatedobjectdata.component.ts");
var field_relatedobjectselector_component_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-relatedobjectselector.component.ts");
var field_datalocation_component_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-datalocation.component.ts");
var field_publishdatalocationselector_component_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-publishdatalocationselector.component.ts");
var field_andsvocab_component_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-andsvocab.component.ts");
var field_map_component_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-map.component.ts");
var workflow_button_component_1 = __webpack_require__("./redbox-portal/angular/shared/form/workflow-button.component.ts");
var action_button_component_1 = __webpack_require__("./redbox-portal/angular/shared/form/action-button.component.ts");
var config_service_1 = __webpack_require__("./redbox-portal/angular/shared/config-service.ts");
var translation_service_1 = __webpack_require__("./redbox-portal/angular/shared/translation-service.ts");
var ng2_datetime_1 = __webpack_require__("./node_modules/ng2-datetime/ng2-datetime.ts");
var ng2_completer_1 = __webpack_require__("./node_modules/ng2-completer/index.js");
var ngx_i18next_1 = __webpack_require__("./node_modules/ngx-i18next/index.js");
var ngx_leaflet_1 = __webpack_require__("./node_modules/@asymmetrik/ngx-leaflet/dist/index.js");
var ngx_leaflet_draw_1 = __webpack_require__("./node_modules/@asymmetrik/ngx-leaflet-draw/dist/index.js");
var ng2_tree_1 = __webpack_require__("./node_modules/ng2-tree/index.js");
var dmp_field_component_1 = __webpack_require__("./redbox-portal/angular/shared/form/dmp-field.component.ts");
var user_service_simple_1 = __webpack_require__("./redbox-portal/angular/shared/user.service-simple.ts");
var dashboard_service_1 = __webpack_require__("./redbox-portal/angular/shared/dashboard-service.ts");
var ands_service_1 = __webpack_require__("./redbox-portal/angular/shared/ands-service.ts");
var StringTemplatePipe_1 = __webpack_require__("./redbox-portal/angular/shared/StringTemplatePipe.ts");
var roles_service_1 = __webpack_require__("./redbox-portal/angular/shared/roles-service.ts");
var util_service_1 = __webpack_require__("./redbox-portal/angular/shared/util-service.ts");
var email_service_1 = __webpack_require__("./redbox-portal/angular/shared/email-service.ts");
var field_group_component_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-group.component.ts");
var workspace_selector_component_1 = __webpack_require__("./redbox-portal/angular/shared/form/workspace-selector.component.ts");
var workspace_service_1 = __webpack_require__("./redbox-portal/angular/shared/workspace-service.ts");
var workspace_field_component_1 = __webpack_require__("./redbox-portal/angular/shared/form/workspace-field.component.ts");
var workspace_selector_component_2 = __webpack_require__("./redbox-portal/angular/shared/form/workspace-selector.component.ts");
var field_control_meta_service_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-control-meta.service.ts");
var SharedModule = /** @class */ (function () {
    function SharedModule() {
    }
    SharedModule = __decorate([
        core_1.NgModule({
            imports: [platform_browser_1.BrowserModule, forms_1.FormsModule, forms_1.ReactiveFormsModule, ng2_datetime_1.NKDatetimeModule, ng2_completer_1.Ng2CompleterModule, ngx_i18next_1.TranslateI18NextModule, ngx_leaflet_1.LeafletModule.forRoot(), ngx_leaflet_draw_1.LeafletDrawModule.forRoot(), angular2_markdown_1.MarkdownModule.forRoot(), ng2_tree_1.TreeModule],
            exports: [ng2_datetime_1.NKDatetimeModule, ng2_completer_1.Ng2CompleterModule, ngx_i18next_1.TranslateI18NextModule, dmp_field_component_1.DmpFieldComponent, field_textfield_component_1.TextFieldComponent, field_simple_component_1.DropdownFieldComponent, field_simple_component_1.TabOrAccordionContainerComponent, field_simple_component_1.ButtonBarContainerComponent, field_simple_component_1.TextBlockComponent, field_textfield_component_1.MarkdownTextAreaComponent, field_textfield_component_1.TextAreaComponent, field_simple_component_1.DateTimeComponent, field_simple_component_1.AnchorOrButtonComponent, field_vocab_component_1.VocabFieldComponent, field_repeatable_component_1.RepeatableVocabComponent, field_contributor_component_1.ContributorComponent, field_repeatable_component_1.RepeatableContributorComponent, field_simple_component_1.HtmlRawComponent, field_simple_component_1.HiddenValueComponent, workflow_button_component_1.WorkflowStepButtonComponent, action_button_component_1.ActionButtonComponent, field_simple_component_1.LinkValueComponent, field_simple_component_1.SelectionFieldComponent, field_textfield_component_1.RepeatableTextfieldComponent, StringTemplatePipe_1.StringTemplatePipe, field_group_component_1.GenericGroupComponent, field_group_component_1.RepeatableGroupComponent, field_map_component_1.MapComponent, field_simple_component_1.ParameterRetrieverComponent, record_meta_component_1.RecordMetadataRetrieverComponent, field_relatedobjectselector_component_1.RelatedObjectSelectorComponent, field_datalocation_component_1.DataLocationComponent, field_publishdatalocationselector_component_1.PublishDataLocationSelectorComponent, workspace_selector_component_1.WorkspaceSelectorFieldComponent, field_simple_component_1.TabNavButtonComponent, field_simple_component_1.SpacerComponent, workspace_field_component_1.WorkspaceFieldComponent, workspace_selector_component_2.WorkspaceSelectorComponent, field_andsvocab_component_1.ANDSVocabComponent],
            declarations: [dmp_field_component_1.DmpFieldComponent, field_textfield_component_1.TextFieldComponent, field_simple_component_1.DropdownFieldComponent, field_simple_component_1.TabOrAccordionContainerComponent, field_simple_component_1.ButtonBarContainerComponent, field_simple_component_1.TextBlockComponent, field_textfield_component_1.MarkdownTextAreaComponent, field_textfield_component_1.TextAreaComponent, field_simple_component_1.DateTimeComponent, field_simple_component_1.AnchorOrButtonComponent, field_simple_component_1.SaveButtonComponent, field_simple_component_1.CancelButtonComponent, field_vocab_component_1.VocabFieldComponent, field_repeatable_component_1.RepeatableVocabComponent, field_contributor_component_1.ContributorComponent, field_repeatable_component_1.RepeatableContributorComponent, field_simple_component_1.HtmlRawComponent, field_simple_component_1.HiddenValueComponent, workflow_button_component_1.WorkflowStepButtonComponent, action_button_component_1.ActionButtonComponent, field_simple_component_1.LinkValueComponent, field_simple_component_1.SelectionFieldComponent, field_textfield_component_1.RepeatableTextfieldComponent, field_relatedobjectdata_component_1.RelatedObjectDataComponent, StringTemplatePipe_1.StringTemplatePipe, field_group_component_1.GenericGroupComponent, field_group_component_1.RepeatableGroupComponent, field_map_component_1.MapComponent, field_simple_component_1.ParameterRetrieverComponent, record_meta_component_1.RecordMetadataRetrieverComponent, field_relatedobjectselector_component_1.RelatedObjectSelectorComponent, field_datalocation_component_1.DataLocationComponent, field_publishdatalocationselector_component_1.PublishDataLocationSelectorComponent, workspace_selector_component_1.WorkspaceSelectorFieldComponent, field_simple_component_1.TabNavButtonComponent, field_simple_component_1.SpacerComponent, workspace_field_component_1.WorkspaceFieldComponent, workspace_selector_component_2.WorkspaceSelectorComponent, field_andsvocab_component_1.ANDSVocabComponent],
            providers: [field_control_service_1.FieldControlService, records_service_1.RecordsService, field_vocab_component_1.VocabFieldLookupService, config_service_1.ConfigService, translation_service_1.TranslationService, user_service_simple_1.UserSimpleService, dashboard_service_1.DashboardService, roles_service_1.RolesService, email_service_1.EmailNotificationService, util_service_1.UtilityService, workspace_service_1.WorkspaceTypeService, field_control_meta_service_1.FieldControlMetaService, ands_service_1.ANDSService],
            bootstrap: [],
            entryComponents: [dmp_field_component_1.DmpFieldComponent, field_textfield_component_1.TextFieldComponent, field_simple_component_1.DropdownFieldComponent, field_simple_component_1.TabOrAccordionContainerComponent, field_simple_component_1.ButtonBarContainerComponent, field_simple_component_1.TextBlockComponent, field_textfield_component_1.MarkdownTextAreaComponent, field_textfield_component_1.TextAreaComponent, field_simple_component_1.DateTimeComponent, field_simple_component_1.AnchorOrButtonComponent, field_simple_component_1.SaveButtonComponent, field_simple_component_1.CancelButtonComponent, field_vocab_component_1.VocabFieldComponent, field_repeatable_component_1.RepeatableVocabComponent, field_contributor_component_1.ContributorComponent, field_repeatable_component_1.RepeatableContributorComponent, field_simple_component_1.HtmlRawComponent, field_simple_component_1.HiddenValueComponent, workflow_button_component_1.WorkflowStepButtonComponent, action_button_component_1.ActionButtonComponent, field_simple_component_1.LinkValueComponent, field_simple_component_1.SelectionFieldComponent, field_textfield_component_1.RepeatableTextfieldComponent, field_relatedobjectdata_component_1.RelatedObjectDataComponent, field_group_component_1.GenericGroupComponent, field_group_component_1.RepeatableGroupComponent, field_map_component_1.MapComponent, field_simple_component_1.ParameterRetrieverComponent, record_meta_component_1.RecordMetadataRetrieverComponent, field_relatedobjectselector_component_1.RelatedObjectSelectorComponent, field_datalocation_component_1.DataLocationComponent, field_publishdatalocationselector_component_1.PublishDataLocationSelectorComponent, workspace_selector_component_1.WorkspaceSelectorFieldComponent, field_simple_component_1.TabNavButtonComponent, field_simple_component_1.SpacerComponent, workspace_field_component_1.WorkspaceFieldComponent, workspace_selector_component_2.WorkspaceSelectorComponent, field_andsvocab_component_1.ANDSVocabComponent]
        })
    ], SharedModule);
    return SharedModule;
}());
exports.SharedModule = SharedModule;


/***/ }),

/***/ "./redbox-portal/angular/shared/translation-service.ts":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

// Copyright (c) 2017 Queensland Cyber Infrastructure Foundation (http://www.qcif.edu.au/)
//
// GNU GENERAL PUBLIC LICENSE
//    Version 2, June 1991
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation; either version 2 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this program; if not, write to the Free Software Foundation, Inc.,
// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
Object.defineProperty(exports, "__esModule", { value: true });
var core_1 = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
var ngx_i18next_1 = __webpack_require__("./node_modules/ngx-i18next/index.js");
var Subject_1 = __webpack_require__("./node_modules/rxjs/_esm5/Subject.js");
var config_service_1 = __webpack_require__("./redbox-portal/angular/shared/config-service.ts");
/**
 * Translation service...
 *
 * Author: <a href='https://github.com/shilob' target='_blank'>Shilo Banihit</a>
 *
 */
var TranslationService = /** @class */ (function () {
    function TranslationService(translateI18Next, configService) {
        this.translateI18Next = translateI18Next;
        this.configService = configService;
        this.subjects = {};
        this.initTranslator();
    }
    TranslationService.prototype.initTranslator = function () {
        var _this = this;
        this.subjects['init'] = new Subject_1.Subject();
        this.configService.getConfig(function (config) {
            _this.config = config;
            _this.translateI18Next.init({
                debug: true,
                returnNull: false,
                returnEmptyString: true,
                // mapping: {"specific_backend_message": "message_for_translate"},     // optional
                // browserLanguageDetector: injectableCustomLanguageDetectorService,   // optional - the specific application language detector (allows you to return the language of the user.
                //                                                                     //            If it is absent, the service uses default "angular2 locale detector" behaviour using LOCALE_ID.
                // // supportedLanguages: ['en', 'pt'],                                //            Therefore you can pass the optional supportedLanguages parameter which indicates your supported languages.
                //                                                                     //            For example, LOCALE_ID = 'en-AU' or 'en-US' or 'en', you can pass only ['en'] -> locales/en/translation.json
                //                                                                     //                         LOCALE_ID = 'pt-BR' or 'pt', you can pass only ['pt'] -> locales/pt/translation.json
                // backend: injectableBackendConfigFactory                             // optional - allows to change "loadPath" i18next parameter
                lng: 'en',
                fallbackLng: 'en',
                backend: { loadPath: "/locales/{{lng}}/{{ns}}.json?v=" + config.translationVersion }
            }).then(function () {
                console.log("Translator loaded...");
                _this.translatorReady = true;
                _this.translatorLoaded();
            });
        });
    };
    TranslationService.prototype.translatorLoaded = function () {
        if (this.translatorReady) {
            this.subjects['init'].next(this);
        }
    };
    TranslationService.prototype.isReady = function (handler) {
        var subs = this.subjects['init'].subscribe(handler);
        this.translatorLoaded();
        return subs;
    };
    TranslationService.prototype.t = function (key) {
        return this.translateI18Next.translate(key);
    };
    TranslationService = __decorate([
        core_1.Injectable(),
        __metadata("design:paramtypes", [ngx_i18next_1.TranslateI18Next, config_service_1.ConfigService])
    ], TranslationService);
    return TranslationService;
}());
exports.TranslationService = TranslationService;


/***/ }),

/***/ "./redbox-portal/angular/shared/user.service-simple.ts":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

// Copyright (c) 2017 Queensland Cyber Infrastructure Foundation (http://www.qcif.edu.au/)
//
// GNU GENERAL PUBLIC LICENSE
//    Version 2, June 1991
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation; either version 2 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this program; if not, write to the Free Software Foundation, Inc.,
// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};
Object.defineProperty(exports, "__esModule", { value: true });
var core_1 = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
var http_1 = __webpack_require__("./node_modules/@angular/http/esm5/http.js");
__webpack_require__("./node_modules/rxjs/_esm5/add/operator/map.js");
__webpack_require__("./node_modules/rxjs/_esm5/add/operator/toPromise.js");
var base_service_1 = __webpack_require__("./redbox-portal/angular/shared/base-service.ts");
var config_service_1 = __webpack_require__("./redbox-portal/angular/shared/config-service.ts");
/**
 * User related service...
 *
 * Author: <a href='https://github.com/shilob' target='_blank'>Shilo Banihit</a>
 *
 */
var UserSimpleService = /** @class */ (function (_super) {
    __extends(UserSimpleService, _super);
    function UserSimpleService(http, configService) {
        var _this = _super.call(this, http, configService) || this;
        _this.configService = configService;
        return _this;
    }
    UserSimpleService.prototype.getInfo = function () {
        var _this = this;
        return this.http.get(this.baseUrl + "/user/info")
            .toPromise()
            .then(function (res) { return _this.extractData(res, 'user'); });
    };
    UserSimpleService.prototype.loginLocal = function (username, password) {
        console.log("Loggin in locally using brand: " + this.config.branding + ", portal: " + this.config.portal);
        return this.http.post(this.baseUrl + "/user/login_local", { username: username, password: password, branding: this.config.branding, portal: this.config.portal }, this.getOptionsClient())
            .toPromise()
            .then(this.extractData);
    };
    UserSimpleService.prototype.getUsers = function () {
        var _this = this;
        return this.http.get(this.brandingAndPortalUrl + "/admin/users/get", this.options)
            .toPromise()
            .then(function (res) { return _this.extractData(res); });
    };
    UserSimpleService.prototype.updateUserDetails = function (userid, details) {
        var _this = this;
        return this.http.post(this.brandingAndPortalUrl + "/admin/users/update", { userid: userid, details: details }, this.options)
            .toPromise()
            .then(function (res) { return _this.extractData(res); });
    };
    UserSimpleService.prototype.addLocalUser = function (username, details) {
        var _this = this;
        return this.http.post(this.brandingAndPortalUrl + "/admin/users/newUser", { username: username, details: details }, this.options)
            .toPromise()
            .then(function (res) { return _this.extractData(res); });
    };
    UserSimpleService.prototype.genKey = function (userid) {
        var _this = this;
        return this.http.post(this.brandingAndPortalUrl + "/admin/users/genKey", { userid: userid }, this.options)
            .toPromise()
            .then(function (res) { return _this.extractData(res); });
    };
    UserSimpleService.prototype.revokeKey = function (userid) {
        var _this = this;
        return this.http.post(this.brandingAndPortalUrl + "/admin/users/revokeKey", { userid: userid }, this.options)
            .toPromise()
            .then(function (res) { return _this.extractData(res); });
    };
    UserSimpleService.prototype.updateUserProfile = function (details) {
        var _this = this;
        return this.http.post(this.brandingAndPortalUrl + "/user/update", { details: details }, this.options)
            .toPromise()
            .then(function (res) { return _this.extractData(res); });
    };
    UserSimpleService.prototype.genUserKey = function () {
        var _this = this;
        return this.http.post(this.brandingAndPortalUrl + "/user/genKey", {}, this.options)
            .toPromise()
            .then(function (res) { return _this.extractData(res); });
    };
    UserSimpleService.prototype.revokeUserKey = function () {
        var _this = this;
        return this.http.post(this.brandingAndPortalUrl + "/user/revokeKey", {}, this.options)
            .toPromise()
            .then(function (res) { return _this.extractData(res); });
    };
    UserSimpleService = __decorate([
        core_1.Injectable(),
        __param(0, core_1.Inject(http_1.Http)), __param(1, core_1.Inject(config_service_1.ConfigService)),
        __metadata("design:paramtypes", [http_1.Http, config_service_1.ConfigService])
    ], UserSimpleService);
    return UserSimpleService;
}(base_service_1.BaseService));
exports.UserSimpleService = UserSimpleService;


/***/ }),

/***/ "./redbox-portal/angular/shared/util-service.ts":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

// Copyright (c) 2017 Queensland Cyber Infrastructure Foundation (http://www.qcif.edu.au/)
//
// GNU GENERAL PUBLIC LICENSE
//    Version 2, June 1991
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation; either version 2 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this program; if not, write to the Free Software Foundation, Inc.,
// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
Object.defineProperty(exports, "__esModule", { value: true });
var core_1 = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
var _ = __webpack_require__("./node_modules/lodash-es/lodash.js");
/**
 * Utility service...
 *
 * Author: <a href='https://github.com/shilob' target='_blank'>Shilo Banihit</a>
 *
 */
var UtilityService = /** @class */ (function () {
    function UtilityService() {
    }
    /**
     * returns concatenated string
     *
     * Author: <a href='https://github.com/shilob' target='_blank'>Shilo Banihit</a>
     * @param  {any} config
     * @return {string}
     */
    UtilityService.prototype.concatenate = function (data, config) {
        var result = '';
        _.each(config.fields, function (f) {
            if (_.isArray(data)) {
                result = [];
                var itemResult_1 = '';
                _.each(data, function (d) {
                    var fldData = _.get(d, f);
                    // checking if field has data, otherwise will be skipping concat
                    if (fldData) {
                        itemResult_1 = "" + itemResult_1 + (_.isEmpty(itemResult_1) ? '' : config.delim) + fldData;
                    }
                });
                result.push(itemResult_1);
            }
            else {
                var fldData = _.get(data, f);
                if (fldData) {
                    result = "" + result + (_.isEmpty(result) ? '' : config.delim) + fldData;
                }
            }
        });
        return result;
    };
    /**
     * returns a property from the provided object.
     *
     * Author: <a href='https://github.com/andrewbrazzatti' target='_blank'>Andrew Brazzatti</a>
     * @param  {any} config
     * @return {string}
     */
    UtilityService.prototype.getPropertyFromObject = function (data, config) {
        var fieldPath = config.field;
        return _.get(data, fieldPath);
    };
    UtilityService = __decorate([
        core_1.Injectable()
    ], UtilityService);
    return UtilityService;
}());
exports.UtilityService = UtilityService;


/***/ }),

/***/ "./redbox-portal/angular/shared/workspace-service.ts":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

// Copyright (c) 2017 Queensland Cyber Infrastructure Foundation (http://www.qcif.edu.au/)
//
// GNU GENERAL PUBLIC LICENSE
//    Version 2, June 1991
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation; either version 2 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this program; if not, write to the Free Software Foundation, Inc.,
// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};
Object.defineProperty(exports, "__esModule", { value: true });
var core_1 = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
var http_1 = __webpack_require__("./node_modules/@angular/http/esm5/http.js");
__webpack_require__("./node_modules/rxjs/_esm5/add/operator/map.js");
__webpack_require__("./node_modules/rxjs/_esm5/add/operator/toPromise.js");
var base_service_1 = __webpack_require__("./redbox-portal/angular/shared/base-service.ts");
var config_service_1 = __webpack_require__("./redbox-portal/angular/shared/config-service.ts");
/**
 * Role related service
 *
 * Author: <a href='https://github.com/moisbo' target='_blank'>moisbo</a>
 */
var WorkspaceTypeService = /** @class */ (function (_super) {
    __extends(WorkspaceTypeService, _super);
    function WorkspaceTypeService(http, configService) {
        var _this = _super.call(this, http, configService) || this;
        _this.configService = configService;
        return _this;
    }
    WorkspaceTypeService.prototype.getBrand = function () {
        return this.brandingAndPortalUrl;
    };
    WorkspaceTypeService.prototype.getWorkspaceTypes = function () {
        var _this = this;
        return this.http.get(this.brandingAndPortalUrl + "/workspace/types", this.options)
            .toPromise()
            .then(function (res) { return _this.extractData(res); });
    };
    WorkspaceTypeService.prototype.getWorkspaceType = function (name) {
        var _this = this;
        return this.http.get(this.brandingAndPortalUrl + "/workspace/types/" + name, this.options)
            .toPromise()
            .then(function (res) { return _this.extractData(res); });
    };
    WorkspaceTypeService = __decorate([
        core_1.Injectable(),
        __param(0, core_1.Inject(http_1.Http)), __param(1, core_1.Inject(config_service_1.ConfigService)),
        __metadata("design:paramtypes", [http_1.Http, config_service_1.ConfigService])
    ], WorkspaceTypeService);
    return WorkspaceTypeService;
}(base_service_1.BaseService));
exports.WorkspaceTypeService = WorkspaceTypeService;


/***/ }),

/***/ "./src/$$_lazy_route_resource lazy recursive":
/***/ (function(module, exports) {

function webpackEmptyAsyncContext(req) {
	// Here Promise.resolve().then() is used instead of new Promise() to prevent
	// uncatched exception popping up in devtools
	return Promise.resolve().then(function() {
		throw new Error("Cannot find module '" + req + "'.");
	});
}
webpackEmptyAsyncContext.keys = function() { return []; };
webpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;
module.exports = webpackEmptyAsyncContext;
webpackEmptyAsyncContext.id = "./src/$$_lazy_route_resource lazy recursive";

/***/ }),

/***/ "./src/app/components/create-workspace.component.ts":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
Object.defineProperty(exports, "__esModule", { value: true });
var core_1 = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
var field_simple_component_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-simple.component.ts");
var field_base_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-base.ts");
var forms_1 = __webpack_require__("./node_modules/@angular/forms/esm5/forms.js");
var omero_service_1 = __webpack_require__("./src/app/omero.service.ts");
var shared_1 = __webpack_require__("./src/app/components/shared.ts");
/**
 * Contributor Model
 *
 * @author <a target='_' href='https://github.com/moisbo'>moisbo</a>
 *
 */
var CreateWorkspaceField = /** @class */ (function (_super) {
    __extends(CreateWorkspaceField, _super);
    function CreateWorkspaceField(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.processing = false;
        _this.listWorkspaces = new core_1.EventEmitter();
        _this.omeroService = _this.getFromInjector(omero_service_1.OMEROService);
        _this.checks = new shared_1.Checks();
        _this.currentWorkspace = new shared_1.CurrentWorkspace();
        _this.workspaceUser = new shared_1.WorkspaceUser();
        _this.creation = new shared_1.Creation();
        _this.creationAlert = new shared_1.CreationAlert();
        _this.createLabel = options['createLabel'] || '';
        _this.dismissLabel = options['dismissLabel'] || '';
        _this.createWorkspaceLabel = options['createWorkspaceLabel'] || '';
        _this.workspaceDetailsLabel = options['workspaceDetailsLabel'] || '';
        _this.selectSpace = options['selectSpace'] || '';
        _this.nameWorkspace = options['nameWorkspace'] || '';
        _this.addDescription = options['addDescription'] || '';
        _this.selectTemplate = options['selectTemplate'] || '';
        _this.recordMap = options['recordMap'] || [];
        _this.branch = options['branch'] || '';
        _this.nameWorkspaceValidation = options['nameWorkspaceValidation'] || '';
        _this.nameHasSpacesValidation = options['nameHasSpacesValidation'] || '';
        _this.descriptionWorkspaceValidation = options['descriptionWorkspaceValidation'] || '';
        _this.workspaceCreated = options['workspaceCreated'] || '';
        _this.linkingWorkspace = options['linkingWorkspace'] || '';
        _this.creatingWorkspace = options['creatingWorkspace'] || '';
        _this.workspaceLink = options['workspaceLink'] || '';
        return _this;
    }
    CreateWorkspaceField.prototype.init = function () {
        this.rdmp = this.fieldMap._rootComp.rdmp;
    };
    CreateWorkspaceField.prototype.registerEvents = function () {
        this.fieldMap['ListWorkspaces'].field['checkLoggedIn'].subscribe(this.checkLogin.bind(this));
    };
    CreateWorkspaceField.prototype.checkLogin = function (status) {
        this.loggedIn = this.fieldMap._rootComp.loggedIn = status;
    };
    CreateWorkspaceField.prototype.createFormModel = function (valueElem) {
        if (valueElem === void 0) { valueElem = undefined; }
        if (valueElem) {
            this.value = valueElem;
        }
        this.formModel = new forms_1.FormControl(this.value || []);
        if (this.value) {
            this.setValue(this.value);
        }
        return this.formModel;
    };
    CreateWorkspaceField.prototype.setValue = function (value) {
        this.formModel.patchValue(value, { emitEvent: false });
        this.formModel.markAsTouched();
    };
    CreateWorkspaceField.prototype.setEmptyValue = function () {
        this.value = [];
        return this.value;
    };
    CreateWorkspaceField.prototype.loadCreateWorkspaceModal = function () {
        this.workspaceUser = this.fieldMap._rootComp.workspaceUser;
        this.creation.clear();
        this.creationAlert.clear();
        console.log('clear');
        jQuery('#createModal').modal({ show: true, keyboard: false, backdrop: 'static' });
    };
    CreateWorkspaceField.prototype.create = function () {
        this.validations = this.validateWorkspace();
        this.creationAlert.clear();
        if (this.validations.length <= 0) {
            this.createWorkspace();
        }
    };
    CreateWorkspaceField.prototype.validateWorkspace = function () {
        var validateWorkspace = [];
        if (!this.creation.name) {
            validateWorkspace.push({ message: this.nameWorkspaceValidation });
        }
        if (this.creation.nameHasSpaces()) {
            validateWorkspace.push({ message: this.nameHasSpacesValidation });
        }
        if (!this.creation.description) {
            validateWorkspace.push({ message: this.descriptionWorkspaceValidation });
        }
        return validateWorkspace;
    };
    CreateWorkspaceField.prototype.createWorkspace = function () {
        var _this = this;
        this.creationAlert.set({ message: this.creatingWorkspace, status: 'working', className: 'warning' });
        this.omeroService.createWorkspace(this.creation)
            .then(function (response) {
            if (!response.status) {
                //TODO: improve this assignment in case of error.
                throw new Error('Error creating workspace');
            }
            else {
                _this.creationAlert.set({ message: _this.linkingWorkspace, status: 'working', className: 'warning' });
                _this.creation.id = response.create['@id'];
                _this.creation.description = response.create['Description'];
                _this.creation.location = _this.workspaceLink + _this.creation.id;
                return _this.omeroService.link({
                    rdmp: _this.rdmp, project: _this.creation, recordMap: _this.recordMap
                });
            }
        }).then(function (response) {
            if (!response.status) {
                throw new Error(response.message.description);
            }
            _this.creationAlert.set({ message: _this.workspaceCreated, status: 'done', className: 'success' });
            _this.listWorkspaces.emit();
        })
            .catch(function (error) {
            _this.creationAlert.set({ message: error, status: 'error', className: 'danger' });
        });
    };
    __decorate([
        core_1.Output(),
        __metadata("design:type", core_1.EventEmitter)
    ], CreateWorkspaceField.prototype, "listWorkspaces", void 0);
    return CreateWorkspaceField;
}(field_base_1.FieldBase));
exports.CreateWorkspaceField = CreateWorkspaceField;
/**
 * Component that CreateModal to a workspace app
 */
var CreateWorkspaceComponent = /** @class */ (function (_super) {
    __extends(CreateWorkspaceComponent, _super);
    function CreateWorkspaceComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    CreateWorkspaceComponent.prototype.ngOnInit = function () {
        this.field.init();
        this.field.registerEvents();
    };
    CreateWorkspaceComponent = __decorate([
        core_1.Component({
            selector: 'ws-createworkspace',
            template: __webpack_require__("./src/app/components/field-createworkspace.html")
        })
    ], CreateWorkspaceComponent);
    return CreateWorkspaceComponent;
}(field_simple_component_1.SimpleComponent));
exports.CreateWorkspaceComponent = CreateWorkspaceComponent;


/***/ }),

/***/ "./src/app/components/field-createworkspace.html":
/***/ (function(module, exports) {

module.exports = "<div *ngIf=\"field.loggedIn\" class='padding-bottom-10'>\n  <div class=\"\">\n    <button type=\"button\" class=\"btn btn-success\" (click)=\"field.loadCreateWorkspaceModal()\"><i class=\"fa fa-plus-square\"></i>&nbsp;{{ field.createLabel }}</button>\n  </div>\n</div>\n<div id=\"createModal\" class=\"modal fade\" data-keyboard=\"false\">\n  <div class=\"modal-dialog\" role=\"document\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h4 class=\"modal-title\">{{ field.createWorkspaceLabel }}</h4>\n      </div>\n      <div class=\"modal-body\">\n        <div *ngIf=\"field.loadingModal\" class=\"row\">\n          <img class=\"center-block\" src=\"/images/loading.svg\">\n        </div>\n        <div *ngIf=\"!field.loadingModal\">\n          <h5>{{ field.workspaceDetailsLabel }}</h5>\n          <form *ngIf=\"!field.processing\" #form=\"ngForm\" novalidate autocomplete=\"off\">\n            <div class=\"form-group\">\n              <h4>{{ field.nameWorkspace }}</h4>\n              <input required minlength=\"4\" type=\"text\" class=\"form-control\" name=\"creationName\" [(ngModel)]=\"field.creation.name\">\n            </div>\n            <div class=\"form-group\">\n              <h4>{{ field.addDescription }}</h4>\n              <input required minlength=\"4\" type=\"text\" class=\"form-control\" name=\"description\" [(ngModel)]=\"field.creation.description\">\n            </div>\n          </form>\n          <form *ngIf=\"!field.processing\" #form=\"ngForm\" novalidate autocomplete=\"off\">\n            <div class=\"form-group\">\n              <div *ngFor=\"let validation of field.validations\" class=\"alert alert-danger\">\n                <span><i class=\"fa fa-times\"></i> </span>{{ validation.message }}\n              </div>\n            </div>\n            <div class=\"form-group\">\n              <div *ngIf=\"field.creationAlert.message\" class=\"alert alert-{{ field.creationAlert.className  || 'alert' }}\">\n                <span *ngIf=\"field.creationAlert.status === 'success'; then isDone; else isWorking;\"></span>\n                <ng-template #isDone>\n                  <i class=\"fa fa-check-circle\"></i>{{ field.creationAlert.message }}\n                </ng-template>\n                <ng-template #isWorking>\n                  <i class=\"fa fa-spin-circle\"></i>{{ field.creationAlert.message }}\n                </ng-template>\n              </div>\n            </div>\n\n          </form>\n        </div>\n      </div>\n      <div class=\"modal-footer\">\n        <span *ngIf=\"field.creationAlert.status === 'working'; then buttonsBlocked; else buttonsDone;\"></span>\n        <ng-template #buttonsDone>\n          <button class=\"btn btn-primary\" (click)=\"field.create()\" type=\"submit\">{{ field.createLabel }}</button>\n          <button type=\"button\" class=\"btn btn-secondary\" data-dismiss=\"modal\">{{ field.dismissLabel }}</button>\n        </ng-template>\n        <ng-template #buttonsBlocked>\n          <button disabled class=\"btn btn-primary\"  type=\"submit\">{{ field.createLabel }}</button>\n          <button disabled class=\"btn btn-secondary\" type=\"button\">{{ field.dismissLabel }}</button>\n        </ng-template>\n      </div>\n    </div>\n  </div>\n</div>\n"

/***/ }),

/***/ "./src/app/components/field-listworkspaces.html":
/***/ (function(module, exports) {

module.exports = "<div *ngIf=\"field.loggedIn\" class=\"padding-bottom-10\">\n  <div class=\"\">\n    <table class=\"table\">\n      <thead>\n        <tr>\n          <ng-container *ngFor=\"let header of field.columns\"><th>{{ header.label }}</th></ng-container>\n          <th>{{ field.rdmpLinkLabel }}</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr *ngFor=\"let item of field.workspaces\">\n          <ng-container *ngFor=\"let column of field.columns\">\n          <td *ngIf=\"column.show != false\">\n            <span *ngIf=\"column.link; else noProcessing\"><a target=\"_blank\" class=\"{{column.classes || ''}}\" rel=\"noopener noreferrer\" href=\"{{ field.workspaceLink + item[column.property] }}\">{{ column.label || ''}}</a></span>\n            <ng-template #multivalue></ng-template>\n            <ng-template #noProcessing><span >{{ item[column.property] }}</span></ng-template>\n          </td>\n          </ng-container>\n          <td>\n            <span *ngIf=\"!item['linkedState']\">\n              <button type=\"button\" disabled class=\"btn btn-info btn-block\" [name]=\"item['@id']\"><span><i class=\"fa fa-spinner fa-spin\"></i></span></button>\n            </span>\n            <span *ngIf=\"item['linkedState'] === 'linked'\">\n              <button type=\"button\" disabled class=\"btn btn-success btn-block\" [name]=\"item['@id']\">{{ field.linkedLabel }}</button>\n            </span>\n            <span *ngIf=\"item['linkedState'] === 'another'\">\n              <button type=\"button\" disabled class=\"btn btn-info btn-block\" [name]=\"item['@id']\">{{ field.linkedAnotherLabel }}</button>\n            </span>\n            <span *ngIf=\"item['linkedState'] === 'link'\">\n              <button type=\"button\" class=\"btn btn-info btn-block\" [name]=\"item['@id']\" (click)=\"field.linkWorkspace(item)\">{{ field.linkLabel }}</button>\n            </span>\n            <span *ngIf=\"item['linkedState'] === 'problem'\">\n              <button type=\"button\" disabled class=\"btn btn-warning btn-block\" [name]=\"item['@id']\" >{{ field.linkProblem }}</button>\n            </span>\n          </td>\n        </tr>\n      </tbody>\n    </table>\n    <pagination [directionLinks]=\"false\" [boundaryLinks]=\"true\" [totalItems]=\"field.workspacesMeta.totalCount\"\n                [(ngModel)]=\"field.currentPage\" (pageChanged)=\"field.pageChanged($event)\" class=\"pagination-sm\"></pagination>\n    <div *ngIf=\"field.loading\" class=\"\">\n      <img class=\"center-block\" src=\"/images/loading.svg\">\n    </div>\n    <p *ngIf=\"field.failedObjects.length > 0\">There were {{ field.failedObjects.length }} records that failed to load</p>\n    <p *ngIf=\"field.accessDeniedObjects.length > 0\">There were {{ field.accessDeniedObjects.length }} records that you do not have access to</p>\n  </div>\n  <div class=\"\">\n    <button type=\"button\" class=\"btn btn-default\" (click)=\"field.listWorkspaces()\"><i class=\"fa fa-refresh\"></i>&nbsp;{{ field.syncLabel }}</button>\n  </div>\n</div>\n"

/***/ }),

/***/ "./src/app/components/linkmodal-workspace.component.ts":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
Object.defineProperty(exports, "__esModule", { value: true });
var core_1 = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
var field_simple_component_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-simple.component.ts");
var field_base_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-base.ts");
var forms_1 = __webpack_require__("./node_modules/@angular/forms/esm5/forms.js");
var shared_1 = __webpack_require__("./src/app/components/shared.ts");
var omero_service_1 = __webpack_require__("./src/app/omero.service.ts");
/**
 * Contributor Model
 *
 * @author <a target='_' href='https://github.com/moisbo'>moisbo</a>
 *
 */
var LinkModalWorkspaceField = /** @class */ (function (_super) {
    __extends(LinkModalWorkspaceField, _super);
    function LinkModalWorkspaceField(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.listWorkspaces = new core_1.EventEmitter();
        _this.omeroService = _this.getFromInjector(omero_service_1.OMEROService);
        _this.linkModalTitle = options['linkModalTitle'] || '';
        _this.workspaceDetailsTitle = options['workspaceDetailsTitle'] || '';
        _this.processingLabel = options['processingLabel'] || '';
        _this.processingMessage = options['processingMessage'] || '';
        _this.comparingLabel = options['comparingLabel'] || '';
        _this.statusLabel = options['statusLabel'] || '';
        _this.processingSuccess = options['processingSuccess'] || '';
        _this.processingFail = options['processingFail'] || '';
        _this.closeLabel = options['closeLabel'] || '';
        _this.checks = new shared_1.Checks();
        _this.currentWorkspace = new shared_1.CurrentWorkspace();
        _this.workspaceDefinition = options['workspaceDefinition'] || [];
        _this.checkField = options['checkField'] || '';
        _this.recordMap = options['recordMap'] || [];
        _this.workspaceLink = options['workspaceLink'] || '';
        return _this;
    }
    LinkModalWorkspaceField.prototype.registerEvents = function () {
        this.fieldMap['ListWorkspaces'].field['linkModal'].subscribe(this.linkModal.bind(this));
    };
    LinkModalWorkspaceField.prototype.createFormModel = function (valueElem) {
        if (valueElem === void 0) { valueElem = undefined; }
        if (valueElem) {
            this.value = valueElem;
        }
        this.formModel = new forms_1.FormControl(this.value || []);
        if (this.value) {
            this.setValue(this.value);
        }
        return this.formModel;
    };
    LinkModalWorkspaceField.prototype.setValue = function (value) {
        this.formModel.patchValue(value, { emitEvent: false });
        this.formModel.markAsTouched();
    };
    LinkModalWorkspaceField.prototype.setEmptyValue = function () {
        this.value = [];
        return this.value;
    };
    LinkModalWorkspaceField.prototype.linkModal = function (_a) {
        var _this = this;
        var rdmp = _a.rdmp, workspace = _a.workspace;
        this.currentWorkspace = workspace;
        this.currentWorkspace.location = this.workspaceLink + workspace['@id'];
        this.checks.clear();
        jQuery('#linkModal').modal({ show: true, keyboard: false, backdrop: 'static' });
        this.processing = true;
        this.checks.master = true;
        return this.omeroService.link({
            rdmp: rdmp,
            project: this.currentWorkspace,
            recordMap: this.recordMap
        }).then(function (response) {
            if (!response.status) {
                _this.processingStatus = 'done';
                _this.processingFail = response.error.message;
            }
            else {
                _this.checks.linkCreated = true;
            }
            _this.processing = false;
            _this.listWorkspaces.emit();
        })
            .catch(function (error) {
            _this.processingStatus = 'done';
            _this.processingFail = error.error.message;
            _this.processing = false;
        });
    };
    __decorate([
        core_1.Output(),
        __metadata("design:type", core_1.EventEmitter)
    ], LinkModalWorkspaceField.prototype, "listWorkspaces", void 0);
    return LinkModalWorkspaceField;
}(field_base_1.FieldBase));
exports.LinkModalWorkspaceField = LinkModalWorkspaceField;
/**
 * Component that Links Workspaces to Workspace Records in Stash
 */
var LinkModalWorkspaceComponent = /** @class */ (function (_super) {
    __extends(LinkModalWorkspaceComponent, _super);
    function LinkModalWorkspaceComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    LinkModalWorkspaceComponent.prototype.ngOnInit = function () {
        this.field.registerEvents();
    };
    LinkModalWorkspaceComponent = __decorate([
        core_1.Component({
            selector: 'ws-linkmodal',
            template: "\n    <div id=\"linkModal\" class=\"modal fade\" data-keyboard=\"false\">\n      <div class=\"modal-dialog\" role=\"document\">\n        <div class=\"modal-content\">\n          <div class=\"modal-header\">\n            <h4 class=\"modal-title\">{{ field.linkModalTitle }}</h4>\n          </div>\n          <div class=\"modal-body\">\n            <h5>{{ field.workspaceDetailsTitle }}</h5>\n            <p *ngFor=\"let item of field.workspaceDefinition\">{{ item.label }} : {{ field.currentWorkspace[item.name]}}</p>\n            <h5>{{ field.processingLabel }}</h5>\n            <p>{{ field.processingMessage }}&nbsp;<span\n              *ngIf=\"field.checks.master; then isDone; else isSpinning\"></span></p>\n            <p *ngIf=\"field.checks.comparing\">{{ field.comparingLabel }}&nbsp;<span\n              *ngIf=\"field.checks.link; then isDone; else isSpinning\"></span></p>\n            <p *ngIf=\"field.checks.link == false\">{{ field.statusLabel }}&nbsp;<span\n              *ngIf=\"field.checks.rdmp; then isDone; else isSpinning\"></span></p>\n            <p class=\"alert alert-success\" *ngIf=\"field.checks.linkCreated\">{{ field.processingSuccess }}</p>\n            <p class=\"alert alert-danger\" *ngIf=\"field.checks.linkWithOther\">{{ field.processingFail }}</p>\n            <p class=\"alert alert-danger\" *ngIf=\"field.processingStatus === 'done' && field.processingFail\">\n              {{ field.processingFail }}</p>\n            <ng-template #isDone>\n              <i class=\"fa fa-check-circle\"></i>\n            </ng-template>\n            <ng-template #isSpinning>\n              <i class=\"fa fa-spinner fa-spin\"></i>\n            </ng-template>\n          </div>\n          <div class=\"modal-footer\">\n            <span *ngIf=\"field.processing; then waitForProcessing; else finishProcessing\"></span>\n            <ng-template #finishProcessing>\n              <button type=\"button\" class=\"btn btn-secondary\" data-dismiss=\"modal\">{{ field.closeLabel }}</button>\n            </ng-template>\n            <ng-template #waitForProcessing>\n              <button type=\"button\" class=\"btn btn-secondary disabled\" data-dismiss=\"modal\">{{ field.closeLabel }}\n              </button>\n            </ng-template>\n          </div>\n        </div>\n      </div>\n    </div>\n  "
        })
    ], LinkModalWorkspaceComponent);
    return LinkModalWorkspaceComponent;
}(field_simple_component_1.SimpleComponent));
exports.LinkModalWorkspaceComponent = LinkModalWorkspaceComponent;


/***/ }),

/***/ "./src/app/components/list-workspaces.component.ts":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
Object.defineProperty(exports, "__esModule", { value: true });
var core_1 = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
var field_simple_component_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-simple.component.ts");
var field_base_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-base.ts");
var forms_1 = __webpack_require__("./node_modules/@angular/forms/esm5/forms.js");
var omero_service_1 = __webpack_require__("./src/app/omero.service.ts");
/**
 * Contributor Model
 *
 *
 * @author <a target='_' href='https://github.com/moisbo'>moisbo</a>
 *
 */
var ListWorkspaceDataField = /** @class */ (function (_super) {
    __extends(ListWorkspaceDataField, _super);
    function ListWorkspaceDataField(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.currentPage = 1;
        _this.checkLoggedIn = new core_1.EventEmitter();
        _this.linkModal = new core_1.EventEmitter();
        _this.setWorkspaceUser = new core_1.EventEmitter();
        _this.omeroService = _this.getFromInjector(omero_service_1.OMEROService);
        _this.relatedObjects = [];
        _this.accessDeniedObjects = [];
        _this.failedObjects = [];
        _this.columns = options['columns'] || [];
        _this.rdmpLinkLabel = options['rdmpLinkLabel'] || 'Plan';
        _this.syncLabel = options['syncLabel'] || 'Sync';
        var relatedObjects = _this.relatedObjects;
        _this.value = options['value'] || _this.setEmptyValue();
        _this.relatedObjects = [];
        _this.failedObjects = [];
        _this.accessDeniedObjects = [];
        _this.loading = true;
        _this.workspaceLink = options['workspaceLink'];
        _this.linkedLabel = options['linkedLabel'] || 'linked';
        _this.linkedAnotherLabel = options['linkedAnotherLabel'] || 'Linked to another workspace';
        _this.linkLabel = options['linkLabel'] || 'Link Workspace';
        _this.linkProblem = options['linkProblem'] || 'There was a problem checking the link';
        _this.limit = 10;
        _this.offset = 0;
        _this.workspacesMeta = {};
        return _this;
    }
    ListWorkspaceDataField.prototype.registerEvents = function () {
        this.fieldMap['LoginWorkspaceApp'].field['listWorkspaces'].subscribe(this.listWorkspaces.bind(this)); //TODO: this next line doesnt work because of when the form is being built
        this.fieldMap['CreateWorkspace'].field['listWorkspaces'].subscribe(this.listWorkspaces.bind(this));
        this.fieldMap['LinkModal'].field['listWorkspaces'].subscribe(this.listWorkspaces.bind(this));
        // this.fieldMap['RevokeLogin'].field['revokePermissions'].subscribe(this.revoke.bind(this));
    };
    ListWorkspaceDataField.prototype.init = function () {
        this.rdmp = this.fieldMap._rootComp.rdmp;
    };
    ListWorkspaceDataField.prototype.revoke = function () {
        this.loggedIn = false;
    };
    ListWorkspaceDataField.prototype.createFormModel = function (valueElem) {
        if (valueElem === void 0) { valueElem = undefined; }
        if (valueElem) {
            this.value = valueElem;
        }
        this.formModel = new forms_1.FormControl(this.value || []);
        if (this.value) {
            this.setValue(this.value);
        }
        return this.formModel;
    };
    ListWorkspaceDataField.prototype.setValue = function (value) {
        this.formModel.patchValue(value, { emitEvent: false });
        this.formModel.markAsTouched();
    };
    ListWorkspaceDataField.prototype.setEmptyValue = function () {
        this.value = [];
        return this.value;
    };
    ListWorkspaceDataField.prototype.listWorkspaces = function () {
        var _this = this;
        this.loading = true;
        this.workspaces = [];
        return this.omeroService.projects(this.limit, this.offset)
            .then(function (response) {
            _this.loading = false;
            if (!response.status) {
                _this.loggedIn = _this.fieldMap._rootComp.loggedIn = false;
                _this.checkLoggedIn.emit(false);
            }
            else {
                _this.loggedIn = _this.fieldMap._rootComp.loggedIn = true;
                _this.workspacesMeta = response.projects.meta;
                _this.workspaces = response.projects.data;
                _this.checkLoggedIn.emit(true);
                _this.checkLinks();
            }
        })
            .catch(function (error) {
            _this.loading = false;
            _this.loggedIn = _this.fieldMap._rootComp.loggedIn = false;
            _this.checkLoggedIn.emit(false);
        });
    };
    ListWorkspaceDataField.prototype.linkWorkspace = function (item) {
        this.linkModal.emit({ rdmp: this.fieldMap._rootComp.rdmp, workspace: item });
    };
    ListWorkspaceDataField.prototype.checkLinks = function () {
        var _this = this;
        //this.workspaces[index]['linkedState'] == 'check'; // Possible values: linked, another, link
        this.workspaces.map(function (w, index) {
            _this.omeroService.checkLink({ rdmpId: _this.rdmp, omeroId: w['@id'] })
                .then(function (response) {
                if (!response.status) {
                    throw new Error('Error checking workspace');
                }
                else {
                    var check = response.check;
                    if (check && check.omero) {
                        _this.workspaces[index]['linkedState'] = 'linked';
                    }
                    else if (check && check.ws) {
                        _this.workspaces[index]['linkedState'] = 'another';
                    }
                    else {
                        _this.workspaces[index]['linkedState'] = 'link';
                    }
                }
            })
                .catch(function (error) {
                console.log(error);
                _this.workspaces[index]['linkedState'] = 'problem';
            });
        });
    };
    ListWorkspaceDataField.prototype.pageChanged = function (event) {
        this.limit = this.workspacesMeta.limit;
        this.offset = this.workspacesMeta.offset;
        var currentOffset = (event.page * this.limit) - this.limit;
        if (this.currentPage > event.page) {
            if (currentOffset <= this.limit) {
                this.offset = 0;
            }
            else {
                this.offset = currentOffset <= 0 ? 0 : currentOffset;
            }
        }
        else {
            this.offset = currentOffset;
        }
        this.listWorkspaces();
    };
    ListWorkspaceDataField.prototype.setPage = function (pageNo) {
        this.currentPage = pageNo;
    };
    __decorate([
        core_1.Output(),
        __metadata("design:type", core_1.EventEmitter)
    ], ListWorkspaceDataField.prototype, "checkLoggedIn", void 0);
    __decorate([
        core_1.Output(),
        __metadata("design:type", core_1.EventEmitter)
    ], ListWorkspaceDataField.prototype, "linkModal", void 0);
    __decorate([
        core_1.Output(),
        __metadata("design:type", core_1.EventEmitter)
    ], ListWorkspaceDataField.prototype, "setWorkspaceUser", void 0);
    return ListWorkspaceDataField;
}(field_base_1.FieldBase));
exports.ListWorkspaceDataField = ListWorkspaceDataField;
/**
 * Component to display information from related objects within ReDBox
 */
var ListWorkspaceDataComponent = /** @class */ (function (_super) {
    __extends(ListWorkspaceDataComponent, _super);
    function ListWorkspaceDataComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    ListWorkspaceDataComponent.prototype.ngOnInit = function () {
        this.field.registerEvents();
        this.field.init();
    };
    ListWorkspaceDataComponent.prototype.ngAfterContentInit = function () {
        this.field.listWorkspaces();
    };
    ListWorkspaceDataComponent = __decorate([
        core_1.Component({
            selector: 'ws-listworkspaces',
            template: __webpack_require__("./src/app/components/field-listworkspaces.html")
        })
    ], ListWorkspaceDataComponent);
    return ListWorkspaceDataComponent;
}(field_simple_component_1.SimpleComponent));
exports.ListWorkspaceDataComponent = ListWorkspaceDataComponent;


/***/ }),

/***/ "./src/app/components/login-workspaceapp.component.ts":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
Object.defineProperty(exports, "__esModule", { value: true });
var core_1 = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
var forms_1 = __webpack_require__("./node_modules/@angular/forms/esm5/forms.js");
var field_simple_component_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-simple.component.ts");
var field_base_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-base.ts");
var omero_service_1 = __webpack_require__("./src/app/omero.service.ts");
/**
 * Contributor Model
 *
 * @author <a target='_' href='https://github.com/moisbo'>moisbo</a>
 *
 */
var LoginWorkspaceAppField = /** @class */ (function (_super) {
    __extends(LoginWorkspaceAppField, _super);
    function LoginWorkspaceAppField(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.listWorkspaces = new core_1.EventEmitter();
        _this.omeroService = _this.getFromInjector(omero_service_1.OMEROService);
        _this.columns = options['columns'] || [];
        _this.usernameLabel = options['usernameLabel'] || 'username';
        _this.passwordLabel = options['passwordLabel'] || 'password';
        _this.loginLabel = options['loginLabel'] || 'login';
        _this.loginErrorMessage = options['loginErrorMessage'] || 'Please include username and password';
        _this.permissionStep = options['permissionStep'] || '';
        _this.permissionList = options['permissionList'] || {};
        _this.permissionLabel = options['permissionLabel'] || '';
        _this.allowLabel = options['allowLabel'] || 'Allow';
        _this.closeLabel = options['closeLabel'] || 'Close';
        _this.cannotLoginMessage = options['cannotLoginMessage'] || 'There was a problem login in, please try again';
        return _this;
    }
    LoginWorkspaceAppField.prototype.registerEvents = function () {
        this.fieldMap['ListWorkspaces'].field['checkLoggedIn'].subscribe(this.checkLogin.bind(this));
        //let that = this;
        //this.fieldMap._rootComp['loginMessage'].subscribe(that.displayLoginMessage);
    };
    LoginWorkspaceAppField.prototype.revoke = function () {
        this.checkLogin(false);
    };
    LoginWorkspaceAppField.prototype.checkLogin = function (status) {
        this.loggedIn = this.fieldMap._rootComp.loggedIn = status;
        this.isLoaded = true;
    };
    LoginWorkspaceAppField.prototype.createFormModel = function (valueElem) {
        if (valueElem === void 0) { valueElem = undefined; }
        if (valueElem) {
            this.value = valueElem;
        }
        this.formModel = new forms_1.FormControl(this.value || []);
        if (this.value) {
            this.setValue(this.value);
        }
        return this.formModel;
    };
    LoginWorkspaceAppField.prototype.setValue = function (value) {
        this.formModel.patchValue(value, { emitEvent: false });
        this.formModel.markAsTouched();
    };
    LoginWorkspaceAppField.prototype.setEmptyValue = function () {
        this.value = [];
        return this.value;
    };
    LoginWorkspaceAppField.prototype.validate = function (form) {
        if (form.username && form.password) {
            jQuery('#loginPermissionModal').modal('show');
        }
        else {
            this.loginError = true;
        }
    };
    LoginWorkspaceAppField.prototype.allow = function (form) {
        var _this = this;
        //this.loginSubmitted.emit(userForm);
        jQuery('#loginPermissionModal').modal('hide');
        var formValues = {
            username: form.username,
            password: form.password
        };
        this.loading = true;
        this.omeroService.session(formValues).then(function (response) {
            _this.loading = false;
            if (!response.status) {
                if (!response.message) {
                    _this.displayLoginMessage({ error: true, value: _this.cannotLoginMessage });
                }
                else {
                    _this.displayLoginMessage({ error: true, value: response.message });
                }
                _this.loggedIn = false;
            }
            else {
                _this.displayLoginMessage({ error: false, value: '' });
                _this.listWorkspaces.emit();
            }
        });
    };
    LoginWorkspaceAppField.prototype.displayLoginMessage = function (message) {
        this.loginError = message.error;
        this.loginErrorMessage = message.value;
    };
    __decorate([
        core_1.Output(),
        __metadata("design:type", core_1.EventEmitter)
    ], LoginWorkspaceAppField.prototype, "listWorkspaces", void 0);
    return LoginWorkspaceAppField;
}(field_base_1.FieldBase));
exports.LoginWorkspaceAppField = LoginWorkspaceAppField;
/**
 * Component that log's in to a workspace app
 *
 */
var LoginWorkspaceAppComponent = /** @class */ (function (_super) {
    __extends(LoginWorkspaceAppComponent, _super);
    function LoginWorkspaceAppComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    LoginWorkspaceAppComponent.prototype.ngOnInit = function () {
        this.field.registerEvents();
    };
    LoginWorkspaceAppComponent = __decorate([
        core_1.Component({
            selector: 'ws-login',
            template: "\n    <div *ngIf=\"field.loading\" class=\"\">\n      <img class=\"center-block\" src=\"/images/loading.svg\">\n    </div>\n    <div *ngIf=\"!field.loggedIn && field.isLoaded && !field.loading\" class=\"padding-bottom-10\">\n      <div class=\"\">\n        <h4>{{ field.permissionStep }}</h4>\n        <form #form=\"ngForm\" novalidate autocomplete=\"off\">\n          <div class=\"form-group\">\n            <label>{{ field.usernameLabel }}</label>\n            <input type=\"text\" class=\"form-control\" name=\"username\" ngModel>\n          </div>\n          <div class=\"form-group\">\n            <label>{{ field.passwordLabel }}</label>\n            <input type=\"password\" class=\"form-control\" name=\"password\" ngModel>\n          </div>\n          <button (click)=\"field.validate(form.value)\" class=\"btn btn-primary\"\n                  type=\"submit\">{{ field.loginLabel }}\n          </button>\n          <div class=\"row\"><br/></div>\n          <div class=\"alert alert-danger\" *ngIf=\"field.loginError\">\n            {{field.loginErrorMessage}}\n          </div>\n        </form>\n      </div>\n      <div id=\"loginPermissionModal\" class=\"modal fade\">\n        <div class=\"modal-dialog\" role=\"document\">\n          <div class=\"modal-content\">\n            <div class=\"modal-header\">\n              <h4 class=\"modal-title\">{{ field.permissionLabel }}</h4>\n            </div>\n            <div class=\"modal-body\">\n              <p>{{ field.permissionStep }}</p>\n              <ul>\n                <li *ngFor=\"let permission of field.permissionList\">{{ permission }}</li>\n              </ul>\n            </div>\n            <div class=\"modal-footer\">\n              <button type=\"button\" class=\"btn btn-primary\" (click)=\"field.allow(form.value)\">{{ field.allowLabel }}\n              </button>\n              <button type=\"button\" class=\"btn btn-secondary\" data-dismiss=\"modal\">{{ field.closeLabel }}</button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  "
        })
    ], LoginWorkspaceAppComponent);
    return LoginWorkspaceAppComponent;
}(field_simple_component_1.SimpleComponent));
exports.LoginWorkspaceAppComponent = LoginWorkspaceAppComponent;


/***/ }),

/***/ "./src/app/components/shared.ts":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var WorkspaceUser = /** @class */ (function () {
    function WorkspaceUser() {
    }
    return WorkspaceUser;
}());
exports.WorkspaceUser = WorkspaceUser;
var Checks = /** @class */ (function () {
    function Checks() {
        this.link = undefined;
        this.rdmp = false;
        this.linkCreated = false;
        this.linkWithOther = false;
        this.master = false;
        this.comparing = false;
    }
    Checks.prototype.clear = function () {
        this.linkCreated = false;
        this.linkWithOther = false;
    };
    return Checks;
}());
exports.Checks = Checks;
var Creation = /** @class */ (function () {
    function Creation() {
        this.created = false;
        this.name = '';
        this.blank = true;
        this.description = '';
    }
    Creation.prototype.clear = function () {
        this.location = '';
        this.description = '';
        this.name = '';
        this.id = '';
    };
    Creation.prototype.nameHasSpaces = function () {
        return /\s/g.test(this.name);
    };
    return Creation;
}());
exports.Creation = Creation;
var CreationAlert = /** @class */ (function () {
    function CreationAlert() {
        this.message = '';
        this.className = 'danger';
        this.status = '';
    }
    CreationAlert.prototype.set = function (_a) {
        var message = _a.message, status = _a.status, className = _a.className;
        this.message = message;
        this.status = status;
        this.className = className;
    };
    CreationAlert.prototype.clear = function () {
        this.message = '';
        this.className = 'danger';
        this.status = '';
    };
    return CreationAlert;
}());
exports.CreationAlert = CreationAlert;
var CurrentWorkspace = /** @class */ (function () {
    function CurrentWorkspace() {
        this.path_with_namespace = '';
        this.web_url = '';
    }
    return CurrentWorkspace;
}());
exports.CurrentWorkspace = CurrentWorkspace;


/***/ }),

/***/ "./src/app/omero-form.component.ts":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};
Object.defineProperty(exports, "__esModule", { value: true });
var core_1 = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
var common_1 = __webpack_require__("./node_modules/@angular/common/esm5/common.js");
var records_service_1 = __webpack_require__("./redbox-portal/angular/shared/form/records.service.ts");
var omero_service_1 = __webpack_require__("./src/app/omero.service.ts");
var loadable_component_1 = __webpack_require__("./redbox-portal/angular/shared/loadable.component.ts");
var field_control_service_1 = __webpack_require__("./redbox-portal/angular/shared/form/field-control.service.ts");
var translation_service_1 = __webpack_require__("./redbox-portal/angular/shared/translation-service.ts");
var login_workspaceapp_component_1 = __webpack_require__("./src/app/components/login-workspaceapp.component.ts");
var list_workspaces_component_1 = __webpack_require__("./src/app/components/list-workspaces.component.ts");
var linkmodal_workspace_component_1 = __webpack_require__("./src/app/components/linkmodal-workspace.component.ts");
var create_workspace_component_1 = __webpack_require__("./src/app/components/create-workspace.component.ts");
/**
* Main OMERO Edit component
*
* @author <a target='_' href='https://github.com/moisbo'>moisbo</a>
*
*/
var OMEROFormComponent = /** @class */ (function (_super) {
    __extends(OMEROFormComponent, _super);
    function OMEROFormComponent(elm, RecordsService, fcs, LocationService, OMEROService, translationService) {
        var _this = _super.call(this) || this;
        _this.RecordsService = RecordsService;
        _this.fcs = fcs;
        _this.LocationService = LocationService;
        _this.OMEROService = OMEROService;
        _this.translationService = translationService;
        /**
        * Fields for the form
        */
        _this.fields = [];
        _this.loading = false;
        _this.oid = elm.nativeElement.getAttribute('oid');
        _this.editMode = elm.nativeElement.getAttribute('editMode') == "true";
        _this.recordType = elm.nativeElement.getAttribute('recordType');
        _this.rdmp = elm.nativeElement.getAttribute('rdmp');
        //TODO: Find out what is this next line!
        _this.fieldMap = { _rootComp: _this };
        //TODO: do I have to wait for gitlabservice too?
        // this.initSubs = OMEROService.waitForInit((initStat:boolean) => {
        //   this.initSubs.unsubscribe();
        //   this.loadForm();
        // });
        _this.initSubs = RecordsService.waitForInit(function (initStat) {
            _this.initSubs.unsubscribe();
            _this.loadForm();
        });
        return _this;
    }
    OMEROFormComponent.prototype.registerEvents = function () {
        //this.fieldMap['ListWorkspaces'].field['setWorkspaceUser'].subscribe(this.setWorkspaceUser.bind(this));
    };
    OMEROFormComponent.prototype.loadForm = function () {
        var _this = this;
        this.fcs.addComponentClasses({
            'ListWorkspaceDataField': { 'meta': list_workspaces_component_1.ListWorkspaceDataField, 'comp': list_workspaces_component_1.ListWorkspaceDataComponent },
            'LoginWorkspaceAppField': { 'meta': login_workspaceapp_component_1.LoginWorkspaceAppField, 'comp': login_workspaceapp_component_1.LoginWorkspaceAppComponent },
            'LinkModalWorkspaceField': { 'meta': linkmodal_workspace_component_1.LinkModalWorkspaceField, 'comp': linkmodal_workspace_component_1.LinkModalWorkspaceComponent },
            'CreateWorkspaceField': { 'meta': create_workspace_component_1.CreateWorkspaceField, 'comp': create_workspace_component_1.CreateWorkspaceComponent }
        });
        this.RecordsService.getForm(this.oid, this.recordType, this.editMode).then(function (obs) {
            obs.subscribe(function (form) {
                _this.formDef = form;
                if (_this.editMode) {
                    _this.cssClasses = _this.formDef.editCssClasses;
                }
                else {
                    _this.cssClasses = _this.formDef.viewCssClasses;
                }
                _this.loggedIn = false;
                if (form.fieldsMeta) {
                    _this.fields = form.fieldsMeta;
                    _this.rebuildForm();
                    _this.watchForChanges();
                    _this.registerEvents();
                    _this.fieldMap['BackToPlan'].field.value = _this.fieldMap['BackToPlan'].field.value + _this.rdmp;
                }
            });
        }).catch(function (err) {
            console.log("Error loading form...");
            console.log(err);
            if (err.status == false) {
                _this.criticalError = err.message;
            }
            _this.setLoading(false);
        });
    };
    /**
     * Rebuild the form message.
     *
     * @return {[type]}
     */
    OMEROFormComponent.prototype.rebuildForm = function () {
        this.form = this.fcs.toFormGroup(this.fields, this.fieldMap);
    };
    /**
     * Enable form change monitor.
     *
     * @return {[type]}
     */
    OMEROFormComponent.prototype.watchForChanges = function () {
        this.setLoading(false);
        if (this.editMode) {
            this.form.valueChanges.subscribe(function (data) {
                //this.needsSave = true;
            });
        }
    };
    OMEROFormComponent.prototype.setWorkspaceUser = function (workspaceUser) {
        this.workspaceUser = workspaceUser;
    };
    __decorate([
        core_1.Input(),
        __metadata("design:type", String)
    ], OMEROFormComponent.prototype, "oid", void 0);
    __decorate([
        core_1.Input(),
        __metadata("design:type", Boolean)
    ], OMEROFormComponent.prototype, "editMode", void 0);
    __decorate([
        core_1.Input(),
        __metadata("design:type", String)
    ], OMEROFormComponent.prototype, "recordType", void 0);
    OMEROFormComponent = __decorate([
        core_1.Component({
            moduleId: module.i,
            selector: 'omero-form',
            template: __webpack_require__("./src/app/omero-form.html"),
            providers: [common_1.Location, { provide: common_1.LocationStrategy, useClass: common_1.PathLocationStrategy }]
        }),
        __param(1, core_1.Inject(records_service_1.RecordsService)),
        __param(2, core_1.Inject(field_control_service_1.FieldControlService)),
        __param(3, core_1.Inject(common_1.Location)),
        __param(4, core_1.Inject(omero_service_1.OMEROService)),
        __metadata("design:paramtypes", [core_1.ElementRef,
            records_service_1.RecordsService,
            field_control_service_1.FieldControlService,
            common_1.Location,
            omero_service_1.OMEROService,
            translation_service_1.TranslationService])
    ], OMEROFormComponent);
    return OMEROFormComponent;
}(loadable_component_1.LoadableComponent));
exports.OMEROFormComponent = OMEROFormComponent;


/***/ }),

/***/ "./src/app/omero-form.html":
/***/ (function(module, exports) {

module.exports = "<div *ngIf=\"!criticalError\" class=\"row\">\n  <div class=\"col-xs-1\"></div>\n  <div class=\"col-xs-10\">\n    <ws-field *ngFor=\"let field of fields\" [field]=\"field\"\n      [form]=\"form\" class=\"form-row\" [fieldMap]=\"fieldMap\">\n    </ws-field>\n  </div>\n</div>\n<div *ngIf=\"criticalError\" class=\"row\">\n  <div class=\"col-xs-2\"></div>\n  <div class=\"col-xs-8\">\n    <div class=\"panel panel-danger\">\n      <div class=\"panel-heading\">\n        <h3 class=\"panel-title\">Error</h3>\n      </div>\n      <div class=\"panel-body\">\n        <code>\n          {{criticalError}}\n        </code>\n      </div>\n    </div>\n  </div>\n  <div class=\"col-xs-2\"></div>\n</div>\n"

/***/ }),

/***/ "./src/app/omero.module.ts":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
Object.defineProperty(exports, "__esModule", { value: true });
var core_1 = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
var platform_browser_1 = __webpack_require__("./node_modules/@angular/platform-browser/esm5/platform-browser.js");
var forms_1 = __webpack_require__("./node_modules/@angular/forms/esm5/forms.js");
var http_1 = __webpack_require__("./node_modules/@angular/http/esm5/http.js");
var omero_form_component_1 = __webpack_require__("./src/app/omero-form.component.ts");
var omero_service_1 = __webpack_require__("./src/app/omero.service.ts");
var shared_module_1 = __webpack_require__("./redbox-portal/angular/shared/shared.module.ts");
var ngx_bootstrap_1 = __webpack_require__("./node_modules/ngx-bootstrap/index.js");
var login_workspaceapp_component_1 = __webpack_require__("./src/app/components/login-workspaceapp.component.ts");
var list_workspaces_component_1 = __webpack_require__("./src/app/components/list-workspaces.component.ts");
var linkmodal_workspace_component_1 = __webpack_require__("./src/app/components/linkmodal-workspace.component.ts");
var create_workspace_component_1 = __webpack_require__("./src/app/components/create-workspace.component.ts");
var OMEROModule = /** @class */ (function () {
    function OMEROModule() {
    }
    OMEROModule = __decorate([
        core_1.NgModule({
            imports: [platform_browser_1.BrowserModule, http_1.HttpModule, forms_1.ReactiveFormsModule,
                shared_module_1.SharedModule, forms_1.FormsModule, ngx_bootstrap_1.PaginationModule.forRoot()
            ],
            declarations: [omero_form_component_1.OMEROFormComponent,
                list_workspaces_component_1.ListWorkspaceDataComponent, login_workspaceapp_component_1.LoginWorkspaceAppComponent,
                linkmodal_workspace_component_1.LinkModalWorkspaceComponent, create_workspace_component_1.CreateWorkspaceComponent
            ],
            exports: [],
            providers: [omero_service_1.OMEROService],
            bootstrap: [omero_form_component_1.OMEROFormComponent],
            entryComponents: [login_workspaceapp_component_1.LoginWorkspaceAppComponent,
                list_workspaces_component_1.ListWorkspaceDataComponent, linkmodal_workspace_component_1.LinkModalWorkspaceComponent,
                create_workspace_component_1.CreateWorkspaceComponent
            ]
        })
    ], OMEROModule);
    return OMEROModule;
}());
exports.OMEROModule = OMEROModule;


/***/ }),

/***/ "./src/app/omero.service.ts":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};
Object.defineProperty(exports, "__esModule", { value: true });
var core_1 = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
var Subject_1 = __webpack_require__("./node_modules/rxjs/_esm5/Subject.js");
var http_1 = __webpack_require__("./node_modules/@angular/http/esm5/http.js");
__webpack_require__("./node_modules/rxjs/_esm5/add/operator/toPromise.js");
__webpack_require__("./node_modules/rxjs/_esm5/add/operator/delay.js");
var base_service_1 = __webpack_require__("./redbox-portal/angular/shared/base-service.ts");
var config_service_1 = __webpack_require__("./redbox-portal/angular/shared/config-service.ts");
var OMEROService = /** @class */ (function (_super) {
    __extends(OMEROService, _super);
    function OMEROService(http, configService) {
        var _this = _super.call(this, http, configService) || this;
        _this.configService = configService;
        _this.recordURL = _this.brandingAndPortalUrl + '/record/view';
        _this.initSubject = new Subject_1.Subject();
        _this.emitInit();
        return _this;
    }
    OMEROService.prototype.waitForInit = function (handler) {
        var subs = this.initSubject.subscribe(handler);
        this.emitInit();
        return subs;
    };
    OMEROService.prototype.emitInit = function () {
        if (this.brandingAndPortalUrl) {
            this.initSubject.next('');
        }
    };
    OMEROService.prototype.session = function (login) {
        var _this = this;
        var wsUrl = this.brandingAndPortalUrl + '/ws/omero/login';
        return this.http.post(wsUrl, { username: login.username, password: login.password }, this.options)
            .toPromise()
            .then(function (res) {
            return _this.extractData(res);
        })
            .catch(function (res) {
            return _this.extractData(res);
        });
    };
    OMEROService.prototype.projects = function (limit, offset) {
        var _this = this;
        var wsUrl = this.brandingAndPortalUrl + "/ws/omero/projects/" + limit + "/" + offset;
        return this.http.get(wsUrl, this.options)
            .toPromise()
            .then(function (res) {
            return _this.extractData(res);
        })
            .catch(function (res) {
            return _this.extractData(res);
        });
    };
    OMEROService.prototype.createWorkspace = function (creation) {
        var _this = this;
        var wsUrl = this.brandingAndPortalUrl + '/ws/omero/create';
        return this.http.post(wsUrl, { creation: creation }, this.options)
            .toPromise()
            .then(function (res) {
            return _this.extractData(res);
        })
            .catch(function (res) {
            return _this.extractData(res);
        });
    };
    OMEROService.prototype.link = function (_a) {
        var _this = this;
        var rdmp = _a.rdmp, project = _a.project, recordMap = _a.recordMap;
        var wsUrl = this.brandingAndPortalUrl + '/ws/omero/link';
        return this.http.post(wsUrl, { rdmp: rdmp, project: project, recordMap: recordMap }, this.options)
            .toPromise()
            .then(function (res) {
            return _this.extractData(res);
        })
            .catch(function (res) {
            return _this.extractData(res);
        });
    };
    OMEROService.prototype.checkLink = function (_a) {
        var _this = this;
        var rdmpId = _a.rdmpId, omeroId = _a.omeroId;
        var wsUrl = this.brandingAndPortalUrl + '/ws/omero/checkLink';
        return this.http.post(wsUrl, { rdmpId: rdmpId, omeroId: omeroId }, this.options)
            .delay(500)
            .toPromise()
            .then(function (res) {
            return _this.extractData(res);
        })
            .catch(function (res) {
            return _this.extractData(res);
        });
    };
    OMEROService = __decorate([
        core_1.Injectable(),
        __param(0, core_1.Inject(http_1.Http)),
        __param(1, core_1.Inject(config_service_1.ConfigService)),
        __metadata("design:paramtypes", [http_1.Http,
            config_service_1.ConfigService])
    ], OMEROService);
    return OMEROService;
}(base_service_1.BaseService));
exports.OMEROService = OMEROService;


/***/ }),

/***/ "./src/environments/environment.ts":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

// The file contents for the current environment will overwrite these during build.
// The build system defaults to the dev environment which uses `environment.ts`, but if you do
// `ng build --env=prod` then `environment.prod.ts` will be used instead.
// The list of which env maps to which file can be found in `.angular-cli.json`.
Object.defineProperty(exports, "__esModule", { value: true });
exports.environment = {
    production: false
};


/***/ }),

/***/ "./src/main.ts":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var core_1 = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
var platform_browser_dynamic_1 = __webpack_require__("./node_modules/@angular/platform-browser-dynamic/esm5/platform-browser-dynamic.js");
var omero_module_1 = __webpack_require__("./src/app/omero.module.ts");
var environment_1 = __webpack_require__("./src/environments/environment.ts");
if (environment_1.environment.production) {
    core_1.enableProdMode();
}
platform_browser_dynamic_1.platformBrowserDynamic().bootstrapModule(omero_module_1.OMEROModule);


/***/ }),

/***/ 0:
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__("./src/main.ts");


/***/ }),

/***/ 1:
/***/ (function(module, exports) {

/* (ignored) */

/***/ })

},[0]);
//# sourceMappingURL=main.bundle.js.map