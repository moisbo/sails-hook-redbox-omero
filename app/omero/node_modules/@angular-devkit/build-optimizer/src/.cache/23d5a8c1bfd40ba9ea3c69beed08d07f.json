{"remainingRequest":"/Users/moises/source/code.research/sails-hook-redbox-omero/app/omero/node_modules/@angular-devkit/build-optimizer/src/build-optimizer/webpack-loader.js??ref--3-1!/Users/moises/source/code.research/sails-hook-redbox-omero/app/omero/node_modules/ng2-tree/src/draggable/node-draggable.directive.js","dependencies":[{"path":"/Users/moises/source/code.research/sails-hook-redbox-omero/app/omero/node_modules/ng2-tree/src/draggable/node-draggable.directive.js","mtime":1528354008000},{"path":"/Users/moises/source/code.research/sails-hook-redbox-omero/app/omero/node_modules/cache-loader/dist/cjs.js","mtime":1528352013145},{"path":"/Users/moises/source/code.research/sails-hook-redbox-omero/app/omero/node_modules/@angular-devkit/build-optimizer/src/build-optimizer/webpack-loader.js","mtime":1519266497000}],"contextDependencies":[],"result":["'use strict';\nObject.defineProperty(exports, '__esModule', { value: true });\nvar core_1 = require('@angular/core');\nvar node_draggable_service_1 = require('./node-draggable.service');\nvar captured_node_1 = require('./captured-node');\nvar NodeDraggableDirective = (function () {\n    function NodeDraggableDirective(element, nodeDraggableService, renderer) {\n        this.element = element;\n        this.nodeDraggableService = nodeDraggableService;\n        this.renderer = renderer;\n        this.disposersForDragListeners = [];\n        this.nodeNativeElement = element.nativeElement;\n    }\n    NodeDraggableDirective.prototype.ngOnInit = function () {\n        if (!this.tree.isStatic()) {\n            this.renderer.setAttribute(this.nodeNativeElement, 'draggable', 'true');\n            this.disposersForDragListeners.push(this.renderer.listen(this.nodeNativeElement, 'dragenter', this.handleDragEnter.bind(this)));\n            this.disposersForDragListeners.push(this.renderer.listen(this.nodeNativeElement, 'dragover', this.handleDragOver.bind(this)));\n            this.disposersForDragListeners.push(this.renderer.listen(this.nodeNativeElement, 'dragstart', this.handleDragStart.bind(this)));\n            this.disposersForDragListeners.push(this.renderer.listen(this.nodeNativeElement, 'dragleave', this.handleDragLeave.bind(this)));\n            this.disposersForDragListeners.push(this.renderer.listen(this.nodeNativeElement, 'drop', this.handleDrop.bind(this)));\n            this.disposersForDragListeners.push(this.renderer.listen(this.nodeNativeElement, 'dragend', this.handleDragEnd.bind(this)));\n        }\n    };\n    NodeDraggableDirective.prototype.ngOnDestroy = function () {\n        /* tslint:disable:typedef */\n        this.disposersForDragListeners.forEach(function (dispose) {\n            return dispose();\n        });\n        /* tslint:enable:typedef */\n    };\n    NodeDraggableDirective.prototype.handleDragStart = function (e) {\n        if (e.stopPropagation) {\n            e.stopPropagation();\n        }\n        this.nodeDraggableService.captureNode(new captured_node_1.CapturedNode(this.nodeDraggable, this.tree));\n        e.dataTransfer.setData('text', NodeDraggableDirective.DATA_TRANSFER_STUB_DATA);\n        e.dataTransfer.effectAllowed = 'move';\n    };\n    NodeDraggableDirective.prototype.handleDragOver = function (e) {\n        e.preventDefault();\n        e.dataTransfer.dropEffect = 'move';\n    };\n    NodeDraggableDirective.prototype.handleDragEnter = function (e) {\n        e.preventDefault();\n        if (this.containsElementAt(e)) {\n            this.addClass('over-drop-target');\n        }\n    };\n    NodeDraggableDirective.prototype.handleDragLeave = function (e) {\n        if (!this.containsElementAt(e)) {\n            this.removeClass('over-drop-target');\n        }\n    };\n    NodeDraggableDirective.prototype.handleDrop = function (e) {\n        e.preventDefault();\n        if (e.stopPropagation) {\n            e.stopPropagation();\n        }\n        this.removeClass('over-drop-target');\n        if (!this.isDropPossible(e)) {\n            return false;\n        }\n        if (this.nodeDraggableService.getCapturedNode()) {\n            return this.notifyThatNodeWasDropped();\n        }\n    };\n    NodeDraggableDirective.prototype.isDropPossible = function (e) {\n        var capturedNode = this.nodeDraggableService.getCapturedNode();\n        return capturedNode && capturedNode.canBeDroppedAt(this.nodeDraggable) && this.containsElementAt(e);\n    };\n    NodeDraggableDirective.prototype.handleDragEnd = function (e) {\n        this.removeClass('over-drop-target');\n        this.nodeDraggableService.releaseCapturedNode();\n    };\n    NodeDraggableDirective.prototype.containsElementAt = function (e) {\n        var _a = e.x, x = _a === void 0 ? e.clientX : _a, _b = e.y, y = _b === void 0 ? e.clientY : _b;\n        return this.nodeNativeElement.contains(document.elementFromPoint(x, y));\n    };\n    NodeDraggableDirective.prototype.addClass = function (className) {\n        var classList = this.nodeNativeElement.classList;\n        classList.add(className);\n    };\n    NodeDraggableDirective.prototype.removeClass = function (className) {\n        var classList = this.nodeNativeElement.classList;\n        classList.remove(className);\n    };\n    NodeDraggableDirective.prototype.notifyThatNodeWasDropped = function () {\n        this.nodeDraggableService.fireNodeDragged(this.nodeDraggableService.getCapturedNode(), this.nodeDraggable);\n    };\n    NodeDraggableDirective.DATA_TRANSFER_STUB_DATA = 'some browsers enable drag-n-drop only when dataTransfer has data';\n    NodeDraggableDirective.decorators = [\n        {\n            type: core_1.Directive,\n            args: [\n                {\n                    selector: '[nodeDraggable]'\n                }\n            ]\n        }\n    ];\n    NodeDraggableDirective.propDecorators = {\n        nodeDraggable: [{ type: core_1.Input }],\n        tree: [{ type: core_1.Input }]\n    };\n    return NodeDraggableDirective;\n})();\nexports.NodeDraggableDirective = NodeDraggableDirective;\n",null]}