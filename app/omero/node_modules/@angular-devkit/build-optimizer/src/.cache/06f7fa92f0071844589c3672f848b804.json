{"remainingRequest":"/Users/moises/source/code.research/sails-hook-redbox-omero/app/omero/node_modules/@angular-devkit/build-optimizer/src/build-optimizer/webpack-loader.js??ref--3-1!/Users/moises/source/code.research/sails-hook-redbox-omero/app/omero/node_modules/uppy/lib/plugins/Transloadit/Client.js","dependencies":[{"path":"/Users/moises/source/code.research/sails-hook-redbox-omero/app/omero/node_modules/uppy/lib/plugins/Transloadit/Client.js","mtime":1521677675000},{"path":"/Users/moises/source/code.research/sails-hook-redbox-omero/app/omero/node_modules/cache-loader/dist/cjs.js","mtime":1528352013145},{"path":"/Users/moises/source/code.research/sails-hook-redbox-omero/app/omero/node_modules/@angular-devkit/build-optimizer/src/build-optimizer/webpack-loader.js","mtime":1519266497000}],"contextDependencies":[],"result":["function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar _Promise = typeof Promise === 'undefined' ? require('es6-promise').Promise : Promise;\n\n/**\n * A Barebones HTTP API client for Transloadit.\n */\nmodule.exports = function () {\n  function Client() {\n    var opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    _classCallCheck(this, Client);\n\n    this.opts = opts;\n  }\n\n  /**\n   * Create a new assembly.\n   *\n   * @param {object} options\n   */\n\n\n  Client.prototype.createAssembly = function createAssembly(_ref) {\n    var templateId = _ref.templateId,\n        params = _ref.params,\n        fields = _ref.fields,\n        signature = _ref.signature,\n        expectedFiles = _ref.expectedFiles;\n\n    var data = new FormData();\n    data.append('params', typeof params === 'string' ? params : JSON.stringify(params));\n    if (signature) {\n      data.append('signature', signature);\n    }\n\n    Object.keys(fields).forEach(function (key) {\n      data.append(key, fields[key]);\n    });\n    data.append('num_expected_upload_files', expectedFiles);\n\n    return fetch(this.opts.service + '/assemblies', {\n      method: 'post',\n      body: data\n    }).then(function (response) {\n      return response.json();\n    }).then(function (assembly) {\n      if (assembly.error) {\n        var error = new Error(assembly.message);\n        error.code = assembly.error;\n        error.status = assembly;\n        throw error;\n      }\n\n      return assembly;\n    });\n  };\n\n  Client.prototype.reserveFile = function reserveFile(assembly, file) {\n    var size = encodeURIComponent(file.size);\n    return fetch(assembly.assembly_ssl_url + '/reserve_file?size=' + size, { method: 'post' }).then(function (response) {\n      return response.json();\n    });\n  };\n\n  Client.prototype.addFile = function addFile(assembly, file) {\n    if (!file.uploadURL) {\n      return _Promise.reject(new Error('File does not have an `uploadURL`.'));\n    }\n    var size = encodeURIComponent(file.size);\n    var url = encodeURIComponent(file.uploadURL);\n    var filename = encodeURIComponent(file.name);\n    var fieldname = 'file';\n\n    var qs = 'size=' + size + '&filename=' + filename + '&fieldname=' + fieldname + '&s3Url=' + url;\n    return fetch(assembly.assembly_ssl_url + '/add_file?' + qs, { method: 'post' }).then(function (response) {\n      return response.json();\n    });\n  };\n\n  /**\n   * Get the current status for an assembly.\n   *\n   * @param {string} url The status endpoint of the assembly.\n   */\n\n\n  Client.prototype.getAssemblyStatus = function getAssemblyStatus(url) {\n    return fetch(url).then(function (response) {\n      return response.json();\n    });\n  };\n\n  return Client;\n}();\n//# sourceMappingURL=Client.js.map",null]}