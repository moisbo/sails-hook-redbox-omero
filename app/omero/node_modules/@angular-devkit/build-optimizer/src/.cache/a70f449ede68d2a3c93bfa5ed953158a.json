{"remainingRequest":"/Users/moises/source/code.research/sails-hook-redbox-omero/app/omero/node_modules/@angular-devkit/build-optimizer/src/build-optimizer/webpack-loader.js??ref--3-1!/Users/moises/source/code.research/sails-hook-redbox-omero/app/omero/node_modules/uppy/lib/plugins/Dashboard/index.js","dependencies":[{"path":"/Users/moises/source/code.research/sails-hook-redbox-omero/app/omero/node_modules/uppy/lib/plugins/Dashboard/index.js","mtime":1521677672000},{"path":"/Users/moises/source/code.research/sails-hook-redbox-omero/app/omero/node_modules/cache-loader/dist/cjs.js","mtime":1528352013145},{"path":"/Users/moises/source/code.research/sails-hook-redbox-omero/app/omero/node_modules/@angular-devkit/build-optimizer/src/build-optimizer/webpack-loader.js","mtime":1519266497000}],"contextDependencies":[],"result":["var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar Plugin = require('../../core/Plugin');\nvar Translator = require('../../core/Translator');\nvar dragDrop = require('drag-drop');\nvar DashboardUI = require('./Dashboard');\nvar StatusBar = require('../StatusBar');\nvar Informer = require('../Informer');\nvar ThumbnailGenerator = require('../ThumbnailGenerator');\n\nvar _require = require('../../core/Utils'),\n    findAllDOMElements = _require.findAllDOMElements,\n    toArray = _require.toArray;\n\nvar prettyBytes = require('prettier-bytes');\n\nvar _require2 = require('./icons'),\n    defaultTabIcon = _require2.defaultTabIcon;\n\n// Some code for managing focus was adopted from https://github.com/ghosh/micromodal\n// MIT licence, https://github.com/ghosh/micromodal/blob/master/LICENSE.md\n// Copyright (c) 2017 Indrashish Ghosh\n\n\nvar FOCUSABLE_ELEMENTS = ['a[href]', 'area[href]', 'input:not([disabled]):not([type=\"hidden\"]):not([aria-hidden])', 'select:not([disabled]):not([aria-hidden])', 'textarea:not([disabled]):not([aria-hidden])', 'button:not([disabled]):not([aria-hidden])', 'iframe', 'object', 'embed', '[contenteditable]', '[tabindex]:not([tabindex^=\"-\"])'];\n\n/**\n * Dashboard UI with previews, metadata editing, tabs for various services and more\n */\nmodule.exports = function (_Plugin) {\n  _inherits(Dashboard, _Plugin);\n\n  function Dashboard(uppy, opts) {\n    _classCallCheck(this, Dashboard);\n\n    var _this = _possibleConstructorReturn(this, _Plugin.call(this, uppy, opts));\n\n    _this.id = _this.opts.id || 'Dashboard';\n    _this.title = 'Dashboard';\n    _this.type = 'orchestrator';\n\n    var defaultLocale = {\n      strings: {\n        selectToUpload: 'Select files to upload',\n        closeModal: 'Close Modal',\n        upload: 'Upload',\n        importFrom: 'Import files from',\n        dashboardWindowTitle: 'Uppy Dashboard Window (Press escape to close)',\n        dashboardTitle: 'Uppy Dashboard',\n        copyLinkToClipboardSuccess: 'Link copied to clipboard.',\n        copyLinkToClipboardFallback: 'Copy the URL below',\n        copyLink: 'Copy link',\n        fileSource: 'File source',\n        done: 'Done',\n        name: 'Name',\n        removeFile: 'Remove file',\n        editFile: 'Edit file',\n        editing: 'Editing',\n        finishEditingFile: 'Finish editing file',\n        localDisk: 'Local Disk',\n        myDevice: 'My Device',\n        dropPasteImport: 'Drop files here, paste, import from one of the locations above or',\n        dropPaste: 'Drop files here, paste or',\n        browse: 'browse',\n        fileProgress: 'File progress: upload speed and ETA',\n        numberOfSelectedFiles: 'Number of selected files',\n        uploadAllNewFiles: 'Upload all new files',\n        emptyFolderAdded: 'No files were added from empty folder',\n        uploadXFiles: {\n          0: 'Upload %{smart_count} file',\n          1: 'Upload %{smart_count} files'\n        },\n        uploadXNewFiles: {\n          0: 'Upload +%{smart_count} file',\n          1: 'Upload +%{smart_count} files'\n        },\n        folderAdded: {\n          0: 'Added %{smart_count} file from %{folder}',\n          1: 'Added %{smart_count} files from %{folder}'\n        }\n      }\n\n      // set default options\n    };var defaultOptions = {\n      target: 'body',\n      metaFields: [],\n      trigger: '#uppy-select-files',\n      inline: false,\n      width: 750,\n      height: 550,\n      thumbnailWidth: 280,\n      defaultTabIcon: defaultTabIcon,\n      showProgressDetails: false,\n      hideUploadButton: false,\n      hideProgressAfterFinish: false,\n      note: null,\n      closeModalOnClickOutside: false,\n      disableStatusBar: false,\n      disableInformer: false,\n      disableThumbnailGenerator: false,\n      disablePageScrollWhenModalOpen: true,\n      onRequestCloseModal: function onRequestCloseModal() {\n        return _this.closeModal();\n      },\n      locale: defaultLocale\n\n      // merge default options with the ones set by user\n    };_this.opts = _extends({}, defaultOptions, opts);\n\n    _this.locale = _extends({}, defaultLocale, _this.opts.locale);\n    _this.locale.strings = _extends({}, defaultLocale.strings, _this.opts.locale.strings);\n\n    _this.translator = new Translator({ locale: _this.locale });\n    _this.i18n = _this.translator.translate.bind(_this.translator);\n\n    _this.openModal = _this.openModal.bind(_this);\n    _this.closeModal = _this.closeModal.bind(_this);\n    _this.requestCloseModal = _this.requestCloseModal.bind(_this);\n    _this.isModalOpen = _this.isModalOpen.bind(_this);\n\n    _this.addTarget = _this.addTarget.bind(_this);\n    _this.hideAllPanels = _this.hideAllPanels.bind(_this);\n    _this.showPanel = _this.showPanel.bind(_this);\n    _this.getFocusableNodes = _this.getFocusableNodes.bind(_this);\n    _this.setFocusToFirstNode = _this.setFocusToFirstNode.bind(_this);\n    _this.maintainFocus = _this.maintainFocus.bind(_this);\n\n    _this.initEvents = _this.initEvents.bind(_this);\n    _this.onKeydown = _this.onKeydown.bind(_this);\n    _this.handleClickOutside = _this.handleClickOutside.bind(_this);\n    _this.handleFileCard = _this.handleFileCard.bind(_this);\n    _this.handleDrop = _this.handleDrop.bind(_this);\n    _this.handlePaste = _this.handlePaste.bind(_this);\n    _this.handleInputChange = _this.handleInputChange.bind(_this);\n    _this.updateDashboardElWidth = _this.updateDashboardElWidth.bind(_this);\n    _this.render = _this.render.bind(_this);\n    _this.install = _this.install.bind(_this);\n    return _this;\n  }\n\n  Dashboard.prototype.addTarget = function addTarget(plugin) {\n    var callerPluginId = plugin.id || plugin.constructor.name;\n    var callerPluginName = plugin.title || callerPluginId;\n    var callerPluginType = plugin.type;\n\n    if (callerPluginType !== 'acquirer' && callerPluginType !== 'progressindicator' && callerPluginType !== 'presenter') {\n      var msg = 'Dashboard: Modal can only be used by plugins of types: acquirer, progressindicator, presenter';\n      this.uppy.log(msg);\n      return;\n    }\n\n    var target = {\n      id: callerPluginId,\n      name: callerPluginName,\n      type: callerPluginType\n    };\n\n    var state = this.getPluginState();\n    var newTargets = state.targets.slice();\n    newTargets.push(target);\n\n    this.setPluginState({\n      targets: newTargets\n    });\n\n    return this.el;\n  };\n\n  Dashboard.prototype.hideAllPanels = function hideAllPanels() {\n    this.setPluginState({\n      activePanel: false\n    });\n  };\n\n  Dashboard.prototype.showPanel = function showPanel(id) {\n    var _getPluginState = this.getPluginState(),\n        targets = _getPluginState.targets;\n\n    var activePanel = targets.filter(function (target) {\n      return target.type === 'acquirer' && target.id === id;\n    })[0];\n\n    this.setPluginState({\n      activePanel: activePanel\n    });\n  };\n\n  Dashboard.prototype.requestCloseModal = function requestCloseModal() {\n    if (this.opts.onRequestCloseModal) {\n      return this.opts.onRequestCloseModal();\n    } else {\n      this.closeModal();\n    }\n  };\n\n  Dashboard.prototype.getFocusableNodes = function getFocusableNodes() {\n    var nodes = this.el.querySelectorAll(FOCUSABLE_ELEMENTS);\n    return Object.keys(nodes).map(function (key) {\n      return nodes[key];\n    });\n  };\n\n  Dashboard.prototype.setFocusToFirstNode = function setFocusToFirstNode() {\n    var focusableNodes = this.getFocusableNodes();\n    if (focusableNodes.length) focusableNodes[0].focus();\n  };\n\n  Dashboard.prototype.maintainFocus = function maintainFocus(event) {\n    var focusableNodes = this.getFocusableNodes();\n    var focusedItemIndex = focusableNodes.indexOf(document.activeElement);\n\n    if (event.shiftKey && focusedItemIndex === 0) {\n      focusableNodes[focusableNodes.length - 1].focus();\n      event.preventDefault();\n    }\n\n    if (!event.shiftKey && focusedItemIndex === focusableNodes.length - 1) {\n      focusableNodes[0].focus();\n      event.preventDefault();\n    }\n  };\n\n  Dashboard.prototype.openModal = function openModal() {\n    this.setPluginState({\n      isHidden: false\n    });\n\n    // save scroll position\n    this.savedScrollPosition = window.scrollY;\n    // save active element, so we can restore focus when modal is closed\n    this.savedActiveElement = document.activeElement;\n\n    if (this.opts.disablePageScrollWhenModalOpen) {\n      document.body.classList.add('uppy-Dashboard-isOpen');\n    }\n\n    this.updateDashboardElWidth();\n    this.setFocusToFirstNode();\n  };\n\n  Dashboard.prototype.closeModal = function closeModal() {\n    this.setPluginState({\n      isHidden: true\n    });\n\n    if (this.opts.disablePageScrollWhenModalOpen) {\n      document.body.classList.remove('uppy-Dashboard-isOpen');\n    }\n\n    this.savedActiveElement.focus();\n  };\n\n  Dashboard.prototype.isModalOpen = function isModalOpen() {\n    return !this.getPluginState().isHidden || false;\n  };\n\n  Dashboard.prototype.onKeydown = function onKeydown(event) {\n    // close modal on esc key press\n    if (event.keyCode === 27) this.requestCloseModal(event);\n    // maintainFocus on tab key press\n    if (event.keyCode === 9) this.maintainFocus(event);\n  };\n\n  Dashboard.prototype.handleClickOutside = function handleClickOutside() {\n    if (this.opts.closeModalOnClickOutside) this.requestCloseModal();\n  };\n\n  Dashboard.prototype.handlePaste = function handlePaste(ev) {\n    var _this2 = this;\n\n    var files = toArray(ev.clipboardData.items);\n    files.forEach(function (file) {\n      if (file.kind !== 'file') return;\n\n      var blob = file.getAsFile();\n      if (!blob) {\n        _this2.uppy.log('[Dashboard] File pasted, but the file blob is empty');\n        _this2.uppy.info('Error pasting file', 'error');\n        return;\n      }\n      _this2.uppy.log('[Dashboard] File pasted');\n      _this2.uppy.addFile({\n        source: _this2.id,\n        name: file.name,\n        type: file.type,\n        data: blob\n      }).catch(function () {\n        // Ignore\n      });\n    });\n  };\n\n  Dashboard.prototype.handleInputChange = function handleInputChange(ev) {\n    var _this3 = this;\n\n    ev.preventDefault();\n    var files = toArray(ev.target.files);\n\n    files.forEach(function (file) {\n      _this3.uppy.addFile({\n        source: _this3.id,\n        name: file.name,\n        type: file.type,\n        data: file\n      }).catch(function () {\n        // Ignore\n      });\n    });\n  };\n\n  Dashboard.prototype.initEvents = function initEvents() {\n    var _this4 = this;\n\n    // Modal open button\n    var showModalTrigger = findAllDOMElements(this.opts.trigger);\n    if (!this.opts.inline && showModalTrigger) {\n      showModalTrigger.forEach(function (trigger) {\n        return trigger.addEventListener('click', _this4.openModal);\n      });\n    }\n\n    if (!this.opts.inline && !showModalTrigger) {\n      this.uppy.log('Dashboard modal trigger not found. Make sure `trigger` is set in Dashboard options unless you are planning to call openModal() method yourself');\n    }\n\n    if (!this.opts.inline) {\n      document.addEventListener('keydown', this.onKeydown);\n    }\n\n    // Drag Drop\n    this.removeDragDropListener = dragDrop(this.el, function (files) {\n      _this4.handleDrop(files);\n    });\n\n    this.uppy.on('dashboard:file-card', this.handleFileCard);\n\n    this.updateDashboardElWidth();\n    window.addEventListener('resize', this.updateDashboardElWidth);\n  };\n\n  Dashboard.prototype.removeEvents = function removeEvents() {\n    var _this5 = this;\n\n    var showModalTrigger = findAllDOMElements(this.opts.trigger);\n    if (!this.opts.inline && showModalTrigger) {\n      showModalTrigger.forEach(function (trigger) {\n        return trigger.removeEventListener('click', _this5.openModal);\n      });\n    }\n\n    if (!this.opts.inline) {\n      document.removeEventListener('keydown', this.onKeydown);\n    }\n\n    this.removeDragDropListener();\n    this.uppy.off('dashboard:file-card', this.handleFileCard);\n    window.removeEventListener('resize', this.updateDashboardElWidth);\n  };\n\n  Dashboard.prototype.updateDashboardElWidth = function updateDashboardElWidth() {\n    var dashboardEl = this.el.querySelector('.uppy-Dashboard-inner');\n    this.uppy.log('Dashboard width: ' + dashboardEl.offsetWidth);\n\n    this.setPluginState({\n      containerWidth: dashboardEl.offsetWidth\n    });\n  };\n\n  Dashboard.prototype.handleFileCard = function handleFileCard(fileId) {\n    this.setPluginState({\n      fileCardFor: fileId || false\n    });\n  };\n\n  Dashboard.prototype.handleDrop = function handleDrop(files) {\n    var _this6 = this;\n\n    this.uppy.log('[Dashboard] Files were dropped');\n\n    files.forEach(function (file) {\n      _this6.uppy.addFile({\n        source: _this6.id,\n        name: file.name,\n        type: file.type,\n        data: file\n      }).catch(function () {\n        // Ignore\n      });\n    });\n  };\n\n  Dashboard.prototype.render = function render(state) {\n    var _this7 = this;\n\n    var pluginState = this.getPluginState();\n    var files = state.files;\n\n    var newFiles = Object.keys(files).filter(function (file) {\n      return !files[file].progress.uploadStarted;\n    });\n    var inProgressFiles = Object.keys(files).filter(function (file) {\n      return !files[file].progress.uploadComplete && files[file].progress.uploadStarted && !files[file].isPaused;\n    });\n\n    var inProgressFilesArray = [];\n    inProgressFiles.forEach(function (file) {\n      inProgressFilesArray.push(files[file]);\n    });\n\n    var totalSize = 0;\n    var totalUploadedSize = 0;\n    inProgressFilesArray.forEach(function (file) {\n      totalSize = totalSize + (file.progress.bytesTotal || 0);\n      totalUploadedSize = totalUploadedSize + (file.progress.bytesUploaded || 0);\n    });\n    totalSize = prettyBytes(totalSize);\n    totalUploadedSize = prettyBytes(totalUploadedSize);\n\n    var attachRenderFunctionToTarget = function attachRenderFunctionToTarget(target) {\n      var plugin = _this7.uppy.getPlugin(target.id);\n      return _extends({}, target, {\n        icon: plugin.icon || _this7.opts.defaultTabIcon,\n        render: plugin.render\n      });\n    };\n\n    var isSupported = function isSupported(target) {\n      var plugin = _this7.uppy.getPlugin(target.id);\n      // If the plugin does not provide a `supported` check, assume the plugin works everywhere.\n      if (typeof plugin.isSupported !== 'function') {\n        return true;\n      }\n      return plugin.isSupported();\n    };\n\n    var acquirers = pluginState.targets.filter(function (target) {\n      return target.type === 'acquirer' && isSupported(target);\n    }).map(attachRenderFunctionToTarget);\n\n    var progressindicators = pluginState.targets.filter(function (target) {\n      return target.type === 'progressindicator';\n    }).map(attachRenderFunctionToTarget);\n\n    var startUpload = function startUpload(ev) {\n      _this7.uppy.upload().catch(function (err) {\n        // Log error.\n        _this7.uppy.log(err.stack || err.message || err);\n      });\n    };\n\n    var cancelUpload = function cancelUpload(fileID) {\n      _this7.uppy.emit('upload-cancel', fileID);\n      _this7.uppy.removeFile(fileID);\n    };\n\n    var showFileCard = function showFileCard(fileID) {\n      _this7.uppy.emit('dashboard:file-card', fileID);\n    };\n\n    var fileCardDone = function fileCardDone(meta, fileID) {\n      _this7.uppy.setFileMeta(fileID, meta);\n      _this7.uppy.emit('dashboard:file-card');\n    };\n\n    return DashboardUI({\n      state: state,\n      modal: pluginState,\n      newFiles: newFiles,\n      files: files,\n      totalFileCount: Object.keys(files).length,\n      totalProgress: state.totalProgress,\n      acquirers: acquirers,\n      activePanel: pluginState.activePanel,\n      getPlugin: this.uppy.getPlugin,\n      progressindicators: progressindicators,\n      autoProceed: this.uppy.opts.autoProceed,\n      hideUploadButton: this.opts.hideUploadButton,\n      id: this.id,\n      closeModal: this.requestCloseModal,\n      handleClickOutside: this.handleClickOutside,\n      handleInputChange: this.handleInputChange,\n      handlePaste: this.handlePaste,\n      showProgressDetails: this.opts.showProgressDetails,\n      inline: this.opts.inline,\n      showPanel: this.showPanel,\n      hideAllPanels: this.hideAllPanels,\n      log: this.uppy.log,\n      i18n: this.i18n,\n      addFile: this.uppy.addFile,\n      removeFile: this.uppy.removeFile,\n      info: this.uppy.info,\n      note: this.opts.note,\n      metaFields: this.getPluginState().metaFields,\n      resumableUploads: this.uppy.state.capabilities.resumableUploads || false,\n      startUpload: startUpload,\n      pauseUpload: this.uppy.pauseResume,\n      retryUpload: this.uppy.retryUpload,\n      cancelUpload: cancelUpload,\n      fileCardFor: pluginState.fileCardFor,\n      showFileCard: showFileCard,\n      fileCardDone: fileCardDone,\n      updateDashboardElWidth: this.updateDashboardElWidth,\n      maxWidth: this.opts.maxWidth,\n      maxHeight: this.opts.maxHeight,\n      currentWidth: pluginState.containerWidth,\n      isWide: pluginState.containerWidth > 400\n    });\n  };\n\n  Dashboard.prototype.discoverProviderPlugins = function discoverProviderPlugins() {\n    var _this8 = this;\n\n    this.uppy.iteratePlugins(function (plugin) {\n      if (plugin && !plugin.target && plugin.opts && plugin.opts.target === _this8.constructor) {\n        _this8.addTarget(plugin);\n      }\n    });\n  };\n\n  Dashboard.prototype.install = function install() {\n    var _this9 = this;\n\n    // Set default state for Modal\n    this.setPluginState({\n      isHidden: true,\n      showFileCard: false,\n      activePanel: false,\n      metaFields: this.opts.metaFields,\n      targets: []\n    });\n\n    var target = this.opts.target;\n    if (target) {\n      this.mount(target, this);\n    }\n\n    var plugins = this.opts.plugins || [];\n    plugins.forEach(function (pluginID) {\n      var plugin = _this9.uppy.getPlugin(pluginID);\n      if (plugin) plugin.mount(_this9, plugin);\n    });\n\n    if (!this.opts.disableStatusBar) {\n      this.uppy.use(StatusBar, {\n        target: this,\n        hideUploadButton: this.opts.hideUploadButton,\n        hideAfterFinish: this.opts.hideProgressAfterFinish,\n        locale: this.opts.locale\n      });\n    }\n\n    if (!this.opts.disableInformer) {\n      this.uppy.use(Informer, {\n        target: this\n      });\n    }\n\n    if (!this.opts.disableThumbnailGenerator) {\n      this.uppy.use(ThumbnailGenerator, {\n        thumbnailWidth: this.opts.thumbnailWidth\n      });\n    }\n\n    this.discoverProviderPlugins();\n\n    this.initEvents();\n  };\n\n  Dashboard.prototype.uninstall = function uninstall() {\n    var _this10 = this;\n\n    if (!this.opts.disableInformer) {\n      var informer = this.uppy.getPlugin('Informer');\n      // Checking if this plugin exists, in case it was removed by uppy-core\n      // before the Dashboard was.\n      if (informer) this.uppy.removePlugin(informer);\n    }\n\n    if (!this.opts.disableStatusBar) {\n      var statusBar = this.uppy.getPlugin('StatusBar');\n      if (statusBar) this.uppy.removePlugin(statusBar);\n    }\n\n    if (!this.opts.disableThumbnailGenerator) {\n      var thumbnail = this.uppy.getPlugin('ThumbnailGenerator');\n      if (thumbnail) this.uppy.removePlugin(thumbnail);\n    }\n\n    var plugins = this.opts.plugins || [];\n    plugins.forEach(function (pluginID) {\n      var plugin = _this10.uppy.getPlugin(pluginID);\n      if (plugin) plugin.unmount();\n    });\n\n    this.unmount();\n    this.removeEvents();\n  };\n\n  return Dashboard;\n}(Plugin);\n//# sourceMappingURL=index.js.map",null]}